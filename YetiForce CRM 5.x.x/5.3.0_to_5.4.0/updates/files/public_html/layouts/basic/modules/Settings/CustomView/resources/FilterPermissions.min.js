'use strict';

jQuery.Class('Settings_CustomView_FilterPermissions_Js',{},{formElement:!1,registerButtonsEvent:function registerButtonsEvent(){var thisInstance=this,container=this.getForm();container.find('button.moveItem').on('click',function(e){thisInstance.setDefaultPreferences(e);});},registerDisabledButtons:function registerDisabledButtons(){var container=this.getForm();container.find('button.moveItem').each(function(n,e){var currentTarget=jQuery(e),sourceClass=currentTarget.data('source'),source=container.find('.'+sourceClass);source.find('option').length&&!source.is(':disabled')?currentTarget.prop('disabled',!1):currentTarget.prop('disabled',!0);});},move:function move(currentTarget){var container=this.getForm(),sourceClass=currentTarget.data('source'),targetClass=currentTarget.data('target'),target=container.find('.'+targetClass),source=container.find('.'+sourceClass).find('option:selected'),values={};values.val=source.val(),values.label=source.text(),values.blockLabel=source.closest('optgroup').attr('label');var targetOption='<option value="'+values.val+'">'+values.label+'</option>',targetOpt=target.find('optgroup[label="'+values.blockLabel+'"]');targetOpt.length?targetOpt.append(targetOption):target.append('<optgroup label="'+values.blockLabel+'">'+targetOption+'</optgroup>'),source.remove(),App.Fields.Picklist.showSelect2ElementView(container.find('.select2'));},/**
		 * Saves permission for filter
		 * @param {jQuery.Event} e
		 */setDefaultPreferences:function setDefaultPreferences(e){var thisInstance=this,container=this.getForm(),progressIndicatorElement=$.progressIndicator({message:app.vtranslate('JS_SAVE_LOADER_INFO'),position:this.getForm(),blockInfo:{enabled:!0}}),currentTarget=$(e.currentTarget),sourceClass=currentTarget.data('source'),params={tabid:container.find('#sourceModule').val(),user:container.find('.'+sourceClass).val(),cvid:container.find('#cvid').val(),operator:currentTarget.data('operator'),type:container.find('#type').val()};app.saveAjax('setFilterPermissions',{},params).done(function(data){data.success?data.result.success?(thisInstance.move(currentTarget),thisInstance.registerDisabledButtons(),progressIndicatorElement.progressIndicator({mode:'hide'}),app.showNotify({text:data.result.message,type:'success'})):(progressIndicatorElement.progressIndicator({mode:'hide'}),app.showNotify({text:data.result.message,type:'error'})):progressIndicatorElement.progressIndicator({mode:'hide'});});},getForm:function getForm(){return !1==this.formElement&&this.setForm(jQuery('#modalFilterPermissions')),this.formElement},setForm:function setForm(element){return this.formElement=element,this},registerEvents:function registerEvents(){this.registerButtonsEvent(),this.registerDisabledButtons();}}),jQuery(document).ready(function(){var instance=new Settings_CustomView_FilterPermissions_Js;instance.registerEvents();});
//# sourceMappingURL=FilterPermissions.min.js.map
