'use strict';

Vtiger_RelatedList_Js('Campaigns_RelatedList_Js',{/*
		 * function to trigger send Email
		 * @params: send email url , module name.
		 */triggerSendEmail:function triggerSendEmail(){var params=Vtiger_RelatedList_Js.relatedListInstance.getDefaultParams();Vtiger_List_Js.triggerSendEmail($.extend(params,{relatedLoad:!0,module:Vtiger_RelatedList_Js.relatedListInstance.moduleName,sourceModule:app.getModuleName(),sourceRecord:app.getRecordId()}));}},{getCompleteParams:function getCompleteParams(){var params=this._super(),container=this.getRelatedContainer();return params.selectedIds=container.find('#selectedIds').data('selectedIds'),params.excludedIds=container.find('#excludedIds').data('excludedIds'),params},changeCustomFilterElementView:function changeCustomFilterElementView(){var filterSelectElement=this.content.find('#customFilter');if(0<filterSelectElement.length){App.Fields.Picklist.showSelect2ElementView(filterSelectElement,{templateSelection:function templateSelection(data){var resultContainer=jQuery('<span></span>');return resultContainer.append(jQuery(jQuery('.filterImage').detach().get(0)).show()),resultContainer.append(data.text),resultContainer},customSortOptGroup:!0,closeOnSelect:!0});var select2Instance=filterSelectElement.data('select2');select2Instance.$dropdown.append(this.content.find('span.filterActionsDiv'));}},registerChangeCustomFilterEvent:function registerChangeCustomFilterEvent(){var thisInstance=this,relatedContainer=thisInstance.getRelatedContainer(),filterSelectElement=relatedContainer.find('.loadFormFilterButton'),customFilter=relatedContainer.find('#customFilter');filterSelectElement.on('click',function(){var message=app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_ADD_THIS_FILTER');Vtiger_Helper_Js.showConfirmationBox({message:message}).done(function(){var cvId=customFilter.val(),relatedModuleName=relatedContainer.find('.relatedModuleName').val(),params={sourceRecord:app.getRecordId(),relatedModule:relatedModuleName,viewId:cvId,module:app.getModuleName(),action:'RelationAjax',mode:'addRelationsFromRelatedModuleViewId'},progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request(params).done(function(responseData){if(progressIndicatorElement.progressIndicator({mode:'hide'}),!1===responseData.result){var message=app.vtranslate('JS_NO_RECORDS_RELATED_TO_THIS_FILTER');Vtiger_Helper_Js.showMessage({text:message,type:'info'});}else Vtiger_Detail_Js.reloadRelatedList();}).fail(function(){progressIndicatorElement.progressIndicator({mode:'hide'});});});});},/**
		 * Function to edit related status for email enabled modules of campaigns
		 */registerEventToEditRelatedStatus:function registerEventToEditRelatedStatus(){var thisInstance=this,relatedContainer=thisInstance.getRelatedContainer();relatedContainer.find('.currentStatus').on('click',function(e){e.stopImmediatePropagation();var element=jQuery(e.currentTarget);element.addClass('open');});var statusDropdown=relatedContainer.find('.currentStatus').find('.dropdown-menu');statusDropdown.on('click','a',function(e){e.stopImmediatePropagation();var element=jQuery(e.currentTarget),liContainer=element.closest('li'),currentStatus=element.closest('.currentStatus'),selectedStatusId=liContainer.attr('id'),selectedStatusValue=liContainer.data('status'),relatedRecordId=element.closest('tr').data('id'),params={relatedModule:thisInstance.relatedModulename,relatedRecord:relatedRecordId,status:selectedStatusId,module:app.getModuleName(),action:'RelationAjax',sourceRecord:thisInstance.parentRecordId,mode:'updateStatus'};element.progressIndicator(),AppConnector.request(params).done(function(responseData){responseData.result[0]&&(element.progressIndicator({mode:'hide'}),currentStatus.find('.statusValue').text(selectedStatusValue),currentStatus.removeClass('open'));}).fail(function(){element.progressIndicator({mode:'hide'});});});},registerPostLoadEvents:function registerPostLoadEvents(){this._super(),this.changeCustomFilterElementView(),this.registerChangeCustomFilterEvent(),this.registerEventToEditRelatedStatus();}});
//# sourceMappingURL=RelatedList.min.js.map
