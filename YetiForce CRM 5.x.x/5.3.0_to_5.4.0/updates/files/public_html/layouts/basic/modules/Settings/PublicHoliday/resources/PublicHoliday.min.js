'use strict';

jQuery.Class('Settings_PublicHoliday_Js',{},{/**
		 * Function that deletes holiday from list
		 */registerDeleteHoliday:function registerDeleteHoliday(element){var thisInstance=this;element.find('.deleteHoliday').each(function(){jQuery(this).on('click',function(){thisInstance.deleteHoliday(jQuery(this).data('holiday-id'));});});},/**
		 * Delete chosen holiday date
		 */deleteHoliday:function deleteHoliday(holidayId){var thisInstance=this,progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'Holiday',mode:'delete',id:holidayId}).done(function(data){AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),view:'Configuration',async:!1}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});}),Settings_Vtiger_Index_Js.showMessage({text:data.result.message});}).fail(function(){progressIndicatorElement.progressIndicator({mode:'hide'});});},/**
		 * Function to register click event for add custom block button
		 */registerAddDate:function registerAddDate(){var thisInstance=this,contents=jQuery('#layoutDashBoards');contents.find('.addDateWindow').on('click',function(){var addBlockContainer=contents.find('.addDateWindowModal').clone(!0,!0),translate=app.vtranslate('JS_ADD_NEW_HOLIDAY');addBlockContainer.find('.modal-title').text(translate);var callBackFunction=function(data){data.find('.addDateWindowModal').removeClass('d-none').show();var form=data.find('.addDateWindowForm');jQuery('[name="holidayId"]').val(''),jQuery(document).find('div.blockOverlay').on('click',function(){var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});});}),jQuery('.cancelLink').on('click',function(){var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});});}),form.on('submit',function(e){e.preventDefault();var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});return thisInstance.saveNewDate(form).done(function(data){data.success?(Settings_Vtiger_Index_Js.showMessage({text:data.result.message}),AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});})):(progressIndicatorElement.progressIndicator({mode:'hide'}),Settings_Vtiger_Index_Js.showMessage({text:data.result.message,type:'error'}));}),app.hideModalWindow(),!0});};app.showModalWindow(addBlockContainer,function(data){'function'==typeof callBackFunction&&callBackFunction(data);},{width:'1000px'});});},/**
		 * Function to register click event for add custom block button
		 */registerEditDate:function registerEditDate(){var thisInstance=this,contents=jQuery('#layoutDashBoards');contents.find('.editHoliday').on('click',function(){var addBlockContainer=contents.find('.addDateWindowModal').clone(!0,!0),dateElement=jQuery(this).closest('.holidayElement');addBlockContainer.find('[name="holidayId"]').val(dateElement.data('holiday-id')),addBlockContainer.find('[name="holidayDate"]').val(dateElement.data('holiday-date')),addBlockContainer.find('[name="holidayName"]').val(dateElement.data('holiday-name')),addBlockContainer.find('[name="holidayType"]').val(dateElement.data('holiday-type'));var translate=app.vtranslate('JS_EDIT_HOLIDAY');addBlockContainer.find('.modal-title').text(translate);var callBackFunction=function(data){data.find('.addDateWindowModal').removeClass('d-none').show();var form=data.find('.addDateWindowForm');jQuery('[name="saveButton"]').on('click',function(){var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});return thisInstance.saveNewDate(form).done(function(data){data.success?(Settings_Vtiger_Index_Js.showMessage({text:data.result.message}),AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});})):(progressIndicatorElement.progressIndicator({mode:'hide'}),Settings_Vtiger_Index_Js.showMessage({text:data.result.message,type:'error'}));}),app.hideModalWindow(),!0}),jQuery(document).find('div.blockOverlay').on('click',function(){var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});});}),jQuery('.cancelLink').on('click',function(){var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});});}),form.on('submit',function(e){e.preventDefault();});};app.showModalWindow(addBlockContainer,function(data){'function'==typeof callBackFunction&&callBackFunction(data);},{width:'1000px'});});},/**
		 * Function to save the new custom block details
		 */saveNewDate:function saveNewDate(form){var thisInstance=this,params=form.serializeFormData();if(params.module=app.getModuleName(),params.parent=app.getParentModuleName(),params.action='Holiday',params.mode='save',''==params.holidayName||''==params.holidayDate){Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate('JS_FILL_FORM_ERROR'),type:'error'});var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName()}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});});}else {var aDeferred=jQuery.Deferred();return AppConnector.request(params).done(function(data){aDeferred.resolve(data);}).fail(function(error){aDeferred.reject(error);}),aDeferred.promise()}return !0},registerChangeDate:function registerChangeDate(){var thisInstance=this,dateFilter=jQuery('.dateFilter');App.Fields.Date.registerRange(dateFilter,{ranges:!1}),dateFilter.on('apply.daterangepicker',function(ev,picker){var format=jQuery(ev.currentTarget).data('dateFormat').toUpperCase();$(this).val(picker.startDate.format(format)+','+picker.endDate.format(format));var progressIndicatorElement=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName(),date:'["'+picker.startDate.format(format)+'","'+picker.endDate.format(format)+'"]'}).done(function(data){jQuery('.contentsDiv').html(data),thisInstance.registerEvents(),progressIndicatorElement.progressIndicator({mode:'hide'});});});},/**
		 * register events for layout editor
		 */registerEvents:function registerEvents(){this.registerDeleteHoliday(jQuery('#moduleBlocks')),this.registerAddDate(),this.registerEditDate(),this.registerChangeDate();}}),jQuery(document).ready(function(){var instance=new Settings_PublicHoliday_Js;instance.registerEvents();});
//# sourceMappingURL=PublicHoliday.min.js.map
