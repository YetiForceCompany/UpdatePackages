'use strict';

$.Class('Settings_Countries_Index_Js',{},{registerSortableEvent:function registerSortableEvent(){var thisInstance=this,tbody=$('tbody',$('.listViewEntriesTable'));tbody.sortable({helper:function helper(e,ui){return ui.children().each(function(index,element){element=$(element),element.width(element.width());}),ui},containment:tbody,revert:!0,update:function update(){thisInstance.registerSequenceListOnServer();}});},registerStatus:function registerStatus(content){content.find('button.status').on('click',function(){var element=$(this),id=element.closest('tr').data('id'),status=element.data('status')?0:1;AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'SaveAjax',mode:'updateStatus',id:id,status:status}).done(function(data){data.success&&data.result&&(element.data('status',status),element.toggleClass('btn-success').toggleClass('btn-danger'),Vtiger_Helper_Js.showMessage({title:app.vtranslate('JS_COUNTRY_SETTING'),text:app.vtranslate('JS_SAVE_NOTIFY_OK'),type:'success'}));});});},registerPhone:function registerPhone(content){content.find('button.phone').on('click',function(){var element=$(this),id=element.closest('tr').data('id'),phone=element.data('phone')?0:1;AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'SaveAjax',mode:'updatePhone',id:id,phone:phone}).done(function(data){data.success&&data.result&&(element.data('phone',phone),element.toggleClass('btn-success').toggleClass('btn-danger'),Vtiger_Helper_Js.showMessage({title:app.vtranslate('JS_COUNTRY_SETTING'),text:app.vtranslate('JS_SAVE_NOTIFY_OK'),type:'success'}));});});},registerUitype:function registerUitype(content){content.find('button.uitype').on('click',function(){var element=$(this),id=element.closest('tr').data('id'),uitype=element.data('uitype')?0:1;AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'SaveAjax',mode:'updateUitype',id:id,uitype:uitype}).done(function(data){data.success&&data.result&&(element.data('uitype',uitype),element.toggleClass('btn-success').toggleClass('btn-danger'),Vtiger_Helper_Js.showMessage({title:app.vtranslate('JS_COUNTRY_SETTING'),text:app.vtranslate('JS_SAVE_NOTIFY_OK'),type:'success'}));});});},allStatuses:1,registerAllStatuses:function registerAllStatuses(content){var thisInstance=this;content.find('button.all-statuses').on('click',function(){var status=thisInstance.allStatuses?0:1;AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'SaveAjax',mode:'updateAllStatuses',status:status}).done(function(data){if(data.success&&data.result){var elements=content.find('.status');status?(elements.removeClass('btn-success').addClass('btn-danger'),elements.data('status',1)):(elements.removeClass('btn-danger').addClass('btn-success'),elements.data('status',0)),Vtiger_Helper_Js.showMessage({title:app.vtranslate('JS_COUNTRY_SETTING'),text:app.vtranslate('JS_SAVE_NOTIFY_OK'),type:'success'});}data.success&&(thisInstance.allStatuses=status);});});},registerRowToTop:function registerRowToTop(content){var thisInstance=this;content.find('button.to-top').on('click',function(){var row=$(this).closest('tr');$(this).closest('table.listViewEntriesTable tbody').prepend(row),thisInstance.registerSequenceListOnServer();});},registerRowToBottom:function registerRowToBottom(content){var thisInstance=this;content.find('button.to-bottom').on('click',function(){var row=$(this).closest('tr');$(this).closest('table.listViewEntriesTable tbody').append(row),thisInstance.registerSequenceListOnServer();});},registerSequenceListOnServer:function registerSequenceListOnServer(){var sequenceList={};$('tbody tr').each(function(i){sequenceList[++i]=$(this).data('id');}),AppConnector.request({sequencesList:JSON.stringify(sequenceList),module:app.getModuleName(),parent:app.getParentModuleName(),action:'SaveAjax',mode:'updateSequence'}).done(function(){Vtiger_Helper_Js.showMessage({title:app.vtranslate('JS_COUNTRY_SETTING'),text:app.vtranslate('JS_SAVE_NOTIFY_OK'),type:'success'});});},registerChangeGettingDefaultCountry:function registerChangeGettingDefaultCountry(container){container.find('.js-update-get-default-phone-country').on('change',function(){AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'SaveAjax',mode:'updateGetDefaultCountry',value:$(this).val()}).done(function(){Vtiger_Helper_Js.showMessage({text:app.vtranslate('JS_SAVE_NOTIFY_OK'),type:'success'});});});},registerEvents:function registerEvents(){var content=$('.contentsDiv');this.registerSortableEvent(),this.registerStatus(content),this.registerPhone(content),this.registerUitype(content),this.registerAllStatuses(content),this.registerRowToTop(content),this.registerRowToBottom(content),this.registerChangeGettingDefaultCountry(content);}});
//# sourceMappingURL=Index.min.js.map
