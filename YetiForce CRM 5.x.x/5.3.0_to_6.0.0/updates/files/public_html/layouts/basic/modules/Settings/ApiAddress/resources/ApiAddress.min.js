'use strict';

var defineProperty = function (obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
};

jQuery.Class('Settings_ApiAddress_Configuration_Js',{},{registerSave:function registerSave(container){container.validationEngine(app.validationEngineOptions),container.find('.saveGlobal').on('click',function(){if(!container.validationEngine('validate'))return app.formAlignmentAfterValidation(container),!1;var defaultProvider=$('[name="default_provider"]:checked'),elements={global:{min_length:$('[name="min_length"]').val(),result_num:$('[name="result_num"]').val(),default_provider:defaultProvider.length?defaultProvider.val():0}};$('[name="active"]').each(function(i,e){elements[e.dataset.type]={active:e.checked?1:0};}),AppConnector.request({data:{module:'ApiAddress',parent:'Settings',action:'SaveConfig',elements:elements},async:!1,dataType:'json'}).done(function(data){app.showNotify({text:data.result.message,type:'success'});}).fail(function(){app.showNotify({text:app.vtranslate('JS_ERROR'),type:'error'});});});},registerConfigModal:function registerConfigModal(container){container.find('.js-show-config-modal').on('click',function(e){var providerName=e.currentTarget.dataset.provider;app.showModalWindow(null,'index.php?module=ApiAddress&parent=Settings&view=ApiConfigModal&provider='+providerName,function(modalContainer){var form=modalContainer.find('.js-form-validation');form.validationEngine(app.validationEngineOptions),modalContainer.find('.js-modal__save').on('click',function(){if(!form.validationEngine('validate'))return app.formAlignmentAfterValidation(container),!1;var elements={},customField=modalContainer.find('.js-custom-field');customField.each(function(i,e){elements[$(e).attr('name')]=e.value;}),elements=defineProperty({},providerName,elements),AppConnector.request({data:{module:'ApiAddress',parent:'Settings',action:'SaveConfig',elements:elements},async:!1,dataType:'json'}).done(function(data){app.showNotify({text:data.result.message,type:'success'}),window.location.reload();}).fail(function(){app.showNotify({text:app.vtranslate('JS_ERROR'),type:'error'});});});});});},registerValidateBtn:function registerValidateBtn(container){container.find('.js-validate').on('click',function(e){var currentTarget=$(e.currentTarget),icon=currentTarget.find('.js-validate__icon');icon.addClass('fa-spin'),AppConnector.request({module:'ApiAddress',parent:'Settings',action:'ValidateConfiguration',provider:currentTarget.data('provider')}).done(function(data){icon.removeClass('fa-spin'),app.showNotify({text:data.result.message,type:data.result.type});});});},registerEvents:function registerEvents(){var container=$('.js-validation-form');this.registerConfigModal(container),this.registerSave(container),this.registerValidateBtn(container);}});
//# sourceMappingURL=ApiAddress.min.js.map
