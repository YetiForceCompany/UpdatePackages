'use strict';

$.Class('Settings_FieldsDependency_Edit_Js',{},{/**
		 * Register submit event
		 */registerSubmitEvent:function registerSubmitEvent(){var _this=this;this.container.off('submit').on('submit',function(e){return $(e.currentTarget).validationEngine('validate')?(_this.container.find('input[name="conditions"]').val(JSON.stringify(_this.conditionBuilder.getConditions())),!0):(e.preventDefault(),e.stopPropagation(),!1)});},/**
		 * Load condition builder
		 */loadConditionBuilderView:function loadConditionBuilderView(){console.log(this.sourceModule),this.conditionBuilder=new Vtiger_ConditionBuilder_Js(this.container.find('.js-condition-builder'),this.sourceModule),this.conditionBuilder.registerEvents();},/**
		 * Register source module change
		 */registerSourceModuleChange:function registerSourceModuleChange(){var _this2=this,select=this.container.find('#inputSourceModule'),blocks=this.container.find('.js-dynamic-blocks');select.on('change',function(){_this2.sourceModule=select.find('option:selected').data('module'),blocks.html(''),AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),view:'Edit',mode:'dynamic',selectedModule:_this2.sourceModule}).done(function(data){blocks.html(data),App.Fields.Picklist.changeSelectElementView(blocks),_this2.loadConditionBuilderView();});});},/**
		 * Register events
		 */registerEvents:function registerEvents(){this.container=$('#EditView'),this.sourceModule=this.container.find('#inputSourceModule').data('module'),this.record=this.container.find('input[name="record"]').val(),this.registerSourceModuleChange(),this.loadConditionBuilderView(),this.registerSubmitEvent(),this.container.validationEngine(app.validationEngineOptions);}});
//# sourceMappingURL=Edit.min.js.map
