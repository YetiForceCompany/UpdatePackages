'use strict';

Vtiger_RelatedList_Js('PriceBooks_RelatedList_Js',{triggerMassMargin:function triggerMassMargin(){var self=Vtiger_RelatedList_Js.relatedListInstance,selected_ids=self.readSelectedIds(!0),excluded_ids=self.readExcludedIds(!0);!0===self.checkListRecordSelected()?self.noRecordSelectedAlert():app.showModalWindow({url:'index.php?module=PriceBooks&view=SpecifyMargin',cb:function cb(modalContainer){modalContainer.find('.js-modal__save').on('click',function(e){var element=modalContainer.find('.js-margin'),resultOfValidation=Vtiger_NumberUserFormat_Validator_Js.invokeValidation(element);if('undefined'!=typeof resultOfValidation)element.validationEngine('showPrompt',resultOfValidation,'','topLeft',!0),e.preventDefault();else {element.validationEngine('hideAll');var postData=self.getCompleteParams();delete postData.view,postData.selected_ids=selected_ids,postData.excluded_ids=excluded_ids,postData.mode='specifyMargin',postData.action='RelationAjax',postData.relatedModule=self.moduleName,postData.record=self.getParentId(),postData.margin=element.val(),AppConnector.request(postData).done(function(response){response.success&&(Vtiger_Detail_Js.reloadRelatedList(),app.hideModalWindow());});}return !1});}});}},{registerEditListPrice:function registerEditListPrice(){var thisInstance=this,element=this.content.find('.js-edit-listprice');element.validationEngine(app.validationEngineOptions),element.on('change',function(e){e.stopPropagation();var element=$(e.currentTarget);element.formatNumber(),element.validationEngine('validate')||AppConnector.request({module:thisInstance.parentModuleName,record:element.closest('.js-list__row').data('id'),action:'RelationAjax',mode:'addListPrice',src_record:thisInstance.parentRecordId,related_module:thisInstance.moduleName,price:element.val()}).done(function(responseData){responseData.result&&app.showNotify({text:app.vtranslate('JS_SAVE_NOTIFY_OK'),type:'success'});});});},registerPostLoadEvents:function registerPostLoadEvents(){this._super(),this.registerEditListPrice();}});
//# sourceMappingURL=RelatedList.min.js.map
