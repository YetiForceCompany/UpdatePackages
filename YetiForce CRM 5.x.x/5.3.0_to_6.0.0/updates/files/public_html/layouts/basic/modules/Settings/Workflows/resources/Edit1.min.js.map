{"version":3,"file":"Edit1.min.js","sources":["Edit1.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nSettings_Workflows_Edit_Js(\n\t'Settings_Workflows_Edit1_Js',\n\t{},\n\t{\n\t\tinit: function () {\n\t\t\tthis.initialize();\n\t\t},\n\t\t/**\n\t\t * Function to get the container which holds all the reports step1 elements\n\t\t * @return jQuery object\n\t\t */\n\t\tgetContainer: function () {\n\t\t\treturn this.step1Container;\n\t\t},\n\n\t\t/**\n\t\t * Function to set the reports step1 container\n\t\t * @params : element - which represents the reports step1 container\n\t\t * @return : current instance\n\t\t */\n\t\tsetContainer: function (element) {\n\t\t\tthis.step1Container = element;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Function  to intialize the reports step1\n\t\t */\n\t\tinitialize: function (container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = jQuery('#workflow_step1');\n\t\t\t}\n\t\t\tif (container.is('#workflow_step1')) {\n\t\t\t\tthis.setContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setContainer(jQuery('#workflow_step1'));\n\t\t\t}\n\t\t},\n\n\t\tsubmit: function () {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar form = this.getContainer();\n\t\t\tvar formData = form.serializeFormData();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(formData).done(function (data) {\n\t\t\t\tform.hide();\n\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\tmode: 'hide'\n\t\t\t\t});\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to register event for scheduled workflows UI\n\t\t */\n\t\tregisterEventForScheduledWorkflow: function () {\n\t\t\tlet container = $('.js-wf-executions-container');\n\t\t\t$('input[name=\"execution_condition\"]').on('click', function (e) {\n\t\t\t\tlet element = $(e.currentTarget),\n\t\t\t\t\titemBox = element.closest('.js-wf-execution-container').find('.js-wf-execution-item');\n\t\t\t\tcontainer.find('.js-wf-execution-item').addClass('d-none');\n\t\t\t\tif (itemBox.length && element.prop('checked')) {\n\t\t\t\t\titemBox.removeClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tapp.registerEventForClockPicker($('.clockPicker'));\n\t\t\tApp.Fields.Date.register('#scheduleByDate', true);\n\t\t\tApp.Fields.DateTime.register('#scheduleByDate', true);\n\t\t\tlet newElement = App.Fields.Date.register('#annualDates', false, {\n\t\t\t\tmaxViewMode: 1,\n\t\t\t\tmultidate: true,\n\t\t\t\tautoclose: false\n\t\t\t}).on('changeDate', function (e) {\n\t\t\t\tlet values = [];\n\t\t\t\tfor (var index in e.dates) {\n\t\t\t\t\tlet date = e.dates[index];\n\t\t\t\t\tlet formated = moment(date).format(CONFIG.dateFormat.toUpperCase());\n\t\t\t\t\tvalues.push(formated);\n\t\t\t\t}\n\t\t\t\tcontainer.find('#annualDates').val(values.join(','));\n\t\t\t});\n\t\t\tnewElement\n\t\t\t\t.closest('.date')\n\t\t\t\t.find('.js-date__btn')\n\t\t\t\t.on('click', (e) => {\n\t\t\t\t\tnewElement.trigger('click');\n\t\t\t\t});\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofweek'));\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofmonth'));\n\t\t},\n\n\t\tregisterEventForChangeInScheduledType: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('#schtypeid').on('change', function (e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar value = element.val();\n\n\t\t\t\tthisInstance.hideScheduledTime();\n\t\t\t\tthisInstance.hideScheduledWeekList();\n\t\t\t\tthisInstance.hideScheduledMonthByDateList();\n\t\t\t\tthisInstance.hideScheduledSpecificDate();\n\t\t\t\tthisInstance.hideScheduledAnually();\n\t\t\t\tif ($.inArray(value, ['2', '11', '12', '13']) != -1) {\n\t\t\t\t\t//hourly\n\t\t\t\t\tthisInstance.showScheduledTime();\n\t\t\t\t} else if (value == '3') {\n\t\t\t\t\t//weekly\n\t\t\t\t\tthisInstance.showScheduledWeekList();\n\t\t\t\t} else if (value == '4') {\n\t\t\t\t\t//specific date\n\t\t\t\t\tthisInstance.showScheduledSpecificDate();\n\t\t\t\t} else if (value == '5') {\n\t\t\t\t\t//monthly by day\n\t\t\t\t\tthisInstance.showScheduledMonthByDateList();\n\t\t\t\t} else if (value == '7') {\n\t\t\t\t\tthisInstance.showScheduledAnually();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thideScheduledTime: function () {\n\t\t\tjQuery('#scheduledTime').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledTime: function () {\n\t\t\tjQuery('#scheduledTime').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledWeekList: function () {\n\t\t\tjQuery('#scheduledWeekDay').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledWeekList: function () {\n\t\t\tjQuery('#scheduledWeekDay').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledMonthByDateList: function () {\n\t\t\tjQuery('#scheduleMonthByDates').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledMonthByDateList: function () {\n\t\t\tjQuery('#scheduleMonthByDates').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledSpecificDate: function () {\n\t\t\tjQuery('#scheduleByDate').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledSpecificDate: function () {\n\t\t\tjQuery('#scheduleByDate').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledAnually: function () {\n\t\t\tjQuery('#scheduleAnually').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledAnually: function () {\n\t\t\tjQuery('#scheduleAnually').removeClass('d-none');\n\t\t},\n\n\t\tregisterEvents: function () {\n\t\t\tvar container = this.getContainer();\n\n\t\t\t//After loading 1st step only, we will enable the Next button\n\t\t\tcontainer.find('[type=\"submit\"]').removeAttr('disabled');\n\n\t\t\tvar opts = app.validationEngineOptions;\n\t\t\t// to prevent the page reload after the validation has completed\n\t\t\topts['onValidationComplete'] = function (form, valid) {\n\t\t\t\t//returns the valid status\n\t\t\t\treturn valid;\n\t\t\t};\n\t\t\topts['promptPosition'] = 'bottomRight';\n\t\t\tcontainer.validationEngine(opts);\n\n\t\t\tthis.registerEventForScheduledWorkflow();\n\t\t\tthis.registerEventForChangeInScheduledType();\n\t\t}\n\t}\n);\n"],"names":["Settings_Workflows_Edit_Js","init","initialize","getContainer","step1Container","setContainer","element","container","jQuery","is","submit","Deferred","form","formData","serializeFormData","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","request","done","data","hide","mode","aDeferred","resolve","promise","registerEventForScheduledWorkflow","$","on","e","currentTarget","itemBox","closest","find","addClass","length","prop","removeClass","app","registerEventForClockPicker","App","Fields","Date","register","DateTime","maxViewMode","multidate","autoclose","dates","index","formated","moment","date","format","CONFIG","dateFormat","toUpperCase","values","push","val","join","newElement","trigger","Picklist","showSelect2ElementView","registerEventForChangeInScheduledType","value","thisInstance","hideScheduledTime","hideScheduledWeekList","hideScheduledMonthByDateList","hideScheduledSpecificDate","hideScheduledAnually","inArray","showScheduledWeekList","showScheduledSpecificDate","showScheduledMonthByDateList","showScheduledAnually","showScheduledTime","registerEvents","removeAttr","validationEngineOptions","opts","valid","validationEngine"],"mappings":"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"}