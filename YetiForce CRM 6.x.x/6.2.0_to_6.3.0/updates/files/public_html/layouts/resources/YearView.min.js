'use strict';

/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */'use strict';var FC=$.fullCalendar,// a reference to FullCalendar's root namespace
View=FC.View;// the class that all views must inherit from
/**
 * Creates fullcalendar's View year subclass
 */FC.views.year=View.extend({calendarView:!1,renderHtml:function renderHtml(year){var col2Breakpoint="col-xxl-2";return "all"===$("#switchingDays").val()&&(col2Breakpoint="col-xxxl-2"),"\n\t\t\t<div class=\"h-100 fc-year\">\n\t\t\t\t<div class=\"fc-year__container row no-gutters\">\n\t\t\t\t\t<div class=\"fc-january fc-year__month col-sm-6 col-lg-4 col-xl-3 ".concat(col2Breakpoint,"\" data-date=\"").concat(year,"-01-01\"></div>\n\t\t\t\t\t<div class=\"fc-february fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-02-01\"></div>\n\t\t\t\t\t<div class=\"fc-march fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-03-01\"></div>\n\t\t\t\t\t<div class=\"fc-april fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-04-01\"></div>\n\t\t\t\t\t<div class=\"fc-may fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-05-01\"></div>\n\t\t\t\t\t<div class=\"fc-june fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-06-01\"></div>\n\t\t\t\t\t<div class=\"fc-july fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-07-01\"></div>\n\t\t\t\t\t<div class=\"fc-august fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-08-01\"></div>\n\t\t\t\t\t<div class=\"fc-september fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-09-01\"></div>\n\t\t\t\t\t<div class=\"fc-october fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-10-01\"></div>\n\t\t\t\t\t<div class=\"fc-november fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-11-01\"></div>\n\t\t\t\t\t<div class=\"fc-december fc-year__month col-sm-6 col-lg-4 col-xl-3 ").concat(col2Breakpoint,"\" data-date=\"").concat(year,"-12-01\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t")},loadMonthData:function loadMonthData(calendar,events){var i,thisInstance=this,height=calendar.find(".fc-bg :first").height()-calendar.find(".fc-day-number").height()-10,width=calendar.find(".fc-day-number").width()/2-10;for(i in events.result)events.result[i].width=width,events.result[i].height=height;calendar.fullCalendar("addEventSource",events.result),calendar.find(".js-show-day").on("click",function(){var date=moment($(this).data("date")).format();thisInstance.getCalendarView().fullCalendar("changeView","agendaDay",date),$(".js-sub-record .active").click();}),calendar.find(".fc-center").on("click",function(){var date=moment($(this).closest("[data-date]").data("date")).format();thisInstance.getCalendarView().fullCalendar("changeView","month",date),$(".js-sub-record .active").click();});},appendWeekButton:function appendWeekButton(){var _this=this;$(".fc-row.fc-week.fc-widget-content").each(function(){var date=$(this).find(".fc-day-top").first().data("date");if(date!==void 0){var actualWeek=moment(date).format("WW");$(this).prepend("<div class=\"js-show-week js-popover-tooltip fc-year__show-week-btn\" data-toggle=\"popover\" data-date=\"".concat(date,"\" data-content=\"").concat(app.vtranslate("JS_WEEK")," ").concat(actualWeek,"\" role=\"tooltip\" data-js=\"click | popover\">").concat(actualWeek,"</div>"));}}),this.getCalendarView().find(".js-show-week").on("click",function(e){$(e.currentTarget).popover("hide");var date=moment($(e.currentTarget).data("date")).format();_this.getCalendarView().fullCalendar("changeView","agendaWeek",date),$(".js-sub-record .active").click();});},render:function render(){var self=this,calendar=self.getCalendarView().fullCalendar("getCalendar"),date=calendar.getDate().year(),yearView=this.el.html(this.renderHtml(date)),user=this.getSelectedUsersCalendar(),progressInstance=$.progressIndicator({blockInfo:{enabled:!0}}),cvid=this.getCurrentCvId();0===user.length&&(user=[app.getMainParams("userId")]);var dateFormat=CONFIG.dateFormat.toUpperCase();this.clearFilterButton(user,cvid);var options={module:this.module,action:"Calendar",mode:"getEventsYear",start:moment(date+"-01-01").format(dateFormat),end:moment(date+"-12-31").format(dateFormat),user:user,yearView:!0,time:app.getMainParams("showType"),cvid:cvid,historyUrl:"index.php?module=".concat(this.module,"&view=CalendarExtended&history=true&viewType=").concat(calendar.view.type,"&start=").concat(moment(date+"-01-01").format(dateFormat),"&end=").concat(moment(date+"-12-31").format(dateFormat),"&user=").concat(user,"&time=").concat(app.getMainParams("showType"),"&cvid=").concat(cvid,"&hiddenDays=").concat(calendar.view.options.hiddenDays)};options=$.extend(this.getDefaultParams(),options);var connectorMethod=window.AppConnector.request;this.browserHistory&&window.calendarLoaded&&(connectorMethod=window.AppConnector.requestPjax),this.browserHistoryConfig&&Object.keys(this.browserHistoryConfig).length&&window.calendarLoaded&&(options=Object.assign(options,{start:moment(this.browserHistoryConfig.start).format(dateFormat),end:moment(this.browserHistoryConfig.end).format(dateFormat),user:this.browserHistoryConfig.user,time:this.browserHistoryConfig.time,cvid:this.browserHistoryConfig.cvid}),connectorMethod=window.AppConnector.request,app.setMainParams("showType",this.browserHistoryConfig.time),app.setMainParams("usersId",this.browserHistoryConfig.user));var className=this.baseInstance.constructor.name;connectorMethod(options).done(function(events){yearView.find(".fc-year__month").each(function(i){var calendarInstance=new window[className](self.container,self.readonly),basicOptions=calendarInstance.setCalendarMinimalOptions(),monthOptions={defaultView:"month",titleFormat:"MMMM",header:{center:"title",left:!1,right:!1},height:"auto",select:function select(start,end){self.selectDays(start,end);},hiddenDays:calendar.view.options.hiddenDays,showNonCurrentDates:!1,defaultDate:moment(calendar.getDate().year()+"-"+(i+1),"YYYY-MM-DD"),eventRender:function eventRender(event,element){return "background"===event.rendering?(element.append("<span class=\"js-popover-tooltip\" data-content=\"".concat(event.title,"\" data-toggle=\"popover\"><span class=\"").concat(event.icon,"\"></span></span>")),element):(event.countShow="99+",100>event.count&&(event.countShow=event.count),element="<div class=\"js-show-day cell-calendar u-cursor-pointer d-flex\" data-date=\"".concat(event.date,"\" data-js=\"click\">\n\t\t\t\t\t\t\t<a class=\"u-z-index-100 fc-year__show-day-btn mx-auto\" href=\"#\" data-date=\"").concat(event.date,"\" title=\"").concat(event.count,"\">\n\t\t\t\t\t\t\t\t  <span class=\"fc-year__show-day-btn__container\">\n\t\t\t\t\t\t\t\t\t<span class=\"fas fa-calendar fa-lg\"></span>\n\t\t\t\t\t\t\t\t\t<span class=\"fc-year__show-day-btn__text fa-inverse u-font-weight-700\">").concat(event.countShow,"</span>\n\t\t\t\t\t\t\t\t  </span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>"),element)}};self.loadMonthData($(this).fullCalendar($.extend(basicOptions,monthOptions)),events);}),"1"===app.getMainParams("weekCount")&&self.appendWeekButton();var yearViewContainer=self.container.find(".fc-view-container").first();yearViewContainer.height($(window).height()-yearViewContainer.offset().top-$(".js-footer").height()).addClass("u-overflow-y-auto u-overflow-x-hidden"),progressInstance.progressIndicator({mode:"hide"});}),this.registerTodayButtonYearChange(calendar),this.registerViewRenderEvents(calendar.view),window.calendarLoaded=!0;},/**
	 * Function extends today button functionality for year view
	 * @param {jQuery} calendar
	 */registerTodayButtonYearChange:function registerTodayButtonYearChange(calendar){calendar.currentDate.format("YYYY")===moment().format("YYYY")?calendar.el.find(".fc-today-button").addClass("fc-state-disabled"):calendar.el.find(".fc-today-button").removeClass("fc-state-disabled");}});
//# sourceMappingURL=YearView.min.js.map
