{"version":3,"file":"Edit1.min.js","sources":["Edit1.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nSettings_Workflows_Edit_Js(\n\t'Settings_Workflows_Edit1_Js',\n\t{},\n\t{\n\t\tinit: function () {\n\t\t\tthis.initialize();\n\t\t},\n\t\t/**\n\t\t * Function to get the container which holds all the reports step1 elements\n\t\t * @return jQuery object\n\t\t */\n\t\tgetContainer: function () {\n\t\t\treturn this.step1Container;\n\t\t},\n\n\t\t/**\n\t\t * Function to set the reports step1 container\n\t\t * @params : element - which represents the reports step1 container\n\t\t * @return : current instance\n\t\t */\n\t\tsetContainer: function (element) {\n\t\t\tthis.step1Container = element;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Function  to intialize the reports step1\n\t\t */\n\t\tinitialize: function (container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = jQuery('#workflow_step1');\n\t\t\t}\n\t\t\tif (container.is('#workflow_step1')) {\n\t\t\t\tthis.setContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setContainer(jQuery('#workflow_step1'));\n\t\t\t}\n\t\t},\n\n\t\tsubmit: function () {\n\t\t\tvar aDeferred = jQuery.Deferred();\n\t\t\tvar form = this.getContainer();\n\t\t\tvar formData = form.serializeFormData();\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(formData).done(function (data) {\n\t\t\t\tform.hide();\n\t\t\t\tprogressIndicatorElement.progressIndicator({\n\t\t\t\t\tmode: 'hide'\n\t\t\t\t});\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/**\n\t\t * Function to register event for scheduled workflows UI\n\t\t */\n\t\tregisterEventForScheduledWorkflow: function () {\n\t\t\tlet container = $('.js-wf-executions-container');\n\t\t\t$('input[name=\"execution_condition\"]').on('click', function (e) {\n\t\t\t\tlet element = $(e.currentTarget),\n\t\t\t\t\titemBox = element.closest('.js-wf-execution-container').find('.js-wf-execution-item');\n\t\t\t\tcontainer.find('.js-wf-execution-item').addClass('d-none');\n\t\t\t\tif (itemBox.length && element.prop('checked')) {\n\t\t\t\t\titemBox.removeClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tapp.registerEventForClockPicker($('.clockPicker'));\n\t\t\tApp.Fields.Date.register('#scheduleByDate', true);\n\t\t\tApp.Fields.DateTime.register($('#scheduleByDate'));\n\t\t\tlet newElement = App.Fields.Date.register('#annualDates', false, {\n\t\t\t\tmaxViewMode: 1,\n\t\t\t\tmultidate: true,\n\t\t\t\tautoclose: false\n\t\t\t}).on('changeDate', function (e) {\n\t\t\t\tlet values = [];\n\t\t\t\tfor (var index in e.dates) {\n\t\t\t\t\tlet date = e.dates[index];\n\t\t\t\t\tlet formated = moment(date).format(CONFIG.dateFormat.toUpperCase());\n\t\t\t\t\tvalues.push(formated);\n\t\t\t\t}\n\t\t\t\tcontainer.find('#annualDates').val(values.join(','));\n\t\t\t});\n\t\t\tnewElement\n\t\t\t\t.closest('.date')\n\t\t\t\t.find('.js-date__btn')\n\t\t\t\t.on('click', (e) => {\n\t\t\t\t\tnewElement.trigger('click');\n\t\t\t\t});\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofweek'));\n\t\t\tApp.Fields.Picklist.showSelect2ElementView($('#schdayofmonth'));\n\t\t},\n\n\t\tregisterEventForChangeInScheduledType: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tjQuery('#schtypeid').on('change', function (e) {\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar value = element.val();\n\n\t\t\t\tthisInstance.hideScheduledTime();\n\t\t\t\tthisInstance.hideScheduledWeekList();\n\t\t\t\tthisInstance.hideScheduledMonthByDateList();\n\t\t\t\tthisInstance.hideScheduledSpecificDate();\n\t\t\t\tthisInstance.hideScheduledAnually();\n\t\t\t\tif ($.inArray(value, ['2', '11', '12', '13']) != -1) {\n\t\t\t\t\t//hourly\n\t\t\t\t\tthisInstance.showScheduledTime();\n\t\t\t\t} else if (value == '3') {\n\t\t\t\t\t//weekly\n\t\t\t\t\tthisInstance.showScheduledWeekList();\n\t\t\t\t} else if (value == '4') {\n\t\t\t\t\t//specific date\n\t\t\t\t\tthisInstance.showScheduledSpecificDate();\n\t\t\t\t} else if (value == '5') {\n\t\t\t\t\t//monthly by day\n\t\t\t\t\tthisInstance.showScheduledMonthByDateList();\n\t\t\t\t} else if (value == '7') {\n\t\t\t\t\tthisInstance.showScheduledAnually();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thideScheduledTime: function () {\n\t\t\tjQuery('#scheduledTime').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledTime: function () {\n\t\t\tjQuery('#scheduledTime').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledWeekList: function () {\n\t\t\tjQuery('#scheduledWeekDay').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledWeekList: function () {\n\t\t\tjQuery('#scheduledWeekDay').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledMonthByDateList: function () {\n\t\t\tjQuery('#scheduleMonthByDates').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledMonthByDateList: function () {\n\t\t\tjQuery('#scheduleMonthByDates').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledSpecificDate: function () {\n\t\t\tjQuery('#scheduleByDate').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledSpecificDate: function () {\n\t\t\tjQuery('#scheduleByDate').removeClass('d-none');\n\t\t},\n\n\t\thideScheduledAnually: function () {\n\t\t\tjQuery('#scheduleAnually').addClass('d-none');\n\t\t},\n\n\t\tshowScheduledAnually: function () {\n\t\t\tjQuery('#scheduleAnually').removeClass('d-none');\n\t\t},\n\n\t\tregisterEvents: function () {\n\t\t\tvar container = this.getContainer();\n\n\t\t\t//After loading 1st step only, we will enable the Next button\n\t\t\tcontainer.find('[type=\"submit\"]').removeAttr('disabled');\n\n\t\t\tvar opts = app.validationEngineOptions;\n\t\t\t// to prevent the page reload after the validation has completed\n\t\t\topts['onValidationComplete'] = function (form, valid) {\n\t\t\t\t//returns the valid status\n\t\t\t\treturn valid;\n\t\t\t};\n\t\t\topts['promptPosition'] = 'bottomRight';\n\t\t\tcontainer.validationEngine(opts);\n\n\t\t\tthis.registerEventForScheduledWorkflow();\n\t\t\tthis.registerEventForChangeInScheduledType();\n\t\t}\n\t}\n);\n"],"names":["Settings_Workflows_Edit_Js","init","initialize","getContainer","step1Container","setContainer","element","container","jQuery","is","submit","aDeferred","Deferred","form","formData","serializeFormData","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","AppConnector","request","done","data","hide","mode","resolve","promise","registerEventForScheduledWorkflow","$","on","e","currentTarget","itemBox","closest","find","addClass","length","prop","removeClass","app","registerEventForClockPicker","App","Fields","Date","register","DateTime","newElement","maxViewMode","multidate","autoclose","values","index","dates","date","formated","moment","format","CONFIG","dateFormat","toUpperCase","push","val","join","trigger","Picklist","showSelect2ElementView","registerEventForChangeInScheduledType","thisInstance","value","hideScheduledTime","hideScheduledWeekList","hideScheduledMonthByDateList","hideScheduledSpecificDate","hideScheduledAnually","inArray","showScheduledWeekList","showScheduledSpecificDate","showScheduledMonthByDateList","showScheduledAnually","showScheduledTime","registerEvents","removeAttr","opts","validationEngineOptions","valid","validationEngine"],"mappings":"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"}