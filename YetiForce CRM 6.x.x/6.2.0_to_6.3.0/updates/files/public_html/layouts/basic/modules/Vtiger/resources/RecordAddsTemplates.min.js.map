{"version":3,"file":"RecordAddsTemplates.min.js","sources":["RecordAddsTemplates.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n$.Class(\n\t'Base_RecordAddsTemplates_JS',\n\t{},\n\t{\n\t\teditInstance: false,\n\t\t/**\n\t\t * Function listener to send a form\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterSubmitForm: function (container) {\n\t\t\tconst aDeferred = $.Deferred();\n\t\t\tlet instanse = this;\n\t\t\tcontainer.on('click', '.js-modal__save', () => {\n\t\t\t\tlet params = {\n\t\t\t\t\taction: 'RecordAddsTemplates',\n\t\t\t\t\trecordAddsType: container.find('.js-modal-body').find(\"[name='recordAddsType']\").val()\n\t\t\t\t};\n\t\t\t\tlet validate = true;\n\t\t\t\tcontainer.find('form.js-record-template').each(function () {\n\t\t\t\t\tlet form = $(this);\n\t\t\t\t\tinstanse.editInstance.registerValidationsFields(form);\n\t\t\t\t\tlet formSerializeData = form.serializeFormData();\n\t\t\t\t\tparams[formSerializeData.module] = formSerializeData;\n\t\t\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\t\t\tvalidate = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (validate) {\n\t\t\t\t\tAppConnector.request(params)\n\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\tlet response = data.result;\n\t\t\t\t\t\t\tlet preSave = response.preSave;\n\t\t\t\t\t\t\tif (typeof preSave !== 'undefined' && preSave.length) {\n\t\t\t\t\t\t\t\tfor (let i = 0; i < preSave.length; i++) {\n\t\t\t\t\t\t\t\t\tif (preSave[i] !== null && preSave[i].result !== true) {\n\t\t\t\t\t\t\t\t\t\tapp.showNotify(preSave[i].message ? preSave[i].message : app.vtranslate('JS_ERROR'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (response.url) {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = response.url;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (response.length <= 0) {\n\t\t\t\t\t\t\t\taDeferred.resolve(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: errorThrown,\n\t\t\t\t\t\t\t\ttype: textStatus\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register events function\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.editInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.editInstance.registerBasicEvents(modalContainer);\n\t\t\tthis.registerSubmitForm(modalContainer);\n\t\t}\n\t}\n);\n"],"names":["$","Class","editInstance","registerSubmitForm","container","aDeferred","Deferred","instanse","on","params","action","recordAddsType","find","val","validate","each","form","registerValidationsFields","formSerializeData","serializeFormData","module","validationEngine","AppConnector","request","done","data","response","result","preSave","length","i","app","showNotify","message","vtranslate","success","hideModalWindow","text","type","url","window","location","href","reload","resolve","fail","textStatus","errorThrown","errorLog","registerEvents","modalContainer","Vtiger_Edit_Js","getInstance","registerBasicEvents"],"mappings":"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"}