{"version":3,"file":"Edit3.min.js","sources":["Edit3.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nSettings_Workflows_Edit_Js(\n\t'Settings_Workflows_Edit3_Js',\n\t{},\n\t{\n\t\tstep3Container: false,\n\t\tadvanceFilterInstance: false,\n\t\tconditionBuilderInstance: false,\n\t\tckEditorInstance: false,\n\t\tfieldValueMap: false,\n\t\tinit: function () {\n\t\t\tthis.initialize();\n\t\t},\n\t\t/**\n\t\t * Function to get the container which holds all the reports step1 elements\n\t\t * @return jQuery object\n\t\t */\n\t\tgetContainer: function () {\n\t\t\treturn this.step3Container;\n\t\t},\n\t\t/**\n\t\t * Function to set the reports step1 container\n\t\t * @params : element - which represents the reports step1 container\n\t\t * @return : current instance\n\t\t */\n\t\tsetContainer: function (element) {\n\t\t\tthis.step3Container = element;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function  to intialize the reports step1\n\t\t */\n\t\tinitialize: function (container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = $('#workflow_step3');\n\t\t\t}\n\t\t\tif (container.is('#workflow_step3')) {\n\t\t\t\tthis.setContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setContainer($('#workflow_step3'));\n\t\t\t}\n\t\t},\n\t\tregisterEditTaskEvent: function () {\n\t\t\tlet thisInstance = this,\n\t\t\t\tcontainer = this.getContainer();\n\t\t\tcontainer.on('click', '[data-url]', function (e) {\n\t\t\t\tlet currentElement = $(e.currentTarget),\n\t\t\t\t\tparams = currentElement.data('url'),\n\t\t\t\t\tprogressIndicatorElement = $.progressIndicator({\n\t\t\t\t\t\tposition: 'html',\n\t\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tapp.showModalWindow(null, params, function (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tlet clipboard = App.Fields.Text.registerCopyClipboard(data);\n\t\t\t\t\t\tcontainer.one('hidden.bs.modal', () => {\n\t\t\t\t\t\t\tclipboard.destroy();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tthisInstance.registerVTCreateTodoTaskEvents();\n\t\t\t\t\tvar taskType = $('#taskType').val();\n\t\t\t\t\tvar functionName = 'register' + taskType + 'Events';\n\t\t\t\t\tif (typeof thisInstance[functionName] !== 'undefined') {\n\t\t\t\t\t\tthisInstance[functionName].apply(thisInstance);\n\t\t\t\t\t}\n\t\t\t\t\tthisInstance.registerSaveTaskSubmitEvent(taskType);\n\t\t\t\t\t$('#saveTask').validationEngine(app.validationEngineOptions);\n\t\t\t\t\tthisInstance.registerFillTaskFieldsEvent();\n\t\t\t\t\tthisInstance.registerCheckSelectDateEvent();\n\t\t\t\t\tApp.Tools.VariablesPanel.registerRefreshCompanyVariables(data);\n\t\t\t\t\tthisInstance.conditionBuilderInstance = new Vtiger_ConditionBuilder_Js(\n\t\t\t\t\t\tdata.find('.js-condition-builder'),\n\t\t\t\t\t\tdata.find('.js-source-module').val()\n\t\t\t\t\t);\n\t\t\t\t\tthisInstance.conditionBuilderInstance.registerEvents();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterCheckSelectDateEvent: function () {\n\t\t\t$('[name=\"check_select_date\"]').on('change', function (e) {\n\t\t\t\tif ($(e.currentTarget).is(':checked')) {\n\t\t\t\t\t$('#checkSelectDateContainer').removeClass('d-none').addClass('show');\n\t\t\t\t} else {\n\t\t\t\t\t$('#checkSelectDateContainer').removeClass('show').addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register save task submit event\n\t\t * @param {string} taskType\n\t\t */\n\t\tregisterSaveTaskSubmitEvent(taskType) {\n\t\t\t$('#saveTask').on('submit', (e) => {\n\t\t\t\tlet form = $(e.currentTarget);\n\t\t\t\tif (form.validationEngine('validate') === true) {\n\t\t\t\t\tlet customValidationFunctionName = taskType + 'CustomValidation';\n\t\t\t\t\tif (typeof this[customValidationFunctionName] !== 'undefined') {\n\t\t\t\t\t\tlet result = this[customValidationFunctionName].apply(this);\n\t\t\t\t\t\tif (result !== true) {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\t\ttext: result,\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlet preSaveActionFunctionName = 'preSave' + taskType;\n\t\t\t\t\tif (typeof this[preSaveActionFunctionName] !== 'undefined') {\n\t\t\t\t\t\tthis[preSaveActionFunctionName].apply(this, [taskType]);\n\t\t\t\t\t}\n\t\t\t\t\tlet formData = form.serializeFormData();\n\t\t\t\t\tformData.entity_type = form.find('.createEntityModule:visible option:selected').val();\n\t\t\t\t\tAppConnector.request(formData).done((data) => {\n\t\t\t\t\t\tif (data.result) {\n\t\t\t\t\t\t\tthis.getTaskList();\n\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t},\n\t\tVTUpdateFieldsTaskCustomValidation: function () {\n\t\t\treturn this.checkDuplicateFieldsSelected();\n\t\t},\n\t\tVTCreateEntityTaskCustomValidation: function () {\n\t\t\treturn this.checkDuplicateFieldsSelected();\n\t\t},\n\t\tcheckDuplicateFieldsSelected: function () {\n\t\t\tvar selectedFieldNames = $('#save_fieldvaluemapping').find('.js-conditions-row').find('[name=\"fieldname\"]');\n\t\t\tvar result = true;\n\t\t\tvar failureMessage = app.vtranslate('JS_SAME_FIELDS_SELECTED_MORE_THAN_ONCE');\n\t\t\t$.each(selectedFieldNames, function (i, ele) {\n\t\t\t\tvar fieldName = $(ele).attr('value');\n\t\t\t\tvar fields = $('[name=' + fieldName + ']').not(':hidden');\n\t\t\t\tif (fields.length > 1) {\n\t\t\t\t\tresult = failureMessage;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result;\n\t\t},\n\t\tpreSaveVTUpdateFieldsTask: function (tasktype) {\n\t\t\tvar values = this.getValues(tasktype);\n\t\t\t$('[name=\"field_value_mapping\"]').val(JSON.stringify(values));\n\t\t},\n\t\tpreSaveVTCreateEntityTask: function (tasktype) {\n\t\t\tvar values = this.getValues(tasktype);\n\t\t\t$('[name=\"field_value_mapping\"]').val(JSON.stringify(values));\n\t\t},\n\t\tpreSaveVTEmailTask: function (tasktype) {\n\t\t\tvar textAreaElement = $('#content');\n\t\t\t//To keep the plain text value to the textarea which need to be\n\t\t\t//sent to server\n\t\t\ttextAreaElement.val(CKEDITOR.instances['content'].getData());\n\t\t},\n\t\tpreSaveVTUpdateRelatedFieldTask: function (tasktype) {\n\t\t\tvar values = this.getValues(tasktype);\n\t\t\t$('[name=\"field_value_mapping\"]').val(JSON.stringify(values));\n\t\t},\n\t\tpreSaveSumFieldFromDependent: function (tasktype) {\n\t\t\t$('[name=\"conditions\"]').val(JSON.stringify(this.conditionBuilderInstance.getConditions()));\n\t\t},\n\t\t/**\n\t\t * Function to check if the field selected is empty field\n\t\t * @params : select element which represents the field\n\t\t * @return : boolean true/false\n\t\t */\n\t\tisEmptyFieldSelected: function (fieldSelect) {\n\t\t\tvar selectedOption = fieldSelect.find('option:selected');\n\t\t\t//assumption that empty field will be having value none\n\t\t\tif (selectedOption.val() === 'none' || !selectedOption.val()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tgetVTCreateEntityTaskFieldList: function () {\n\t\t\treturn new Array('fieldname', 'value', 'valuetype', 'modulename');\n\t\t},\n\t\tgetVTUpdateFieldsTaskFieldList: function () {\n\t\t\treturn new Array('fieldname', 'value', 'valuetype');\n\t\t},\n\t\tgetVTUpdateRelatedFieldTaskFieldList: function () {\n\t\t\treturn new Array('fieldname', 'value', 'valuetype');\n\t\t},\n\t\t/**\n\t\t * Get values\n\t\t * @param {string} tasktype\n\t\t * @returns {Array}\n\t\t */\n\t\tgetValues(tasktype) {\n\t\t\tlet fieldListFunctionName = 'get' + tasktype + 'FieldList',\n\t\t\t\tfieldList = [];\n\t\t\tif (typeof this[fieldListFunctionName] !== 'undefined') {\n\t\t\t\tfieldList = this[fieldListFunctionName].apply();\n\t\t\t}\n\n\t\t\tlet values = [];\n\t\t\t$('.js-conditions-row', $('#save_fieldvaluemapping')).each((i, conditionDomElement) => {\n\t\t\t\tlet rowElement = $(conditionDomElement),\n\t\t\t\t\tfieldSelectElement = $('[name=\"fieldname\"]', rowElement),\n\t\t\t\t\tvalueSelectElement = $('[data-value=\"value\"]', rowElement);\n\t\t\t\t//To not send empty fields to server\n\t\t\t\tif (this.isEmptyFieldSelected(fieldSelectElement)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tlet fieldDataInfo = fieldSelectElement.find('option:selected').data('fieldinfo'),\n\t\t\t\t\tfieldType = fieldDataInfo.type,\n\t\t\t\t\trowValues = {},\n\t\t\t\t\tkey,\n\t\t\t\t\tfield;\n\t\t\t\tif (fieldType === 'owner') {\n\t\t\t\t\tfor (key in fieldList) {\n\t\t\t\t\t\tfield = fieldList[key];\n\t\t\t\t\t\tif (field == 'value' && valueSelectElement.is('select')) {\n\t\t\t\t\t\t\trowValues[field] = valueSelectElement.find('option:selected').val();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trowValues[field] = $('[name=\"' + field + '\"]', rowElement).val();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (fieldType === 'picklist' || fieldType == 'multipicklist') {\n\t\t\t\t\tfor (key in fieldList) {\n\t\t\t\t\t\tfield = fieldList[key];\n\t\t\t\t\t\tif (field === 'value' && valueSelectElement.is('input')) {\n\t\t\t\t\t\t\tlet pickListValues = valueSelectElement.data('picklistvalues'),\n\t\t\t\t\t\t\t\tvaluesArr = valueSelectElement.val().split(','),\n\t\t\t\t\t\t\t\tnewValuesArr = [];\n\t\t\t\t\t\t\tfor (let j = 0; j < valuesArr.length; j++) {\n\t\t\t\t\t\t\t\tif (typeof pickListValues[valuesArr[j]] !== 'undefined') {\n\t\t\t\t\t\t\t\t\tnewValuesArr.push(pickListValues[valuesArr[j]]);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnewValuesArr.push(valuesArr[j]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trowValues[field] = newValuesArr.join(',');\n\t\t\t\t\t\t} else if (field === 'value' && valueSelectElement.is('select') && fieldType == 'picklist') {\n\t\t\t\t\t\t\trowValues[field] = valueSelectElement.val();\n\t\t\t\t\t\t} else if (field === 'value' && valueSelectElement.is('select') && fieldType == 'multipicklist') {\n\t\t\t\t\t\t\tvar value = valueSelectElement.val();\n\t\t\t\t\t\t\tif (value === null) {\n\t\t\t\t\t\t\t\trowValues[field] = value;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trowValues[field] = value.join(',');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trowValues[field] = $('[name=\"' + field + '\"]', rowElement).val();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (key in fieldList) {\n\t\t\t\t\t\tfield = fieldList[key];\n\t\t\t\t\t\tif (field == 'value') {\n\t\t\t\t\t\t\trowValues[field] = valueSelectElement.val();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trowValues[field] = $('[name=\"' + field + '\"]', rowElement).val();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ($('[name=\"valuetype\"]', rowElement).val() == 'false' || $('[name=\"valuetype\"]', rowElement).length == 0) {\n\t\t\t\t\trowValues['valuetype'] = 'rawtext';\n\t\t\t\t}\n\n\t\t\t\tvalues.push(rowValues);\n\t\t\t});\n\t\t\treturn values;\n\t\t},\n\t\tgetTaskList: function () {\n\t\t\tvar container = this.getContainer();\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tview: 'TasksList',\n\t\t\t\trecord: $('[name=\"record\"]', container).val()\n\t\t\t};\n\t\t\tvar progressIndicatorElement = $.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t$('#taskListContainer').html(data);\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t});\n\t\t},\n\t\tregisterTaskStatusChangeEvent: function () {\n\t\t\tvar container = this.getContainer();\n\t\t\tcontainer.on('change', '.taskStatus', function (e) {\n\t\t\t\tvar currentStatusElement = $(e.currentTarget);\n\t\t\t\tvar url = currentStatusElement.data('statusurl');\n\t\t\t\tif (currentStatusElement.is(':checked')) {\n\t\t\t\t\turl = url + '&status=true';\n\t\t\t\t} else {\n\t\t\t\t\turl = url + '&status=false';\n\t\t\t\t}\n\t\t\t\tvar progressIndicatorElement = $.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\t\tif (data.result == 'ok') {\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_STATUS_CHANGED_SUCCESSFULLY'),\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t\t}\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t});\n\t\t},\n\t\tregisterTaskDeleteEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = this.getContainer();\n\t\t\tcontainer.on('click', '.deleteTask', function (e) {\n\t\t\t\tvar message = app.vtranslate('LBL_DELETE_CONFIRMATION');\n\t\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\t\tmessage: message\n\t\t\t\t}).done(function () {\n\t\t\t\t\tvar currentElement = $(e.currentTarget);\n\t\t\t\t\tvar deleteUrl = currentElement.data('deleteurl');\n\t\t\t\t\tAppConnector.request(deleteUrl).done(function (data) {\n\t\t\t\t\t\tif (data.result == 'ok') {\n\t\t\t\t\t\t\tthisInstance.getTaskList();\n\t\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_TASK_DELETED_SUCCESSFULLY'),\n\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterFillTaskFromEmailFieldEvent: function () {\n\t\t\t$('#saveTask').on('change', '#fromEmailOption', function (e) {\n\t\t\t\tvar currentElement = $(e.currentTarget);\n\t\t\t\tvar inputElement = currentElement.closest('.row').find('.fields');\n\t\t\t\tinputElement.val(currentElement.val());\n\t\t\t});\n\t\t},\n\t\tregisterFillTaskFieldsEvent: function () {\n\t\t\t$('#saveTask').on('change', '.task-fields', function (e) {\n\t\t\t\tvar currentElement = $(e.currentTarget);\n\t\t\t\tvar inputElement = currentElement.closest('.row').find('.fields');\n\t\t\t\tvar oldValue = inputElement.val();\n\t\t\t\tvar newValue = oldValue + currentElement.val();\n\t\t\t\tinputElement.val(newValue);\n\t\t\t});\n\t\t},\n\t\tregisterVTEmailTaskEvents: function () {\n\t\t\tvar textAreaElement = $('#content');\n\t\t\tnew App.Fields.Text.Editor(textAreaElement);\n\t\t\tthis.registerFillTaskFromEmailFieldEvent();\n\t\t\tthis.registerCcAndBccEvents();\n\t\t},\n\t\tregisterVTCreateTodoTaskEvents: function () {\n\t\t\tapp.registerEventForClockPicker();\n\t\t},\n\t\tregisterVTUpdateFieldsTaskEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.registerAddFieldEvent();\n\t\t\tthis.registerDeleteConditionEvent();\n\t\t\tthis.registerFieldChange();\n\t\t\tthis.fieldValueMap = false;\n\t\t\tif ($('#fieldValueMapping').val() != '') {\n\t\t\t\tthis.fieldValueReMapping();\n\t\t\t}\n\t\t\tvar fields = $('#save_fieldvaluemapping').find('select[name=\"fieldname\"]');\n\t\t\t$.each(fields, function (i, field) {\n\t\t\t\tthisInstance.loadFieldSpecificUi($(field));\n\t\t\t});\n\t\t\tthis.getPopUp($('#saveTask'));\n\t\t},\n\t\tregisterVTUpdateRelatedFieldTaskEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.registerAddFieldEvent();\n\t\t\tthis.registerDeleteConditionEvent();\n\t\t\tthis.registerFieldChange();\n\t\t\tthis.fieldValueMap = false;\n\t\t\tif ($('#fieldValueMapping').val() != '') {\n\t\t\t\tthis.fieldValueReMapping();\n\t\t\t}\n\t\t\tvar fields = $('#save_fieldvaluemapping').find('select[name=\"fieldname\"]');\n\t\t\t$.each(fields, function (i, field) {\n\t\t\t\tthisInstance.loadFieldSpecificUi($(field));\n\t\t\t});\n\t\t\tthis.getPopUp($('#saveTask'));\n\t\t},\n\t\t/**\n\t\t * Add field\n\t\t * @param {jQuery|null} replaceElement - if we want to replace existing field container with new one\n\t\t */\n\t\taddField(replaceElement = null) {\n\t\t\tconst newAddFieldContainer = $('.js-add-basic-field-container')\n\t\t\t\t.clone(true, true)\n\t\t\t\t.removeClass('js-add-basic-field-container d-none')\n\t\t\t\t.addClass('js-conditions-row');\n\t\t\t$('select', newAddFieldContainer).addClass('select2');\n\t\t\tif (replaceElement === null) {\n\t\t\t\t$('#save_fieldvaluemapping').append(newAddFieldContainer);\n\t\t\t} else {\n\t\t\t\treplaceElement.replaceWith(newAddFieldContainer);\n\t\t\t}\n\t\t\t//change in to select elements\n\t\t\tApp.Fields.Picklist.changeSelectElementView(newAddFieldContainer);\n\t\t},\n\t\t/**\n\t\t * Register add field event\n\t\t */\n\t\tregisterAddFieldEvent() {\n\t\t\t$('#addFieldBtn').on('click', (e) => {\n\t\t\t\tthis.addField();\n\t\t\t});\n\t\t},\n\t\tregisterDeleteConditionEvent() {\n\t\t\t$('#saveTask').on('click', '.js-condition-delete', (e) => {\n\t\t\t\t$(e.currentTarget).closest('.js-conditions-row').remove();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will register field change event\n\t\t */\n\t\tregisterFieldChange() {\n\t\t\t$('#saveTask').on('change', 'select[name=\"fieldname\"]', (e) => {\n\t\t\t\tconst selectedElement = $(e.currentTarget);\n\t\t\t\tconst conditionRow = selectedElement.closest('.js-conditions-row');\n\t\t\t\tif (selectedElement.val() !== 'none' && selectedElement.val()) {\n\t\t\t\t\tvar moduleNameElement = conditionRow.find('[name=\"modulename\"]');\n\t\t\t\t\tif (moduleNameElement.length > 0) {\n\t\t\t\t\t\tlet workflowModuleName = selectedElement.closest('form').find('#workflowModuleName').val();\n\t\t\t\t\t\tlet selectedOption = selectedElement.find('option:selected');\n\t\t\t\t\t\tvar selectedOptionFieldInfo = selectedOption.data('fieldinfo');\n\t\t\t\t\t\tvar type = selectedOptionFieldInfo.type;\n\t\t\t\t\t\tif (type == 'picklist' || type == 'multipicklist') {\n\t\t\t\t\t\t\tvar selectElement = $('select.createEntityModule:not(:disabled)');\n\t\t\t\t\t\t\tvar moduleName = selectElement.val();\n\t\t\t\t\t\t\tmoduleNameElement.val(moduleName).change().prop('disabled', true);\n\t\t\t\t\t\t} else if (selectedOption.data('reference') && moduleNameElement.find(`option[value=\"${workflowModuleName}\"]`).length){\n\t\t\t\t\t\t\tmoduleNameElement.val(workflowModuleName).change().prop('disabled', true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmoduleNameElement.prop('disabled', false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.loadFieldSpecificUi(selectedElement);\n\t\t\t\t} else {\n\t\t\t\t\tthis.addField(conditionRow);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetModuleName: function () {\n\t\t\treturn app.getModuleName();\n\t\t},\n\t\tgetFieldValueMapping: function () {\n\t\t\tvar fieldValueMap = this.fieldValueMap;\n\t\t\tif (fieldValueMap != false) {\n\t\t\t\treturn fieldValueMap;\n\t\t\t} else {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\t\tfieldValueReMapping: function () {\n\t\t\tvar object = JSON.parse($('#fieldValueMapping').val());\n\t\t\tvar fieldValueReMap = {};\n\n\t\t\t$.each(object, function (i, array) {\n\t\t\t\tfieldValueReMap[array.fieldname] = {};\n\t\t\t\tvar values = {};\n\t\t\t\t$.each(array, function (key, value) {\n\t\t\t\t\tvalues[key] = value;\n\t\t\t\t});\n\t\t\t\tfieldValueReMap[array.fieldname] = values;\n\t\t\t});\n\t\t\tthis.fieldValueMap = fieldValueReMap;\n\t\t},\n\t\t/**\n\t\t * Load field specific UI\n\t\t * @param {jQuery} fieldSelect\n\t\t * @returns this\n\t\t */\n\t\tloadFieldSpecificUi(fieldSelect) {\n\t\t\tconst selectedOption = fieldSelect.find('option:selected');\n\t\t\tconst row = fieldSelect.closest('div.js-conditions-row');\n\t\t\tconst fieldUiHolder = row.find('.fieldUiHolder');\n\t\t\tconst fieldInfo = selectedOption.data('fieldinfo');\n\t\t\tconst fieldValueMapping = this.getFieldValueMapping();\n\t\t\tlet selectField = '';\n\t\t\tif (fieldValueMapping && typeof fieldValueMapping[fieldInfo.name] !== 'undefined') {\n\t\t\t\tselectField = fieldValueMapping[fieldInfo.name];\n\t\t\t} else if (fieldValueMapping && typeof fieldValueMapping[fieldSelect.val()] !== 'undefined') {\n\t\t\t\tselectField = fieldValueMapping[fieldSelect.val()];\n\t\t\t}\n\t\t\tif (selectField) {\n\t\t\t\tfieldInfo.value = selectField['value'];\n\t\t\t\tfieldInfo.workflow_valuetype = selectField['valuetype'];\n\t\t\t} else {\n\t\t\t\tfieldInfo.workflow_valuetype = 'rawtext';\n\t\t\t}\n\t\t\tconst moduleName = this.getModuleName();\n\t\t\tconst fieldModel = Vtiger_Field_Js.getInstance(fieldInfo, moduleName);\n\t\t\tthis.fieldModelInstance = fieldModel;\n\t\t\tconst fieldSpecificUi = this.getFieldSpecificUi(fieldSelect);\n\t\t\t//remove validation since we dont need validations for all eleements\n\t\t\t// Both filter and find is used since we dont know whether the element is enclosed in some conainer like currency\n\t\t\tlet fieldName = fieldModel.getName();\n\t\t\tif (fieldModel.getType() == 'multipicklist') {\n\t\t\t\tfieldName = fieldName + '[]';\n\t\t\t}\n\t\t\tfieldSpecificUi.filter('[name=\"' + fieldName + '\"]').attr('data-value', 'value');\n\t\t\tfieldSpecificUi.find('[name=\"' + fieldName + '\"]').attr('data-value', 'value');\n\t\t\tfieldSpecificUi.filter('[name=\"valuetype\"]').removeAttr('data-validation-engine');\n\t\t\tfieldSpecificUi.find('[name=\"valuetype\"]').removeAttr('data-validation-engine');\n\t\t\t//If the workflowValueType is rawtext then only validation should happen\n\t\t\tconst workflowValueType = fieldSpecificUi.filter('[name=\"valuetype\"]').val();\n\t\t\tif (workflowValueType != 'rawtext' && typeof workflowValueType !== 'undefined') {\n\t\t\t\tfieldSpecificUi.filter('[name=\"' + fieldName + '\"]').removeAttr('data-validation-engine');\n\t\t\t\tfieldSpecificUi.find('[name=\"' + fieldName + '\"]').removeAttr('data-validation-engine');\n\t\t\t}\n\t\t\tfieldUiHolder.html(fieldSpecificUi);\n\t\t\tif (fieldSpecificUi.is('input.select2') || fieldSpecificUi.is('select')) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(fieldSpecificUi);\n\t\t\t} else if (fieldSpecificUi.is('input.dateField')) {\n\t\t\t\tApp.Fields.Date.register(fieldSpecificUi);\n\t\t\t} else if (fieldSpecificUi.is('input.dateRangeField')) {\n\t\t\t\tApp.Fields.Date.registerRange(fieldSpecificUi, { ranges: false });\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Functiont to get the field specific ui for the selected field\n\t\t * @prarms : fieldSelectElement - select element which will represents field list\n\t\t * @return : jquery object which represents the ui for the field\n\t\t */\n\t\tgetFieldSpecificUi: function (fieldSelectElement) {\n\t\t\tvar fieldModel = this.fieldModelInstance;\n\t\t\treturn $(fieldModel.getUiTypeSpecificHtml());\n\t\t},\n\t\tregisterVTCreateEventTaskEvents: function () {\n\t\t\tapp.registerEventForClockPicker();\n\t\t},\n\t\tregisterVTCreateEntityTaskEvents: function () {\n\t\t\tthis.registerChangeCreateEntityEvent();\n\t\t\tthis.registerVTUpdateFieldsTaskEvents();\n\t\t},\n\t\tregisterChangeCreateEntityEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\t$('[name=\"mappingPanel\"]').on('change', function (e) {\n\t\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\t\tapp.setMainParams('mappingPanel', currentTarget.val());\n\t\t\t\t$('#addCreateEntityContainer').html('');\n\t\t\t\tvar hideElementByClass = $('.' + currentTarget.data('hide'));\n\t\t\t\tvar showElementByClass = $('.' + currentTarget.data('show'));\n\t\t\t\tvar taskFields = app.getMainParams('taskFields', true);\n\t\t\t\thideElementByClass\n\t\t\t\t\t.addClass('d-none')\n\t\t\t\t\t.find('input,select')\n\t\t\t\t\t.each(function (e, n) {\n\t\t\t\t\t\tvar element = $(this);\n\t\t\t\t\t\tvar name = element.attr('name');\n\t\t\t\t\t\tif ($.inArray(name, taskFields) >= 0) {\n\t\t\t\t\t\t\tif (element.is('select')) {\n\t\t\t\t\t\t\t\telement.val('').trigger('change');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telement.prop('disabled', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tshowElementByClass\n\t\t\t\t\t.removeClass('d-none')\n\t\t\t\t\t.find('input,select')\n\t\t\t\t\t.each(function (e, n) {\n\t\t\t\t\t\tvar element = $(this);\n\t\t\t\t\t\tvar name = element.attr('name');\n\t\t\t\t\t\tif ($.inArray(name, taskFields) >= 0) {\n\t\t\t\t\t\t\telement.prop('disabled', false);\n\t\t\t\t\t\t\tif (element.is('select')) {\n\t\t\t\t\t\t\t\telement.val('').trigger('change');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t\t$('.createEntityModule').on('change', function (e) {\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tview: 'CreateEntity',\n\t\t\t\t\tfor_workflow: $('[name=\"for_workflow\"]').val(),\n\t\t\t\t\tmappingPanel: app.getMainParams('mappingPanel')\n\t\t\t\t};\n\t\t\t\tvar relatedModule = $(e.currentTarget).val();\n\t\t\t\tif (relatedModule) {\n\t\t\t\t\tparams['relatedModule'] = relatedModule;\n\t\t\t\t}\n\t\t\t\tvar progressIndicatorElement = $.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tvar createEntityContainer = $('#addCreateEntityContainer');\n\t\t\t\t\tcreateEntityContainer.html(data);\n\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(createEntityContainer);\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(createEntityContainer.find('.select2'));\n\t\t\t\t\tthisInstance.registerAddFieldEvent();\n\t\t\t\t\tthisInstance.fieldValueMap = false;\n\t\t\t\t\tif ($('#fieldValueMapping').val() != '') {\n\t\t\t\t\t\tthis.fieldValueReMapping();\n\t\t\t\t\t}\n\t\t\t\t\tvar fields = $('#save_fieldvaluemapping').find('select[name=\"fieldname\"]');\n\t\t\t\t\t$.each(fields, function (i, field) {\n\t\t\t\t\t\tthisInstance.loadFieldSpecificUi($(field));\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will change the UI styles based on recurring type\n\t\t * @params - recurringType - which recurringtype is selected\n\t\t */\n\t\tchangeRecurringTypesUIStyles: function (recurringType) {\n\t\t\tif (recurringType == 'Daily' || recurringType == 'Yearly') {\n\t\t\t\t$('#repeatWeekUI').removeClass('show').addClass('d-none');\n\t\t\t\t$('#repeatMonthUI').removeClass('show').addClass('d-none');\n\t\t\t} else if (recurringType == 'Weekly') {\n\t\t\t\t$('#repeatWeekUI').removeClass('d-none').addClass('show');\n\t\t\t\t$('#repeatMonthUI').removeClass('show').addClass('d-none');\n\t\t\t} else if (recurringType == 'Monthly') {\n\t\t\t\t$('#repeatWeekUI').removeClass('show').addClass('d-none');\n\t\t\t\t$('#repeatMonthUI').removeClass('d-none').addClass('show');\n\t\t\t}\n\t\t},\n\t\tcheckHiddenStatusofCcandBcc: function () {\n\t\t\tvar ccLink = $('#ccLink');\n\t\t\tvar bccLink = $('#bccLink');\n\t\t\tif (ccLink.hasClass('d-none') && bccLink.hasClass('d-none')) {\n\t\t\t\tccLink.closest('div.row').addClass('d-none');\n\t\t\t}\n\t\t},\n\t\t/*\n\t\t * Function to register the events for bcc and cc links\n\t\t */\n\t\tregisterCcAndBccEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\t$('#ccLink').on('click', function (e) {\n\t\t\t\tvar ccContainer = $('#ccContainer');\n\t\t\t\tccContainer.removeClass('d-none');\n\t\t\t\tvar taskFieldElement = ccContainer.find('select.task-fields');\n\t\t\t\ttaskFieldElement.addClass('select2');\n\t\t\t\tApp.Fields.Picklist.changeSelectElementView(taskFieldElement);\n\t\t\t\t$(e.currentTarget).addClass('d-none');\n\t\t\t\tthisInstance.checkHiddenStatusofCcandBcc();\n\t\t\t});\n\t\t\t$('#bccLink').on('click', function (e) {\n\t\t\t\tvar bccContainer = $('#bccContainer');\n\t\t\t\tbccContainer.removeClass('d-none');\n\t\t\t\tvar taskFieldElement = bccContainer.find('select.task-fields');\n\t\t\t\ttaskFieldElement.addClass('select2');\n\t\t\t\tApp.Fields.Picklist.changeSelectElementView(taskFieldElement);\n\t\t\t\t$(e.currentTarget).addClass('d-none');\n\t\t\t\tthisInstance.checkHiddenStatusofCcandBcc();\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tvar container = this.getContainer();\n\t\t\tApp.Fields.Picklist.changeSelectElementView(container);\n\t\t\tthis.registerEditTaskEvent();\n\t\t\tthis.registerTaskStatusChangeEvent();\n\t\t\tthis.registerTaskDeleteEvent();\n\t\t}\n\t}\n);\n\n//http://stackoverflow.com/questions/946534/insert-text-into-textarea-with-jquery\n$.fn.extend({\n\tinsertAtCaret: function (myValue) {\n\t\treturn this.each(function (i) {\n\t\t\tif (document.selection) {\n\t\t\t\t//For browsers like Internet Explorer\n\t\t\t\tthis.focus();\n\t\t\t\tvar sel = document.selection.createRange();\n\t\t\t\tsel.text = myValue;\n\t\t\t\tthis.focus();\n\t\t\t} else if (this.selectionStart || this.selectionStart == '0') {\n\t\t\t\t//For browsers like Firefox and Webkit based\n\t\t\t\tvar startPos = this.selectionStart;\n\t\t\t\tvar endPos = this.selectionEnd;\n\t\t\t\tvar scrollTop = this.scrollTop;\n\t\t\t\tthis.value = this.value.substring(0, startPos) + myValue + this.value.substring(endPos, this.value.length);\n\t\t\t\tthis.focus();\n\t\t\t\tthis.selectionStart = startPos + myValue.length;\n\t\t\t\tthis.selectionEnd = startPos + myValue.length;\n\t\t\t\tthis.scrollTop = scrollTop;\n\t\t\t} else {\n\t\t\t\tthis.value += myValue;\n\t\t\t\tthis.focus();\n\t\t\t}\n\t\t});\n\t}\n});\n"],"names":["Settings_Workflows_Edit_Js","step3Container","advanceFilterInstance","conditionBuilderInstance","ckEditorInstance","fieldValueMap","init","initialize","getContainer","setContainer","element","container","$","is","registerEditTaskEvent","thisInstance","on","e","currentElement","currentTarget","params","data","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","app","showModalWindow","mode","clipboard","App","Fields","Text","registerCopyClipboard","one","destroy","registerVTCreateTodoTaskEvents","taskType","val","functionName","apply","registerSaveTaskSubmitEvent","validationEngine","validationEngineOptions","registerFillTaskFieldsEvent","registerCheckSelectDateEvent","Tools","VariablesPanel","registerRefreshCompanyVariables","Vtiger_ConditionBuilder_Js","find","registerEvents","removeClass","addClass","form","customValidationFunctionName","result","showNotify","title","vtranslate","text","type","preventDefault","preSaveActionFunctionName","formData","serializeFormData","entity_type","AppConnector","request","done","getTaskList","hideModalWindow","VTUpdateFieldsTaskCustomValidation","checkDuplicateFieldsSelected","VTCreateEntityTaskCustomValidation","selectedFieldNames","failureMessage","each","i","ele","fieldName","attr","fields","not","length","preSaveVTUpdateFieldsTask","tasktype","values","getValues","JSON","stringify","preSaveVTCreateEntityTask","preSaveVTEmailTask","textAreaElement","CKEDITOR","instances","getData","preSaveVTUpdateRelatedFieldTask","preSaveSumFieldFromDependent","getConditions","isEmptyFieldSelected","fieldSelect","selectedOption","getVTCreateEntityTaskFieldList","Array","getVTUpdateFieldsTaskFieldList","getVTUpdateRelatedFieldTaskFieldList","fieldListFunctionName","fieldList","conditionDomElement","rowElement","fieldSelectElement","valueSelectElement","key","field","fieldDataInfo","fieldType","rowValues","pickListValues","valuesArr","split","newValuesArr","j","push","join","value","module","getModuleName","parent","getParentModuleName","view","record","html","registerTaskStatusChangeEvent","currentStatusElement","url","stopImmediatePropagation","registerTaskDeleteEvent","message","Vtiger_Helper_Js","showConfirmationBox","deleteUrl","registerFillTaskFromEmailFieldEvent","inputElement","closest","oldValue","newValue","registerVTEmailTaskEvents","Editor","registerCcAndBccEvents","registerEventForClockPicker","registerVTUpdateFieldsTaskEvents","registerAddFieldEvent","registerDeleteConditionEvent","registerFieldChange","fieldValueReMapping","loadFieldSpecificUi","getPopUp","registerVTUpdateRelatedFieldTaskEvents","addField","replaceElement","newAddFieldContainer","clone","append","replaceWith","Picklist","changeSelectElementView","remove","selectedElement","conditionRow","moduleNameElement","workflowModuleName","selectedOptionFieldInfo","selectElement","moduleName","change","prop","getFieldValueMapping","object","parse","fieldValueReMap","array","fieldname","row","fieldUiHolder","fieldInfo","fieldValueMapping","selectField","name","workflow_valuetype","fieldModel","Vtiger_Field_Js","getInstance","fieldModelInstance","fieldSpecificUi","getFieldSpecificUi","getName","getType","filter","removeAttr","workflowValueType","showSelect2ElementView","Date","register","registerRange","ranges","getUiTypeSpecificHtml","registerVTCreateEventTaskEvents","registerVTCreateEntityTaskEvents","registerChangeCreateEntityEvent","setMainParams","hideElementByClass","showElementByClass","taskFields","getMainParams","inArray","trigger","for_workflow","mappingPanel","relatedModule","createEntityContainer","changeRecurringTypesUIStyles","recurringType","checkHiddenStatusofCcandBcc","ccLink","bccLink","hasClass","ccContainer","taskFieldElement","bccContainer","fn","extend","insertAtCaret","myValue","document","selection","focus","sel","createRange","selectionStart","startPos","endPos","selectionEnd","scrollTop","substring"],"mappings":"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"}