{"version":3,"file":"SortOrderModal.min.js","sources":["SortOrderModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_SortOrderModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Modal container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Source container\n\t\t */\n\t\tsourceContainer: false,\n\t\t/**\n\t\t * Modal ID\n\t\t */\n\t\tsource: false,\n\t\t/**\n\t\t * Load data\n\t\t */\n\t\tloadData: function () {\n\t\t\tlet orderBy = this.sourceContainer.find('#orderBy').val();\n\t\t\torderBy = orderBy ? JSON.parse(orderBy) : [];\n\t\t\tif (orderBy && Object.keys(orderBy).length) {\n\t\t\t\tlet baseOrderBy = this.container.find('.js-base-element');\n\t\t\t\tfor (let field in orderBy) {\n\t\t\t\t\tif (!baseOrderBy.find(\"option[value='\" + field + \"']\").length) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet element = this.addRow();\n\t\t\t\t\telement.find('select.js-orderBy').val(field).change();\n\t\t\t\t\tlet sortIcon = element.find('.js-sort-icon-active');\n\t\t\t\t\tif (orderBy[field] && sortIcon.data('val') != orderBy[field]) {\n\t\t\t\t\t\tsortIcon.trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Add new row\n\t\t */\n\t\taddRow: function () {\n\t\t\tlet sortContainer = this.container.find('.js-base-element').clone(true, true).removeClass('js-base-element');\n\t\t\tthis.container.find('.js-sort-container').append(sortContainer);\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(sortContainer.find('select'));\n\t\t\treturn sortContainer.removeClass('d-none');\n\t\t},\n\t\t/**\n\t\t * Register list events\n\t\t */\n\t\tregisterListEvents: function () {\n\t\t\tthis.container.find('.js-add').on('click', (e) => {\n\t\t\t\tthis.addRow();\n\t\t\t});\n\t\t\tthis.container.find('.js-clear').on('click', (e) => {\n\t\t\t\t$(e.currentTarget).closest('.js-sort-container_element').remove();\n\t\t\t});\n\t\t\tthis.container.find('.js-sort-order-button').on('click', (e) => {\n\t\t\t\tlet element = $(e.currentTarget).closest('.js-sort-container_element');\n\t\t\t\telement.find('.js-sort-icon').toggleClass('d-none js-sort-icon-active');\n\t\t\t\telement.find('.js-sort-order').val(element.find('.js-sort-icon-active').data('val'));\n\t\t\t});\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.sourceContainer.find('.js-list-reload').trigger('click', { orderby: this.getSortData() });\n\t\t\t\tapp.hideModalWindow(null, this.source);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Gets sort data\n\t\t */\n\t\tgetSortData: function () {\n\t\t\tlet sortData = {};\n\t\t\tthis.container.find('.js-sort-container_element:not(.js-base-element)').each(function () {\n\t\t\t\tlet orderBy = $(this).find('.js-orderBy').val();\n\t\t\t\tif (orderBy) {\n\t\t\t\t\tsortData[orderBy] = $(this).find('.js-sort-order').val();\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn sortData;\n\t\t},\n\t\t/**\n\t\t * Gets basic container\n\t\t */\n\t\tgetSourceContainer: function () {\n\t\t\treturn $('[data-modalid=' + this.source + ']').closest(\n\t\t\t\t'.listViewContentDiv,.relatedContainer,.js-main-container'\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * Register modal events\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.container = modalContainer;\n\t\t\tthis.source = modalContainer.closest('.js-modal-container').attr('id');\n\t\t\tthis.sourceContainer = this.getSourceContainer();\n\t\t\tthis.registerListEvents();\n\t\t\tthis.loadData();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","sourceContainer","source","loadData","orderBy","find","val","JSON","parse","Object","keys","length","baseOrderBy","field","element","addRow","change","sortIcon","data","trigger","sortContainer","clone","removeClass","append","App","Fields","Picklist","showSelect2ElementView","registerListEvents","on","e","currentTarget","closest","remove","toggleClass","preventDefault","orderby","getSortData","app","hideModalWindow","sortData","each","getSourceContainer","registerEvents","modalContainer","attr"],"mappings":";;AAAA,kKACA,aAEAA,CAAC,CAACC,KAAF,CACC,wBADD,CAEC,EAFD,CAGC;AAED;AACA,KACEC,SAAS,GAJV;AAMD;AACA,KACEC,eAAe,GARhB;AAUD;AACA,KACEC,MAAM,GAZP;AAcD;AACA,KACEC,QAAQ,CAAE,mBAAY,CACrB,IAAIC,OAAO,CAAG,KAAKH,eAAL,CAAqBI,IAArB,CAA0B,UAA1B,EAAsCC,GAAtC,EAAd,CAEA,GADAF,OAAO,CAAGA,OAAO,CAAGG,IAAI,CAACC,KAAL,CAAWJ,OAAX,CAAH,CAAyB,EAC1C,CAAIA,OAAO,EAAIK,MAAM,CAACC,IAAP,CAAYN,OAAZ,EAAqBO,MAApC,CAA4C,CAC3C,IAAIC,WAAW,CAAG,KAAKZ,SAAL,CAAeK,IAAf,CAAoB,kBAApB,CAAlB,CACA,IAAK,IAAIQ,KAAT,IAAkBT,OAAlB,CACC,GAAKQ,WAAW,CAACP,IAAZ,CAAiB,iBAAmBQ,KAAnB,CAA2B,IAA5C,EAAkDF,MAAvD,EAGA,IAAIG,OAAO,CAAG,KAAKC,MAAL,EAAd,CACAD,OAAO,CAACT,IAAR,CAAa,mBAAb,EAAkCC,GAAlC,CAAsCO,KAAtC,EAA6CG,MAA7C,EAJA,CAKA,IAAIC,QAAQ,CAAGH,OAAO,CAACT,IAAR,CAAa,sBAAb,CAAf,CACID,OAAO,CAACS,KAAD,CAAP,EAAkBI,QAAQ,CAACC,IAAT,CAAc,KAAd,GAAwBd,OAAO,CAACS,KAAD,CANrD,EAOCI,QAAQ,CAACE,OAAT,CAAiB,OAAjB,EAPD,CAUD,CAbD,UAcMJ,MAAL,GAED,CAnCF;AAqCD;AACA,KACEA,MAAM,CAAE,iBAAY,CACnB,IAAIK,aAAa,CAAG,KAAKpB,SAAL,CAAeK,IAAf,CAAoB,kBAApB,EAAwCgB,KAAxC,QAA0DC,WAA1D,CAAsE,iBAAtE,CAApB,CAGA,YAFKtB,SAAL,CAAeK,IAAf,CAAoB,oBAApB,EAA0CkB,MAA1C,CAAiDH,aAAjD,CAEA,CADAI,GAAG,CAACC,MAAJ,CAAWC,QAAX,CAAoBC,sBAApB,CAA2CP,aAAa,CAACf,IAAd,CAAmB,QAAnB,CAA3C,CACA,CAAOe,aAAa,CAACE,WAAd,CAA0B,QAA1B,CACP,CA5CF;AA8CD;AACA,KACEM,kBAAkB,CAAE,6BAAY,gBAC/B,KAAK5B,SAAL,CAAeK,IAAf,CAAoB,SAApB,EAA+BwB,EAA/B,CAAkC,OAAlC,CAA2C,UAAO,CACjD,KAAI,CAACd,MAAL,GACA,CAFD,CAD+B,CAI/B,KAAKf,SAAL,CAAeK,IAAf,CAAoB,WAApB,EAAiCwB,EAAjC,CAAoC,OAApC,CAA6C,SAACC,CAAD,CAAO,CACnDhC,CAAC,CAACgC,CAAC,CAACC,aAAH,CAAD,CAAmBC,OAAnB,CAA2B,4BAA3B,EAAyDC,MAAzD,GACA,CAFD,CAJ+B,CAO/B,KAAKjC,SAAL,CAAeK,IAAf,CAAoB,uBAApB,EAA6CwB,EAA7C,CAAgD,OAAhD,CAAyD,SAACC,CAAD,CAAO,CAC/D,IAAIhB,OAAO,CAAGhB,CAAC,CAACgC,CAAC,CAACC,aAAH,CAAD,CAAmBC,OAAnB,CAA2B,4BAA3B,CAAd,CACAlB,OAAO,CAACT,IAAR,CAAa,eAAb,EAA8B6B,WAA9B,CAA0C,4BAA1C,CAF+D,CAG/DpB,OAAO,CAACT,IAAR,CAAa,gBAAb,EAA+BC,GAA/B,CAAmCQ,OAAO,CAACT,IAAR,CAAa,sBAAb,EAAqCa,IAArC,CAA0C,KAA1C,CAAnC,EACA,CAJD,CAP+B,CAY/B,KAAKlB,SAAL,CAAeK,IAAf,CAAoB,iBAApB,EAAuCwB,EAAvC,CAA0C,OAA1C,CAAmD,SAACC,CAAD,CAAO,CACzDA,CAAC,CAACK,cAAF,EADyD,CAEzD,KAAI,CAAClC,eAAL,CAAqBI,IAArB,CAA0B,iBAA1B,EAA6Cc,OAA7C,CAAqD,OAArD,CAA8D,CAAEiB,OAAO,CAAE,KAAI,CAACC,WAAL,EAAX,CAA9D,CAFyD,CAGzDC,GAAG,CAACC,eAAJ,CAAoB,IAApB,CAA0B,KAAI,CAACrC,MAA/B,EACA,CAJD,EAKA,CAjEF;AAmED;AACA,KACEmC,WAAW,CAAE,sBAAY,CACxB,IAAIG,QAAQ,CAAG,EAAf,CAOA,YANKxC,SAAL,CAAeK,IAAf,CAAoB,kDAApB,EAAwEoC,IAAxE,CAA6E,UAAY,CACxF,IAAIrC,OAAO,CAAGN,CAAC,CAAC,IAAD,CAAD,CAAQO,IAAR,CAAa,aAAb,EAA4BC,GAA5B,EAAd,CACIF,OAFoF,GAGvFoC,QAAQ,CAACpC,OAAD,CAAR,CAAoBN,CAAC,CAAC,IAAD,CAAD,CAAQO,IAAR,CAAa,gBAAb,EAA+BC,GAA/B,EAHmE,EAKxF,CALD,CAMA,CAAOkC,QACP,CA9EF;AAgFD;AACA,KACEE,kBAAkB,CAAE,6BAAY,CAC/B,OAAO5C,CAAC,CAAC,iBAAmB,KAAKI,MAAxB,CAAiC,GAAlC,CAAD,CAAwC8B,OAAxC,CACN,0DADM,CAGP,CAtFF;AAwFD;AACA;AACA,KACEW,cAAc,CAAE,wBAAUC,cAAV,CAA0B,CACzC,KAAK5C,SAAL,CAAiB4C,cADwB,CAEzC,KAAK1C,MAAL,CAAc0C,cAAc,CAACZ,OAAf,CAAuB,qBAAvB,EAA8Ca,IAA9C,CAAmD,IAAnD,CAF2B,CAGzC,KAAK5C,eAAL,CAAuB,KAAKyC,kBAAL,EAHkB,CAIzC,KAAKd,kBAAL,EAJyC,CAKzC,KAAKzB,QAAL,GACA,CAjGF,CAHD;;"}