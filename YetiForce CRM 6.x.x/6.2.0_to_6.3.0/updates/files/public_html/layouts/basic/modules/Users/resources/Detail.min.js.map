{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\n\t'Users_Detail_Js',\n\t{\n\t\t/*\n\t\t * function to trigger delete record action\n\t\t * @params: delete record url.\n\t\t */\n\t\ttriggerDeleteUser: function (deleteUserUrl) {\n\t\t\tvar message = app.vtranslate('JS_DELETE_USER_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ message: message })\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tAppConnector.request(deleteUserUrl).done(function (data) {\n\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\tvar callback = function (data) {\n\t\t\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\t\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\t\t\tUsers_Detail_Js.deleteUser(form);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t$('#deleteUser').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t});\n\t\t},\n\t\tdeleteUser: function (form) {\n\t\t\tvar userid = form.find('[name=\"userid\"]').val();\n\t\t\tvar transferUserId = form.find('[name=\"tranfer_owner_id\"]').val();\n\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'DeleteAjax',\n\t\t\t\tmode: 'deleteUser',\n\t\t\t\ttransfer_user_id: transferUserId,\n\t\t\t\tuserid: userid,\n\t\t\t\tpermanent: form.find('[name=\"deleteUserPermanent\"]:checked').val()\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate(data.result.message),\n\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t});\n\t\t\t\t\tvar url = data.result.listViewUrl;\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttriggerChangeAccessKey: function (url) {\n\t\t\tvar title = app.vtranslate('JS_NEW_ACCESS_KEY_REQUESTED');\n\t\t\tvar message = app.vtranslate('JS_CHANGE_ACCESS_KEY_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ title: title, message: message }).done(function (data) {\n\t\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tdata = data.result;\n\t\t\t\t\t\tparams['type'] = 'success';\n\t\t\t\t\t\tmessage = app.vtranslate(data.message);\n\t\t\t\t\t\tvar accessKeyEle = $('#Users_detailView_fieldValue_accesskey');\n\t\t\t\t\t\tif (accessKeyEle.length) {\n\t\t\t\t\t\t\taccessKeyEle.find('.value').html(data.accessKey);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmessage = app.vtranslate(data['error']['message']);\n\t\t\t\t\t}\n\t\t\t\t\tparams['text'] = message;\n\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\tusersEditInstance: false,\n\t\tupdateStartHourElement: function (form) {\n\t\t\tthis.usersEditInstance.triggerHourFormatChangeEvent(form);\n\t\t\tthis.updateStartHourElementValue();\n\t\t},\n\t\thourFormatUpdateEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.getForm().on(this.fieldUpdatedEvent, '[name=\"hour_format\"]', function (e, params) {\n\t\t\t\tthisInstance.updateStartHourElementValue();\n\t\t\t});\n\t\t},\n\t\tupdateStartHourElementValue: function () {\n\t\t\tvar form = this.getForm();\n\t\t\tvar startHourSelectElement = $('select[name=\"start_hour\"]', form);\n\t\t\tvar selectedElementValue = startHourSelectElement.find('option:selected').text();\n\t\t\tstartHourSelectElement.closest('.fieldValue').find('span.value').text(selectedElementValue);\n\t\t\tvar endHourSelectElement = $('select[name=\"end_hour\"]', form);\n\t\t\tendHourSelectElement\n\t\t\t\t.closest('.fieldValue')\n\t\t\t\t.find('span.value')\n\t\t\t\t.text(endHourSelectElement.find('option:selected').text());\n\t\t},\n\t\tstartHourUpdateEvent: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tform.on(this.fieldUpdatedEvent, '[name=\"start_hour\"]', function (e, params) {\n\t\t\t\tthisInstance.updateStartHourElement(form);\n\t\t\t});\n\t\t},\n\t\tsaveFieldValues: function (fieldDetailList) {\n\t\t\tvar aDeferred = $.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tvar lock = false;\n\t\t\tvar recordId = this.getRecordId();\n\t\t\tvar data = {};\n\t\t\tif (typeof fieldDetailList !== 'undefined') {\n\t\t\t\tdata = fieldDetailList;\n\t\t\t\tif (data['field'] == 'email1') {\n\t\t\t\t\tthisInstance.usersEditInstance.checkEmail(data['value']).done(\n\t\t\t\t\t\tfunction (data) {},\n\t\t\t\t\t\tfunction (data, error) {\n\t\t\t\t\t\t\tlock = true;\n\t\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (lock !== true) {\n\t\t\t\tdata['record'] = recordId;\n\t\t\t\tdata['module'] = app.getModuleName();\n\t\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\t\tvar params = {};\n\t\t\t\tparams.data = data;\n\t\t\t\tparams.async = false;\n\t\t\t\tparams.dataType = 'json';\n\t\t\t\tAppConnector.request(params).done(function (reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tvar form = this.getForm();\n\t\t\tthis.usersEditInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.updateStartHourElement(form);\n\t\t\tthis.hourFormatUpdateEvent();\n\t\t\tthis.startHourUpdateEvent(form);\n\t\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","triggerDeleteUser","deleteUserUrl","message","app","vtranslate","Vtiger_Helper_Js","showConfirmationBox","done","AppConnector","request","data","callback","params","validationEngineOptions","onValidationComplete","form","valid","Users_Detail_Js","deleteUser","$","validationEngine","showModalWindow","fail","error","console","userid","find","val","transferUserId","module","getModuleName","action","mode","transfer_user_id","permanent","success","hideModalWindow","showNotify","text","result","type","url","listViewUrl","window","location","href","triggerChangeAccessKey","title","accessKeyEle","length","html","accessKey","usersEditInstance","updateStartHourElement","triggerHourFormatChangeEvent","updateStartHourElementValue","hourFormatUpdateEvent","thisInstance","getForm","on","fieldUpdatedEvent","startHourSelectElement","selectedElementValue","closest","endHourSelectElement","startHourUpdateEvent","saveFieldValues","fieldDetailList","aDeferred","Deferred","lock","recordId","getRecordId","checkEmail","reject","async","dataType","reponseData","resolve","promise","registerEvents","_super","Vtiger_Edit_Js","getInstance","Users_Edit_Js","registerChangeEventForCurrencySeparator"],"mappings":"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"}