{"version":3,"file":"Iframe.min.js","sources":["Iframe.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nwindow.MailIntegration_Iframe = {\n\tmailId: 0,\n\tcontainer: {},\n\tiframe: {},\n\tiframeWindow: {},\n\tmoduleSelect: {},\n\taddRecordBtn: {},\n\tloaderParams: {\n\t\tblockInfo: { enabled: true },\n\t\tmessage: false\n\t},\n\t/**\n\t * AppConnector wrapper\n\t *\n\t * @param   {object}  request\n\t *\n\t * @return  {object}           AppConnector object with done method\n\t */\n\tconnector(request) {\n\t\treturn AppConnector.request(request).fail((error) => {\n\t\t\tthis.hideIframeLoader();\n\t\t\tthis.showResponseMessage(false);\n\t\t});\n\t},\n\t/**\n\t * Show response message\n\t *\n\t * @param   {boolean}  success\n\t * @param   {string}  message\n\t */\n\tshowResponseMessage(success, message = '') {\n\t\tif (success) {\n\t\t\tthis.mailItem.notificationMessages.replaceAsync('information', {\n\t\t\t\ttype: 'informationalMessage',\n\t\t\t\tmessage: message,\n\t\t\t\ticon: 'iconid',\n\t\t\t\tpersistent: false\n\t\t\t});\n\t\t} else {\n\t\t\tthis.mailItem.notificationMessages.replaceAsync('error', {\n\t\t\t\ttype: 'errorMessage',\n\t\t\t\tmessage: app.vtranslate('JS_ERROR') + ' ' + message\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Register list item events\n\t */\n\tregisterListItemEvents() {\n\t\tthis.container.on('click', '.js-list-item-click', this.onClickListItem.bind(this));\n\t\t$(document).on('click', '.popover a', this.onClickLink.bind(this));\n\t\tthis.container.on('click', '.js-add-related-record', this.onClickQuickCreateBtn.bind(this));\n\t\tthis.container.on('click', '.js-remove-record', this.onClickDeleteRelation.bind(this));\n\t},\n\t/**\n\t * On ListItem click actions\n\t *\n\t * @param   {[type]}  event  [event description]\n\t *\n\t * @return  {[type]}         [return description]\n\t */\n\tonClickListItem(event) {\n\t\tlet currentTarget = $(event.currentTarget);\n\t\tthis.toggleActiveListItems(currentTarget);\n\t\tthis.onClickLink(event, currentTarget.find('.js-record-link').attr('href'));\n\t},\n\t/**\n\t * On link click\n\t *\n\t * @param   {object}  event  click event object\n\t * @param   {string}  url\n\t */\n\tonClickLink(event, url) {\n\t\tevent.preventDefault();\n\t\tif (!url) {\n\t\t\turl = $(event.currentTarget).attr('href');\n\t\t}\n\t\tthis.changeIframeSource(url);\n\t},\n\t/**\n\t * On delete relation click\n\t *\n\t * @param   {object}  event  click event\n\t */\n\tonClickDeleteRelation(event) {\n\t\tevent.stopPropagation();\n\t\tconst currentTarget = $(event.currentTarget);\n\t\tconst recordData = currentTarget.closest('.js-list-item-click').data();\n\t\tthis.connector({\n\t\t\tmodule: 'MailIntegration',\n\t\t\taction: 'Mail',\n\t\t\tmode: 'deleteRelation',\n\t\t\tmailId: this.mailId,\n\t\t\trecord: recordData.id,\n\t\t\trecordModule: recordData.module\n\t\t}).done((response) => {\n\t\t\tthis.showResponseMessage(response['success'], app.vtranslate('JS_REMOVED_RELATION_SUCCESSFULLY'));\n\t\t\tthis.reloadView(response['success']);\n\t\t});\n\t},\n\t/**\n\t * On quick create btn click\n\t *\n\t * @param   {object}  event  click event\n\t */\n\tonClickQuickCreateBtn(event) {\n\t\tevent.stopPropagation();\n\t\tconst currentTarget = $(event.currentTarget);\n\t\tconst recordData = currentTarget.closest('.js-list-item-click').data();\n\t\tconst callbackFunction = () => {\n\t\t\tthis.iframeWindow.location.reload();\n\t\t};\n\t\tlet newRecordData = {\n\t\t\tsourceModule: recordData.module,\n\t\t\tsourceRecord: recordData.id\n\t\t};\n\t\tthis.showQuickCreateForm(event.currentTarget.dataset.module, {\n\t\t\tdata: newRecordData,\n\t\t\tcallbackFunction\n\t\t});\n\t},\n\t/**\n\t * Fill new record data in quick create form\n\t *\n\t * @param   {string}  moduleName  [moduleName description]\n\t *\n\t * @return  {object}              call asyncGetMailBody which returns Promise\n\t */\n\tfillNewRecordData(moduleName) {\n\t\tconst data = {\n\t\t\temail: this.mailItem.from.emailAddress,\n\t\t\temail1: this.mailItem.from.emailAddress,\n\t\t\trelationOperation: true,\n\t\t\trelatedRecords: $.map(this.container.find('.js-list-item-click'), (record) => {\n\t\t\t\treturn { module: record.dataset.module, id: record.dataset.id };\n\t\t\t})\n\t\t};\n\t\tconst fillNameFields = (first) => {\n\t\t\tconst nameData = this.mailItem.from.displayName.split(' ');\n\t\t\tconst firstName = nameData.shift();\n\t\t\tconst lastName = nameData.join(' ');\n\t\t\treturn first ? firstName : lastName;\n\t\t};\n\t\tlet autoCompleteMap = JSON.parse(this.container.find('.js-mailAutoCompleteFields').val());\n\t\tif (autoCompleteMap && autoCompleteMap[moduleName]) {\n\t\t\tlet map = autoCompleteMap[moduleName];\n\t\t\tfor (let name in map) {\n\t\t\t\tif (map.hasOwnProperty(name) && map[name]) {\n\t\t\t\t\tswitch (map[name]) {\n\t\t\t\t\t\tcase 'fromNameFirstPart':\n\t\t\t\t\t\t\tdata[name] = fillNameFields(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'fromNameSecondPart':\n\t\t\t\t\t\t\tdata[name] = fillNameFields(false);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'fromName':\n\t\t\t\t\t\t\tdata[name] = this.mailItem.from.displayName;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'subject':\n\t\t\t\t\t\t\tdata[name] = this.mailItem.subject;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'email':\n\t\t\t\t\t\t\tdata[name] = this.mailItem.from.emailAddress;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.mailDetails = {};\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.asyncGetMailBody().then(() => {\n\t\t\t\tdata.description = this.mailDetails.mailBody;\n\t\t\t\tresolve(data);\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Toggle active list items\n\t *\n\t * @param   {object}  targetListItem  jQuery\n\t */\n\ttoggleActiveListItems(targetListItem) {\n\t\ttargetListItem.siblings().removeClass('active');\n\t\ttargetListItem.addClass('active');\n\t},\n\t/**\n\t * Change iframe source\n\t *\n\t * @param   {string}  url\n\t */\n\tchangeIframeSource(url) {\n\t\tthis.iframe.attr('src', url);\n\t\tthis.showIframeLoader();\n\t},\n\t/**\n\t * Add relation\n\t *\n\t * @param   {number}  recordId\n\t * @param   {string}  moduleName\n\t */\n\taddRelation(recordId, moduleName) {\n\t\tthis.connector({\n\t\t\tmodule: 'MailIntegration',\n\t\t\taction: 'Mail',\n\t\t\tmode: 'addRelation',\n\t\t\tmailId: this.mailId,\n\t\t\trecord: recordId,\n\t\t\trecordModule: moduleName\n\t\t}).done((response) => {\n\t\t\tthis.showResponseMessage(response['success'], app.vtranslate('JS_ADDED_RELATION_SUCCESSFULLY'));\n\t\t\tthis.reloadView(response['success']);\n\t\t});\n\t},\n\t/**\n\t * Show quick create form\n\t *\n\t * @param   {string}  moduleName\n\t * @param   {object}  quickCreateParams\n\t */\n\tshowQuickCreateForm(moduleName, quickCreateParams = {}) {\n\t\tquickCreateParams = Object.assign({ noCache: true, data: {} }, quickCreateParams);\n\t\tthis.fillNewRecordData(moduleName).then((data) => {\n\t\t\tquickCreateParams.data = Object.assign(data, quickCreateParams.data);\n\t\t\tApp.Components.QuickCreate.createRecord(moduleName, quickCreateParams);\n\t\t});\n\t},\n\t/**\n\t * Register iframe events\n\t */\n\tregisterIframeEvents() {\n\t\tconst link = this.container.find('.js-list-item-click').first();\n\t\tthis.initIframeLoader();\n\t\tif (link.length) {\n\t\t\tlink.addClass('active');\n\t\t\tthis.iframe.attr('src', link.find('.js-record-link').attr('href'));\n\t\t\tthis.iframe.on('load', () => {\n\t\t\t\tthis.hideIframeLoader();\n\t\t\t});\n\t\t} else {\n\t\t\tthis.hideIframeLoader();\n\t\t}\n\t},\n\t/**\n\t * Register import click\n\t */\n\tregisterImportClick() {\n\t\tthis.container.on('click', '.js-import-mail', (e) => {\n\t\t\tthis.showIframeLoader();\n\t\t\tthis.getMailDetails().then(() => {\n\t\t\t\tthis.connector(\n\t\t\t\t\tObject.assign(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmodule: 'MailIntegration',\n\t\t\t\t\t\t\taction: 'Import'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis.mailDetails,\n\t\t\t\t\t\twindow.PanelParams\n\t\t\t\t\t)\n\t\t\t\t).done((response) => {\n\t\t\t\t\tthis.hideIframeLoader();\n\t\t\t\t\tthis.showResponseMessage(response['success'], app.vtranslate('JS_IMPORT'));\n\t\t\t\t\tthis.reloadView(response['success']);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Get mail details\n\t *\n\t * @return  {object}  Promise\n\t */\n\tgetMailDetails() {\n\t\tlet mailItem = this.mailItem;\n\t\tif (mailItem.attachments.length > 0) {\n\t\t\tlet outputString = '';\n\t\t\tfor (let i = 0; i < mailItem.attachments.length; i++) {\n\t\t\t\tlet attachment = mailItem.attachments[i];\n\t\t\t\toutputString += '<BR>' + i + '. Name: ';\n\t\t\t\toutputString += attachment.name;\n\t\t\t\toutputString += '<BR>ID: ' + attachment.id;\n\t\t\t\toutputString += '<BR>contentType: ' + attachment.contentType;\n\t\t\t\toutputString += '<BR>size: ' + attachment.size;\n\t\t\t\toutputString += '<BR>attachmentType: ' + attachment.attachmentType;\n\t\t\t\toutputString += '<BR>isInline: ' + attachment.isInline;\n\t\t\t}\n\t\t}\n\t\tthis.mailDetails = {\n\t\t\tmailFrom: this.parseEmailAddressDetails(mailItem.from),\n\t\t\tmailSender: mailItem.sender.emailAddress,\n\t\t\tmailTo: this.parseEmailAddressDetails(mailItem.to),\n\t\t\tmailCc: this.parseEmailAddressDetails(mailItem.cc),\n\t\t\tmailMessageId: mailItem.internetMessageId,\n\t\t\tmailSubject: mailItem.subject,\n\t\t\tmailNormalizedSubject: mailItem.normalizedSubject,\n\t\t\tmailDateTimeCreated: mailItem.dateTimeCreated.toISOString()\n\t\t};\n\t\treturn this.asyncGetMailBody();\n\t},\n\t/**\n\t * Get mail body async function\n\t *\n\t * @param   {function}  callback\n\t *\n\t * @return  {object}            Promise\n\t */\n\tasyncGetMailBody() {\n\t\treturn Promise.all([\n\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\tthis.mailItem.body.getAsync(Office.CoercionType.Html, (body) => {\n\t\t\t\t\tif (body.status === 'succeeded') {\n\t\t\t\t\t\tthis.mailDetails.mailBody = body.value;\n\t\t\t\t\t\tresolve(body);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(body);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}),\n\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\tthis.mailItem.getAllInternetHeadersAsync((body) => {\n\t\t\t\t\tif (body.status === 'succeeded') {\n\t\t\t\t\t\tthis.mailDetails.mailHeaders = body.value;\n\t\t\t\t\t\tresolve(body);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(body);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t]);\n\t},\n\t/**\n\t * Parse email address details\n\t *\n\t * @param   {object}  data\n\t *\n\t * @return  {string}        e-mail address\n\t */\n\tparseEmailAddressDetails(data) {\n\t\tlet fn = function (row) {\n\t\t\treturn row.emailAddress;\n\t\t};\n\t\tif ($.isArray(data)) {\n\t\t\tlet rows = [];\n\t\t\t$.each(data, function (index, value) {\n\t\t\t\trows[index] = fn(value);\n\t\t\t});\n\t\t\treturn rows;\n\t\t} else {\n\t\t\treturn fn(data);\n\t\t}\n\t},\n\t/**\n\t * Set iframe height\n\t */\n\tsetIframeHeight() {\n\t\tthis.iframe.height($(window).height() - this.iframe.offset().top);\n\t},\n\t/**\n\t * Show iframe loader\n\t */\n\tshowIframeLoader() {\n\t\tthis.iframeLoader.progressIndicator(this.loaderParams);\n\t},\n\t/**\n\t * Hide iframe loader\n\t */\n\thideIframeLoader() {\n\t\tthis.iframeLoader.progressIndicator({ mode: 'hide' });\n\t},\n\t/**\n\t * Init iframe loader\n\t */\n\tinitIframeLoader() {\n\t\tthis.iframeLoader = $.progressIndicator(this.loaderParams);\n\t},\n\t/**\n\t * Register modules select\n\t */\n\tregisterModulesSelect() {\n\t\tthis.moduleSelect = App.Fields.Picklist.showSelect2ElementView(this.container.find('.js-modules'));\n\t\tthis.moduleSelect.on('change', this.registerModulesSelectChange.bind(this));\n\t\tthis.container.find('.js-select-record').on('click', (e) => {\n\t\t\tlet params = {\n\t\t\t\tmodule: this.moduleSelect[0].value,\n\t\t\t\tsrc_module: 'OSSMailView'\n\t\t\t};\n\t\t\tthis.container.find('.js-list-item-click').each(function (index) {\n\t\t\t\tlet data = $(this).data();\n\t\t\t\tif (data.field == 'link' || data.field == 'process') {\n\t\t\t\t\tparams[data.field] = data.id;\n\t\t\t\t}\n\t\t\t});\n\t\t\tapp.showRecordsList(params, (modal, instance) => {\n\t\t\t\tinstance.setSelectEvent((responseData, e) => {\n\t\t\t\t\tthis.addRelation(responseData.id, params.module);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register modules select change\n\t */\n\tregisterModulesSelectChange() {\n\t\tif (this.moduleSelect.select2('data')[0].element.dataset.addRecord) {\n\t\t\tthis.addRecordBtn.removeClass('d-none');\n\t\t} else {\n\t\t\tthis.addRecordBtn.addClass('d-none');\n\t\t}\n\t},\n\t/**\n\t * Register add record\n\t */\n\tregisterAddRecord() {\n\t\tthis.addRecordBtn.on('click', (e) => {\n\t\t\tlet moduleName = this.moduleSelect[0].value;\n\t\t\tlet callbackFunction = ({ result }) => {\n\t\t\t\tthis.addRelation(result._recordId, moduleName);\n\t\t\t};\n\t\t\tlet quickCreateParams = { callbackFunction };\n\t\t\tthis.showQuickCreateForm(moduleName, quickCreateParams);\n\t\t});\n\t},\n\t/**\n\t * Reload view\n\t */\n\treloadView(condition) {\n\t\tif (condition) {\n\t\t\twindow.location.reload();\n\t\t}\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tthis.container = $('#page');\n\t\tthis.iframe = $('#js-iframe');\n\t\tthis.iframeWindow = this.iframe[0].contentWindow;\n\t\tthis.addRecordBtn = this.container.find('.js-add-record');\n\t\tthis.mailId = this.container.find('.js-iframe-container').data('mailId');\n\t\tthis.mailItem = Office.context.mailbox.item;\n\t\tif (this.iframe.length) {\n\t\t\tthis.registerListItemEvents();\n\t\t\tthis.registerIframeEvents();\n\t\t\tthis.setIframeHeight();\n\t\t\tif (this.mailId) {\n\t\t\t\tthis.registerModulesSelect();\n\t\t\t\tthis.registerAddRecord();\n\t\t\t} else {\n\t\t\t\tthis.registerImportClick();\n\t\t\t}\n\t\t}\n\t}\n};\nwindow.App.Components.Scrollbar.active = false;\n(function ($) {\n\twindow.MailIntegration_Iframe.registerEvents();\n})($);\n"],"names":["window","MailIntegration_Iframe","mailId","container","iframe","iframeWindow","moduleSelect","addRecordBtn","loaderParams","blockInfo","enabled","message","connector","request","AppConnector","fail","hideIframeLoader","showResponseMessage","success","mailItem","notificationMessages","replaceAsync","type","icon","persistent","app","vtranslate","registerListItemEvents","on","onClickListItem","bind","$","document","onClickLink","onClickQuickCreateBtn","onClickDeleteRelation","event","currentTarget","toggleActiveListItems","find","attr","url","preventDefault","changeIframeSource","stopPropagation","recordData","closest","data","module","action","mode","record","id","recordModule","done","response","reloadView","newRecordData","sourceModule","sourceRecord","showQuickCreateForm","dataset","callbackFunction","location","reload","fillNewRecordData","moduleName","email","from","emailAddress","email1","relationOperation","relatedRecords","map","fillNameFields","first","nameData","displayName","split","firstName","shift","lastName","join","autoCompleteMap","JSON","parse","val","name","hasOwnProperty","subject","mailDetails","Promise","resolve","asyncGetMailBody","then","description","mailBody","targetListItem","siblings","removeClass","addClass","showIframeLoader","addRelation","recordId","quickCreateParams","Object","assign","noCache","App","Components","QuickCreate","createRecord","registerIframeEvents","link","initIframeLoader","length","registerImportClick","getMailDetails","PanelParams","attachments","attachment","outputString","i","contentType","size","attachmentType","isInline","mailFrom","parseEmailAddressDetails","mailSender","sender","mailTo","to","mailCc","cc","mailMessageId","internetMessageId","mailSubject","mailNormalizedSubject","normalizedSubject","mailDateTimeCreated","dateTimeCreated","toISOString","all","reject","body","getAsync","Office","CoercionType","Html","status","value","getAllInternetHeadersAsync","mailHeaders","fn","row","isArray","rows","each","index","setIframeHeight","height","offset","top","iframeLoader","progressIndicator","registerModulesSelect","Fields","Picklist","showSelect2ElementView","registerModulesSelectChange","params","src_module","field","showRecordsList","modal","instance","setSelectEvent","responseData","select2","element","addRecord","registerAddRecord","result","_recordId","condition","registerEvents","contentWindow","context","mailbox","item","Scrollbar","active"],"mappings":"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"}