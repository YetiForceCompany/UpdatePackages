{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nSettings_Vtiger_Index_Js(\n\t'Settings_Kanban_Index_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Register add modal\n\t\t */\n\t\tregisterAddModal() {\n\t\t\t$('.js-add-board').on('click', (e) => {\n\t\t\t\tapp.showModalWindow(\n\t\t\t\t\tnull,\n\t\t\t\t\t'index.php?module=Kanban&parent=Settings&view=AddModal&sourceModule=' + this.module,\n\t\t\t\t\t(modalContainer) => {\n\t\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', function (e) {\n\t\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\t\t\t\taction: 'Save',\n\t\t\t\t\t\t\t\tmode: 'add',\n\t\t\t\t\t\t\t\tfield: modalContainer.find('.js-system-fields').val()\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register delete event\n\t\t */\n\t\tregisterDeleteEvent() {\n\t\t\tthis.container.find('.js-delete').on('click', (e) => {\n\t\t\t\tlet board = $(e.currentTarget).closest('.js-board');\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\taction: 'Save',\n\t\t\t\t\tmode: 'delete',\n\t\t\t\t\tboard: board.data('id')\n\t\t\t\t})\n\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\tapp.errorLog(error, err);\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register add modal\n\t\t */\n\t\tregisterFieldsEvents() {\n\t\t\tlet fields = this.container.find('.js-sortable-fields');\n\t\t\tfields.on('sortable:change', (e) => {\n\t\t\t\tthis.saveField($(e.currentTarget));\n\t\t\t});\n\t\t\tfields.on('change', (e) => {\n\t\t\t\tthis.saveField($(e.currentTarget));\n\t\t\t});\n\t\t\tlet boards = this.container.find('.js-boards');\n\t\t\tboards.sortable({\n\t\t\t\tcontainment: boards,\n\t\t\t\titems: boards.find('.js-board'),\n\t\t\t\thandle: '.js-drag',\n\t\t\t\trevert: true,\n\t\t\t\ttolerance: 'pointer',\n\t\t\t\tcursor: 'move',\n\t\t\t\tupdate: () => {\n\t\t\t\t\tthis.saveSequence();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Save field\n\t\t */\n\t\tsaveField: function (element) {\n\t\t\tlet board = element.closest('.js-board');\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'Save',\n\t\t\t\tmode: 'update',\n\t\t\t\tboard: board.data('id'),\n\t\t\t\ttype: element.data('type'),\n\t\t\t\tvalue: element.val()\n\t\t\t})\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\tapp.showNotify(data.result.message);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (error) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttitle: app.vtranslate('JS_UNEXPECTED_ERROR'),\n\t\t\t\t\t\ttext: error,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Save sequence\n\t\t */\n\t\tsaveSequence: function () {\n\t\t\tlet boards = [];\n\t\t\tthis.container.find('.js-board').each(function (index) {\n\t\t\t\tboards[index] = $(this).data('id');\n\t\t\t});\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tsourceModule: this.module,\n\t\t\t\taction: 'Save',\n\t\t\t\tmode: 'sequence',\n\t\t\t\tboards: boards\n\t\t\t})\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tif (data.result.message) {\n\t\t\t\t\t\tapp.showNotify(data.result.message);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (error) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttitle: app.vtranslate('JS_UNEXPECTED_ERROR'),\n\t\t\t\t\t\ttext: error,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register module change\n\t\t */\n\t\tregisterModuleEvents: function () {\n\t\t\t$('.js-module-list').on('change', (e) => {\n\t\t\t\twindow.location.href =\n\t\t\t\t\t'index.php?module=Kanban&parent=Settings&view=Index&sourceModule=' + $(e.currentTarget).val();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents() {\n\t\t\tthis._super();\n\t\t\tthis.module = $('#js-module-name').val();\n\t\t\tthis.container = $('.js-fields-list');\n\t\t\tthis.registerAddModal();\n\t\t\tthis.registerDeleteEvent();\n\t\t\tthis.registerFieldsEvents();\n\t\t\tthis.registerModuleEvents();\n\t\t}\n\t}\n);\n"],"names":["Settings_Vtiger_Index_Js","registerAddModal","$","on","app","showModalWindow","module","modalContainer","find","AppConnector","request","getModuleName","parent","getParentModuleName","action","mode","field","val","done","data","result","message","hideModalWindow","window","location","reload","fail","error","err","errorLog","registerDeleteEvent","container","e","board","currentTarget","closest","registerFieldsEvents","fields","saveField","boards","sortable","containment","items","handle","revert","tolerance","cursor","update","saveSequence","element","type","value","showNotify","title","vtranslate","text","each","index","sourceModule","registerModuleEvents","href","registerEvents","_super"],"mappings":";;AAAA,kKACA,aAEAA,wBAAwB,CACvB,0BADuB,CAEvB,EAFuB,CAGvB;AAED;AACA,KACEC,gBAJD,4BAIoB,gBAClBC,CAAC,CAAC,eAAD,CAAD,CAAmBC,EAAnB,CAAsB,OAAtB,CAA+B,UAAO,CACrCC,GAAG,CAACC,eAAJ,CACC,IADD,CAEC,sEAAwE,KAAI,CAACC,MAF9E,CAGC,SAACC,cAAD,CAAoB,CACnBA,cAAc,CAACC,IAAf,CAAoB,iBAApB,EAAuCL,EAAvC,CAA0C,OAA1C,CAAmD,UAAa,CAC/DM,YAAY,CAACC,OAAb,CAAqB,CACpBJ,MAAM,CAAEF,GAAG,CAACO,aAAJ,EADY,CAEpBC,MAAM,CAAER,GAAG,CAACS,mBAAJ,EAFY,CAGpBC,MAAM,CAAE,MAHY,CAIpBC,IAAI,CAAE,KAJc,CAKpBC,KAAK,CAAET,cAAc,CAACC,IAAf,CAAoB,mBAApB,EAAyCS,GAAzC,EALa,CAArB,EAOEC,IAPF,CAOO,SAAUC,IAAV,CAAgB,CACjBA,IAAI,CAACC,MAAL,CAAYC,OADK,GAEpBjB,GAAG,CAACkB,eAAJ,EAFoB,CAGpBC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,EAHoB,EAKrB,CAZF,EAaEC,IAbF,CAaO,SAAUC,KAAV,CAAiBC,GAAjB,CAAsB,CAC3BxB,GAAG,CAACyB,QAAJ,CAAaF,KAAb,CAAoBC,GAApB,EACA,CAfF,EAgBA,CAjBD,EAkBA,CAtBF,EAwBA,CAzBD,EA0BA,CA/BF;AAiCD;AACA,KACEE,mBAnCD,+BAmCuB,CACrB,KAAKC,SAAL,CAAevB,IAAf,CAAoB,YAApB,EAAkCL,EAAlC,CAAqC,OAArC,CAA8C,SAAC6B,CAAD,CAAO,CACpD,IAAIC,KAAK,CAAG/B,CAAC,CAAC8B,CAAC,CAACE,aAAH,CAAD,CAAmBC,OAAnB,CAA2B,WAA3B,CAAZ,CACA1B,YAAY,CAACC,OAAb,CAAqB,CACpBJ,MAAM,CAAEF,GAAG,CAACO,aAAJ,EADY,CAEpBC,MAAM,CAAER,GAAG,CAACS,mBAAJ,EAFY,CAGpBC,MAAM,CAAE,MAHY,CAIpBC,IAAI,CAAE,QAJc,CAKpBkB,KAAK,CAAEA,KAAK,CAACd,IAAN,CAAW,IAAX,CALa,CAArB,EAOED,IAPF,CAOO,SAAUC,IAAV,CAAgB,CACjBA,IAAI,CAACC,MAAL,CAAYC,OADK,EAEpBE,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAED,CAXF,EAYEC,IAZF,CAYO,SAAUC,KAAV,CAAiBC,GAAjB,CAAsB,CAC3BxB,GAAG,CAACyB,QAAJ,CAAaF,KAAb,CAAoBC,GAApB,EACA,CAdF,EAeA,CAjBD,EAkBA,CAtDF;AAwDD;AACA,KACEQ,oBA1DD,gCA0DwB,iBAClBC,MAAM,CAAG,KAAKN,SAAL,CAAevB,IAAf,CAAoB,qBAApB,CADS,CAEtB6B,MAAM,CAAClC,EAAP,CAAU,iBAAV,CAA6B,SAAC6B,CAAD,CAAO,CACnC,MAAI,CAACM,SAAL,CAAepC,CAAC,CAAC8B,CAAC,CAACE,aAAH,CAAhB,EACA,CAFD,CAFsB,CAKtBG,MAAM,CAAClC,EAAP,CAAU,QAAV,CAAoB,SAAC6B,CAAD,CAAO,CAC1B,MAAI,CAACM,SAAL,CAAepC,CAAC,CAAC8B,CAAC,CAACE,aAAH,CAAhB,EACA,CAFD,CALsB,CAQtB,IAAIK,MAAM,CAAG,KAAKR,SAAL,CAAevB,IAAf,CAAoB,YAApB,CAAb,CACA+B,MAAM,CAACC,QAAP,CAAgB,CACfC,WAAW,CAAEF,MADE,CAEfG,KAAK,CAAEH,MAAM,CAAC/B,IAAP,CAAY,WAAZ,CAFQ,CAGfmC,MAAM,CAAE,UAHO,CAIfC,MAAM,GAJS,CAKfC,SAAS,CAAE,SALI,CAMfC,MAAM,CAAE,MANO,CAOfC,MAAM,CAAE,iBAAM,CACb,MAAI,CAACC,YAAL,GACA,CATc,CAAhB,EAWA,CA9EF;AAgFD;AACA,KACEV,SAAS,CAAE,mBAAUW,OAAV,CAAmB,CAC7B,IAAIhB,KAAK,CAAGgB,OAAO,CAACd,OAAR,CAAgB,WAAhB,CAAZ,CACA1B,YAAY,CAACC,OAAb,CAAqB,CACpBJ,MAAM,CAAEF,GAAG,CAACO,aAAJ,EADY,CAEpBC,MAAM,CAAER,GAAG,CAACS,mBAAJ,EAFY,CAGpBC,MAAM,CAAE,MAHY,CAIpBC,IAAI,CAAE,QAJc,CAKpBkB,KAAK,CAAEA,KAAK,CAACd,IAAN,CAAW,IAAX,CALa,CAMpB+B,IAAI,CAAED,OAAO,CAAC9B,IAAR,CAAa,MAAb,CANc,CAOpBgC,KAAK,CAAEF,OAAO,CAAChC,GAAR,EAPa,CAArB,EASEC,IATF,CASO,SAAUC,IAAV,CAAgB,CACjBA,IAAI,CAACC,MAAL,CAAYC,OADK,EAEpBjB,GAAG,CAACgD,UAAJ,CAAejC,IAAI,CAACC,MAAL,CAAYC,OAA3B,EAED,CAbF,EAcEK,IAdF,CAcO,SAAUC,KAAV,CAAiB,CACtBvB,GAAG,CAACgD,UAAJ,CAAe,CACdC,KAAK,CAAEjD,GAAG,CAACkD,UAAJ,CAAe,qBAAf,CADO,CAEdC,IAAI,CAAE5B,KAFQ,CAGduB,IAAI,CAAE,OAHQ,CAAf,EAKA,CApBF,EAqBA,CAzGF;AA2GD;AACA,KACEF,YAAY,CAAE,uBAAY,CACzB,IAAIT,MAAM,CAAG,EAAb,CACA,KAAKR,SAAL,CAAevB,IAAf,CAAoB,WAApB,EAAiCgD,IAAjC,CAAsC,SAAUC,KAAV,CAAiB,CACtDlB,MAAM,CAACkB,KAAD,CAAN,CAAgBvD,CAAC,CAAC,IAAD,CAAD,CAAQiB,IAAR,CAAa,IAAb,EAChB,CAFD,CAFyB,CAKzBV,YAAY,CAACC,OAAb,CAAqB,CACpBJ,MAAM,CAAEF,GAAG,CAACO,aAAJ,EADY,CAEpBC,MAAM,CAAER,GAAG,CAACS,mBAAJ,EAFY,CAGpB6C,YAAY,CAAE,KAAKpD,MAHC,CAIpBQ,MAAM,CAAE,MAJY,CAKpBC,IAAI,CAAE,UALc,CAMpBwB,MAAM,CAAEA,MANY,CAArB,EAQErB,IARF,CAQO,SAAUC,IAAV,CAAgB,CACjBA,IAAI,CAACC,MAAL,CAAYC,OADK,EAEpBjB,GAAG,CAACgD,UAAJ,CAAejC,IAAI,CAACC,MAAL,CAAYC,OAA3B,EAED,CAZF,EAaEK,IAbF,CAaO,SAAUC,KAAV,CAAiB,CACtBvB,GAAG,CAACgD,UAAJ,CAAe,CACdC,KAAK,CAAEjD,GAAG,CAACkD,UAAJ,CAAe,qBAAf,CADO,CAEdC,IAAI,CAAE5B,KAFQ,CAGduB,IAAI,CAAE,OAHQ,CAAf,EAKA,CAnBF,EAoBA,CAtIF;AAwID;AACA,KACES,oBAAoB,CAAE,+BAAY,CACjCzD,CAAC,CAAC,iBAAD,CAAD,CAAqBC,EAArB,CAAwB,QAAxB,CAAkC,SAAC6B,CAAD,CAAO,CACxCT,MAAM,CAACC,QAAP,CAAgBoC,IAAhB,CACC,mEAAqE1D,CAAC,CAAC8B,CAAC,CAACE,aAAH,CAAD,CAAmBjB,GAAnB,GACtE,CAHD,EAIA,CA/IF;AAiJD;AACA,KACE4C,cAnJD,0BAmJkB,CAChB,KAAKC,MAAL,EADgB,CAEhB,KAAKxD,MAAL,CAAcJ,CAAC,CAAC,iBAAD,CAAD,CAAqBe,GAArB,EAFE,CAGhB,KAAKc,SAAL,CAAiB7B,CAAC,CAAC,iBAAD,CAHF,CAIhB,KAAKD,gBAAL,EAJgB,CAKhB,KAAK6B,mBAAL,EALgB,CAMhB,KAAKM,oBAAL,EANgB,CAOhB,KAAKuB,oBAAL,GACA,CA3JF,CAHuB;;"}