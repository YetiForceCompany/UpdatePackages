{"version":3,"file":"PDF.min.js","sources":["PDF.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class('Vtiger_PDF_Js', {\n\t/**\n\t * Proceed form submission\n\t */\n\tproceedSubmit(mode) {\n\t\tconst loader = $.progressIndicator({\n\t\t\tmessage: app.vtranslate('JS_PDF_GENERATING'),\n\t\t\tposition: 'html',\n\t\t\tblockInfo: {\n\t\t\t\tenabled: true\n\t\t\t}\n\t\t});\n\t\tswitch (mode) {\n\t\t\tcase 'generate_pdf':\n\t\t\t\tthis.container.find('#pdfExportModal').submit();\n\t\t\t\tbreak;\n\t\t\tcase 'single_pdf':\n\t\t\t\tthis.container.find('[name=\"single_pdf\"]').val(1);\n\t\t\t\tthis.container.find('#pdfExportModal').submit();\n\t\t\t\tbreak;\n\t\t\tcase 'email_pdf':\n\t\t\t\tthis.container.find('[name=\"email_pdf\"]').val(1);\n\t\t\t\tthis.container.find('#pdfExportModal').submit();\n\t\t\t\tbreak;\n\t\t}\n\t\tloader.progressIndicator({ mode: 'hide' });\n\t\tapp.hideModalWindow();\n\t},\n\n\t/*\n\t * Function to register the click event for generate button\n\t */\n\tregisterPreSubmitEvent: function (container) {\n\t\tconst self = this;\n\t\tcontainer.find('#generate_pdf, #single_pdf, #email_pdf').on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tself.proceedSubmit.apply(self, [$(e.currentTarget).attr('id')]);\n\t\t});\n\t},\n\n\t/**\n\t * Register list view check records\n\t *\n\t * @param   {jQuery}  container\n\t */\n\tregisterListViewCheckRecords(container) {\n\t\tlet templateElements = container.find('[name=\"pdf_template[]\"]');\n\t\ttemplateElements.on('change', function () {\n\t\t\tdocument.progressLoader = $.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_PDF_RECALCULATING'),\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet templateContainer = $(this).closest('.js-pdf-template-content');\n\t\t\ttemplateContainer.find('.js-pdf-user-variable').toggleClass('d-none');\n\n\t\t\tlet templates = [];\n\t\t\ttemplateElements.filter(':checked').each(function () {\n\t\t\t\ttemplates.push($(this).val());\n\t\t\t});\n\n\t\t\tlet params = container.find('form').serializeFormData();\n\t\t\tparams.mode = 'validateRecords';\n\t\t\tparams.templates = templates;\n\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tvar response = data.result;\n\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\tlet valid = response.valid;\n\t\t\t\t\t\tlet info = container.find('.js-records-info').text(response.message).removeClass('d-none');\n\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\tinfo.addClass('d-none');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tdocument.progressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t}, 500);\n\n\t\t\t\t\t\tcontainer.find('.js-submit-button').each(function () {\n\t\t\t\t\t\t\t$(this).attr('disabled', !valid);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (data, err) {\n\t\t\t\t\tapp.errorLog(data, err);\n\t\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Register select custom columns change\n\t */\n\tregisterSelectCustomColumnsChange() {\n\t\tthis.container.find('[name=\"isCustomMode\"]').on('change', (ev) => {\n\t\t\tif ($(ev.target).is(':checked')) {\n\t\t\t\tthis.container.find('[name=\"inventoryColumns[]\"]').prop('disabled', null);\n\t\t\t\tthis.container.find('.js-save-scheme').prop('disabled', null);\n\t\t\t} else {\n\t\t\t\tthis.container.find('[name=\"inventoryColumns[]\"]').prop('disabled', 'disabled');\n\t\t\t\tthis.container.find('.js-save-scheme').prop('disabled', 'disabled');\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Register save scheme button click\n\t */\n\tregisterSaveInventoryColumnSchemeClick() {\n\t\tthis.container.find('.js-save-scheme').on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tconst loader = $.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet params = this.container.find('form').serializeFormData();\n\t\t\tparams.mode = 'saveInventoryColumnScheme';\n\t\t\tparams.isCustomMode = this.container.find('[name=\"isCustomMode\"]').is(':checked');\n\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tconst response = data['result'];\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t}\n\t\t\t\t\tif (response['message'] && data['success']) {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function (data, err) {\n\t\t\t\t\tapp.errorLog(data, err);\n\t\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tconst container = (this.container = $('#pdfExportModal').closest('.js-modal-container'));\n\t\tthis.dynamicTemplatesCount = 0;\n\t\tthis.recordId = parseInt(container.find('[name=\"record\"]').val());\n\t\tthis.registerPreSubmitEvent(container);\n\t\tthis.registerSaveInventoryColumnSchemeClick();\n\t\tthis.registerSelectCustomColumnsChange();\n\t\tthis.registerListViewCheckRecords(container);\n\t}\n});\n$(function () {\n\tnew Vtiger_PDF_Js().registerEvents();\n});\n"],"names":["$","Class","proceedSubmit","mode","loader","progressIndicator","message","app","vtranslate","position","blockInfo","enabled","container","find","submit","val","hideModalWindow","registerPreSubmitEvent","self","on","e","preventDefault","apply","currentTarget","attr","registerListViewCheckRecords","templateElements","document","progressLoader","templateContainer","closest","toggleClass","templates","filter","each","push","params","serializeFormData","AppConnector","request","done","data","response","result","success","valid","info","text","removeClass","addClass","setTimeout","fail","err","errorLog","registerSelectCustomColumnsChange","ev","target","is","prop","registerSaveInventoryColumnSchemeClick","stopPropagation","isCustomMode","showNotify","type","registerEvents","dynamicTemplatesCount","recordId","parseInt","Vtiger_PDF_Js"],"mappings":"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"}