{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\n\t'Project_Detail_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to register event for create related record\n\t\t * in summary view widgets\n\t\t */\n\t\tregisterSummaryViewContainerEvents: function (summaryViewContainer) {\n\t\t\tthis._super(summaryViewContainer);\n\t\t},\n\t\t/**\n\t\t * Function to load module summary of Projects\n\t\t */\n\t\tloadModuleSummary: function () {\n\t\t\tvar summaryParams = {};\n\t\t\tsummaryParams['module'] = app.getModuleName();\n\t\t\tsummaryParams['view'] = 'Detail';\n\t\t\tsummaryParams['mode'] = 'showModuleSummaryView';\n\t\t\tsummaryParams['record'] = jQuery('#recordId').val();\n\t\t\tAppConnector.request(summaryParams).done(function (data) {\n\t\t\t\tjQuery('.js-widget-general-info').html(data);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Load gantt component\n\t\t */\n\t\tloadGantt() {\n\t\t\tlet ganttContainer = $('.c-gantt', this.detailViewContentHolder);\n\t\t\tif (ganttContainer.length) {\n\t\t\t\tlet gantt = new Project_Gantt_Js(this.detailViewContentHolder);\n\t\t\t\tgantt.registerEvents();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Load gantt component when needed\n\t\t */\n\t\tregisterGantt() {\n\t\t\tthis.loadGantt();\n\t\t\tapp.event.on('DetailView.Tab.AfterLoad', (e, data, instance) => {\n\t\t\t\tinstance.detailViewContentHolder.ready(() => {\n\t\t\t\t\tthis.loadGantt();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to get response from hierarchy\n\t\t * @param {array} params\n\t\t * @returns {jQuery}\n\t\t */\n\t\tgetHierarchyResponseData: function (params) {\n\t\t\tlet thisInstance = this,\n\t\t\t\taDeferred = $.Deferred();\n\t\t\tif (!$.isEmptyObject(thisInstance.hierarchyResponseCache)) {\n\t\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t\t} else {\n\t\t\t\tAppConnector.request(params).then(function (data) {\n\t\t\t\t\tthisInstance.hierarchyResponseCache = data;\n\t\t\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to display the hierarchy response data\n\t\t * @param {array} data\n\t\t */\n\t\tdisplayHierarchyResponseData: function (data) {\n\t\t\tlet callbackFunction = function () {\n\t\t\t\tapp.showScrollBar($('#hierarchyScroll'), {\n\t\t\t\t\theight: '300px',\n\t\t\t\t\trailVisible: true,\n\t\t\t\t\tsize: '6px'\n\t\t\t\t});\n\t\t\t};\n\t\t\tapp.showModalWindow(data, function (modalContainer) {\n\t\t\t\tApp.Components.Scrollbar.xy($('#hierarchyScroll', modalContainer));\n\t\t\t\tif (typeof callbackFunction == 'function' && $('#hierarchyScroll', modalContainer).height() > 300) {\n\t\t\t\t\tcallbackFunction();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Registers read count of hierarchy if it is possible\n\t\t */\n\t\tregisterHierarchyRecordCount: function () {\n\t\t\tlet hierarchyButton = $('.js-detail-hierarchy'),\n\t\t\t\tparams = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\tmode: 'getHierarchyCount'\n\t\t\t\t};\n\t\t\tif (hierarchyButton.length) {\n\t\t\t\tAppConnector.request(params).then(function (response) {\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t$('.hierarchy .badge').html(response.result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Shows hierarchy\n\t\t */\n\t\tregisterShowHierarchy: function () {\n\t\t\tlet thisInstance = this,\n\t\t\t\thierarchyButton = $('.detailViewTitle'),\n\t\t\t\tparams = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Hierarchy',\n\t\t\t\t\trecord: app.getRecordId()\n\t\t\t\t};\n\t\t\thierarchyButton.on('click', '.js-detail-hierarchy', function () {\n\t\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisInstance.getHierarchyResponseData(params).then(function (data) {\n\t\t\t\t\tthisInstance.displayHierarchyResponseData(data);\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tvar thisInstance = this;\n\t\t\tthis._super();\n\t\t\tdetailContentsHolder.on('click', '.moreRecentTickets', function () {\n\t\t\t\tvar recentTicketsTab = thisInstance.getTabByLabel(thisInstance.detailViewRecentTicketsTabLabel);\n\t\t\t\trecentTicketsTab.trigger('click');\n\t\t\t});\n\t\t\tthis.registerGantt();\n\t\t\tthis.registerHierarchyRecordCount();\n\t\t\tthis.registerShowHierarchy();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","registerSummaryViewContainerEvents","summaryViewContainer","_super","loadModuleSummary","summaryParams","app","getModuleName","jQuery","val","AppConnector","request","done","data","html","loadGantt","ganttContainer","$","detailViewContentHolder","length","gantt","Project_Gantt_Js","registerEvents","registerGantt","event","on","e","instance","ready","getHierarchyResponseData","params","thisInstance","aDeferred","Deferred","isEmptyObject","hierarchyResponseCache","then","resolve","promise","displayHierarchyResponseData","callbackFunction","showScrollBar","height","railVisible","size","showModalWindow","modalContainer","App","Components","Scrollbar","xy","registerHierarchyRecordCount","hierarchyButton","module","action","record","getRecordId","mode","response","success","result","registerShowHierarchy","view","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","detailContentsHolder","getContentHolder","recentTicketsTab","getTabByLabel","detailViewRecentTicketsTabLabel","trigger"],"mappings":"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"}