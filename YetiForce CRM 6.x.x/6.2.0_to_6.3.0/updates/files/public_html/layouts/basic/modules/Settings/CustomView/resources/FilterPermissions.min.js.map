{"version":3,"file":"FilterPermissions.min.js","sources":["FilterPermissions.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_CustomView_FilterPermissions_Js',\n\t{},\n\t{\n\t\tformElement: false,\n\t\tregisterButtonsEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = this.getForm();\n\t\t\tcontainer.find('button.moveItem').on('click', function (e) {\n\t\t\t\tthisInstance.setDefaultPreferences(e);\n\t\t\t});\n\t\t},\n\t\tregisterDisabledButtons: function () {\n\t\t\tvar container = this.getForm();\n\t\t\tcontainer.find('button.moveItem').each(function (n, e) {\n\t\t\t\tvar currentTarget = jQuery(e);\n\t\t\t\tvar sourceClass = currentTarget.data('source');\n\t\t\t\tvar source = container.find('.' + sourceClass);\n\t\t\t\tif (source.find('option').length && !source.is(':disabled')) {\n\t\t\t\t\tcurrentTarget.prop('disabled', false);\n\t\t\t\t} else {\n\t\t\t\t\tcurrentTarget.prop('disabled', true);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmove: function (currentTarget) {\n\t\t\tvar container = this.getForm();\n\t\t\tvar sourceClass = currentTarget.data('source');\n\t\t\tvar targetClass = currentTarget.data('target');\n\t\t\tvar target = container.find('.' + targetClass);\n\t\t\tvar source = container.find('.' + sourceClass).find('option:selected');\n\n\t\t\tvar values = {};\n\t\t\tvalues.val = source.val();\n\t\t\tvalues.label = source.text();\n\t\t\tvalues.blockLabel = source.closest('optgroup').attr('label');\n\n\t\t\tvar targetOption = '<option value=\"' + values.val + '\">' + values.label + '</option>';\n\t\t\tvar targetOpt = target.find('optgroup[label=\"' + values.blockLabel + '\"]');\n\t\t\tif (targetOpt.length) {\n\t\t\t\ttargetOpt.append(targetOption);\n\t\t\t} else {\n\t\t\t\ttarget.append('<optgroup label=\"' + values.blockLabel + '\">' + targetOption + '</optgroup>');\n\t\t\t}\n\t\t\tsource.remove();\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('.select2'));\n\t\t},\n\t\t/**\n\t\t * Saves permission for filter\n\t\t * @param {jQuery.Event} e\n\t\t */\n\t\tsetDefaultPreferences: function (e) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = this.getForm();\n\t\t\tvar progressIndicatorElement = $.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_SAVE_LOADER_INFO'),\n\t\t\t\tposition: this.getForm(),\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar sourceClass = currentTarget.data('source');\n\t\t\tvar params = {\n\t\t\t\ttabid: container.find('#sourceModule').val(),\n\t\t\t\tuser: container.find('.' + sourceClass).val(),\n\t\t\t\tcvid: container.find('#cvid').val(),\n\t\t\t\toperator: currentTarget.data('operator'),\n\t\t\t\ttype: container.find('#type').val()\n\t\t\t};\n\t\t\tapp.saveAjax('setFilterPermissions', {}, params).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tif (data.result.success) {\n\t\t\t\t\t\tthisInstance.move(currentTarget);\n\t\t\t\t\t\tthisInstance.registerDisabledButtons();\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tapp.showNotify({ text: data.result.message, type: 'success' });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tapp.showNotify({ text: data.result.message, type: 'error' });\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetForm: function () {\n\t\t\tif (this.formElement == false) {\n\t\t\t\tthis.setForm(jQuery('#modalFilterPermissions'));\n\t\t\t}\n\t\t\treturn this.formElement;\n\t\t},\n\t\tsetForm: function (element) {\n\t\t\tthis.formElement = element;\n\t\t\treturn this;\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis.registerButtonsEvent();\n\t\t\tthis.registerDisabledButtons();\n\t\t}\n\t}\n);\n\njQuery(document).ready(function (e) {\n\tvar instance = new Settings_CustomView_FilterPermissions_Js();\n\tinstance.registerEvents();\n});\n"],"names":["jQuery","Class","formElement","registerButtonsEvent","thisInstance","container","getForm","find","on","e","setDefaultPreferences","registerDisabledButtons","each","n","currentTarget","sourceClass","data","source","length","is","prop","move","targetClass","target","values","val","label","text","blockLabel","closest","attr","targetOption","targetOpt","append","remove","App","Fields","Picklist","showSelect2ElementView","progressIndicatorElement","$","progressIndicator","message","app","vtranslate","position","blockInfo","enabled","params","tabid","user","cvid","operator","type","saveAjax","done","success","result","mode","showNotify","setForm","element","registerEvents","document","ready","instance","Settings_CustomView_FilterPermissions_Js"],"mappings":"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"}