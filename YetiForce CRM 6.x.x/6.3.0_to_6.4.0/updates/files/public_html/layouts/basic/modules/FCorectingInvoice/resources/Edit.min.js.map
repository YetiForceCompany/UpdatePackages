{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\nVtiger_Edit_Js(\n\t'FCorectingInvoice_Edit_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Load correcting invoice data to before block\n\t\t * @param {int} recordId\n\t\t */\n\t\tloadInvoiceData(recordId = false) {\n\t\t\tif (!recordId) {\n\t\t\t\trecordId = parseInt(this.getForm().find('input[name=\"finvoiceid\"]').val());\n\t\t\t}\n\t\t\tif (recordId && recordId != 0) {\n\t\t\t\tconst form = this.getForm();\n\t\t\t\tconst progressLoader = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'FInvoice',\n\t\t\t\t\trecord: recordId,\n\t\t\t\t\tmode: 'showInventoryDetails',\n\t\t\t\t\tview: 'Detail'\n\t\t\t\t})\n\t\t\t\t\t.done((response) => {\n\t\t\t\t\t\tform.find('.js-before-inventory').html(response);\n\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t})\n\t\t\t\t\t.fail(() => {\n\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * register reference fields events\n\t\t */\n\t\tregisterReferenceFieldsEvents() {\n\t\t\tapp.event.on('EditView.SelectReference', (e, params) => {\n\t\t\t\tif (params.module === 'FInvoice') {\n\t\t\t\t\tthis.loadInvoiceData(params.record);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst form = this.getForm();\n\t\t\tapp.event.on('EditView.ClearField', (e, params) => {\n\t\t\t\tif (params.fieldName === 'finvoiceid') {\n\t\t\t\t\tconst invoiceidInput = form.find('[name=\"finvoiceid\"]');\n\t\t\t\t\tif (invoiceidInput.length) {\n\t\t\t\t\t\tform\n\t\t\t\t\t\t\t.find('.js-before-inventory')\n\t\t\t\t\t\t\t.html('<div class=\"text-center\">' + app.vtranslate('JS_FCORECTINGINVOICE_CHOOSE_INVOICE') + '</div>');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Action for copy from correcting invoice button - load data before positions to position in data after block\n\t\t */\n\t\tregisterCopyFromInvoice() {\n\t\t\tconst form = this.getForm();\n\t\t\tconst thisInstance = this;\n\t\t\tform.find('.js-copy-from-invoice').on('click', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tconst finvoiceidInput = form.find('input[name=\"finvoiceid\"]');\n\t\t\t\tif (!finvoiceidInput.length) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst finvoiceid = finvoiceidInput.val();\n\t\t\t\tif (!finvoiceid || finvoiceid == 0) {\n\t\t\t\t\treturn Vtiger_Helper_Js.showMessage({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\ttext: app.vtranslate('JS_FCORECTINGINVOICE_CHOOSE_INVOICE')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthisInstance.inventoryController.loadInventoryData(finvoiceid, 'FInvoice');\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * registerEvents override\n\t\t */\n\t\tregisterEvents() {\n\t\t\tthis._super();\n\t\t\tthis.registerCopyFromInvoice();\n\t\t\tthis.registerReferenceFieldsEvents();\n\t\t\tthis.loadInvoiceData();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Edit_Js","loadInvoiceData","recordId","parseInt","getForm","find","val","progressLoader","$","progressIndicator","blockInfo","enabled","AppConnector","request","module","record","mode","view","done","response","form","html","fail","registerReferenceFieldsEvents","app","event","on","e","params","fieldName","invoiceidInput","length","vtranslate","registerCopyFromInvoice","thisInstance","preventDefault","stopPropagation","finvoiceidInput","finvoiceid","inventoryController","loadInventoryData","Vtiger_Helper_Js","showMessage","type","text","registerEvents","_super"],"mappings":"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"}