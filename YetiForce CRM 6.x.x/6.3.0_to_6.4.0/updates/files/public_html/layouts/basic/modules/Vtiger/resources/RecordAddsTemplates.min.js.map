{"version":3,"file":"RecordAddsTemplates.min.js","sources":["RecordAddsTemplates.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n$.Class(\n\t'Base_RecordAddsTemplates_JS',\n\t{},\n\t{\n\t\teditInstance: false,\n\t\t/**\n\t\t * Function listener to send a form\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterSubmitForm: function (container) {\n\t\t\tconst aDeferred = $.Deferred();\n\t\t\tlet instanse = this;\n\t\t\tcontainer.on('click', '.js-modal__save', () => {\n\t\t\t\tlet params = {\n\t\t\t\t\taction: 'RecordAddsTemplates',\n\t\t\t\t\trecordAddsType: container.find('.js-modal-body').find(\"[name='recordAddsType']\").val()\n\t\t\t\t};\n\t\t\t\tlet validate = true;\n\t\t\t\tcontainer.find('form.js-record-template').each(function () {\n\t\t\t\t\tlet form = $(this);\n\t\t\t\t\tinstanse.editInstance.registerValidationsFields(form);\n\t\t\t\t\tlet formSerializeData = form.serializeFormData();\n\t\t\t\t\tparams[formSerializeData.module] = formSerializeData;\n\t\t\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\t\t\tvalidate = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (validate) {\n\t\t\t\t\tAppConnector.request(params)\n\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\tlet response = data.result;\n\t\t\t\t\t\t\tlet preSave = response.preSave;\n\t\t\t\t\t\t\tif (typeof preSave !== 'undefined' && preSave.length) {\n\t\t\t\t\t\t\t\tfor (let i = 0; i < preSave.length; i++) {\n\t\t\t\t\t\t\t\t\tif (preSave[i] !== null && preSave[i].result !== true) {\n\t\t\t\t\t\t\t\t\t\tapp.showNotify(preSave[i].message ? preSave[i].message : app.vtranslate('JS_ERROR'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (response.url) {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = response.url;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (response.length <= 0) {\n\t\t\t\t\t\t\t\taDeferred.resolve(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register events function\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.editInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.editInstance.registerBasicEvents(modalContainer);\n\t\t\tthis.registerSubmitForm(modalContainer);\n\t\t}\n\t}\n);\n"],"names":["$","Class","editInstance","registerSubmitForm","container","Deferred","instanse","on","params","action","recordAddsType","find","val","validate","each","registerValidationsFields","form","serializeFormData","formSerializeData","module","validationEngine","AppConnector","request","done","data","result","preSave","response","length","i","app","showNotify","message","vtranslate","success","hideModalWindow","text","type","url","window","location","href","reload","aDeferred","resolve","fail","textStatus","errorThrown","errorLog","registerEvents","modalContainer","Vtiger_Edit_Js","getInstance","registerBasicEvents"],"mappings":";;AAAA,kKACAA,CAAC,CAACC,KAAF,CACC,6BADD,CAEC,EAFD,CAGC,CACCC,YAAY,CAAA,CAAA,CADb;AAGD;AACA;AACA,KACEC,kBAAkB,CAAE,SAAA,kBAAA,CAAUC,SAAV,CAAqB,CAAA,aACzB,CAAGJ,CAAC,CAACK,QAAF,EADsB,CAEpCC,QAAQ,CAAG,IAFyB,CAGxCF,SAAS,CAACG,EAAV,CAAa,OAAb,CAAsB,iBAAtB,CAAyC,UAAM,CAC1CC,IAAAA,MAAM,CAAG,CACZC,MAAM,CAAE,qBADI,CAEZC,cAAc,CAAEN,SAAS,CAACO,IAAV,CAAe,gBAAf,CAAA,CAAiCA,IAAjC,CAAsC,yBAAtC,CAAiEC,CAAAA,GAAjE,EAFJ,CADiC,CAK1CC,QAAQ,CALkC,CAAA,CAAA,CAM9CT,SAAS,CAACO,IAAV,CAAe,yBAAf,EAA0CG,IAA1C,CAA+C,UAAY,CAC1D,IAAQ,IAAA,CAAGd,CAAC,CAAC,IAAD,CAAZ,CACAM,QAAQ,CAACJ,YAAT,CAAsBa,yBAAtB,CAAgDC,IAAhD,CAF0D,CAG1D,IAAqB,iBAAA,CAAGA,IAAI,CAACC,iBAAL,EAAxB,CACAT,MAAM,CAACU,iBAAiB,CAACC,MAAnB,CAAN,CAAmCD,iBAJuB,CAKrDF,IAAI,CAACI,gBAAL,CAAsB,UAAtB,CALqD,GAMzDP,QAAQ,GANiD,EAQ1D,CARD,CAN8C,CAe1CA,QAf0C,EAgB7CQ,YAAY,CAACC,OAAb,CAAqBd,MAArB,CACEe,CAAAA,IADF,CACO,SAAUC,IAAV,CAAgB,CAAA,YACT,CAAGA,IAAI,CAACC,MADC,CAEjBC,OAAO,CAAGC,QAAQ,CAACD,OAFF,CAGrB,GAAuB,WAAnB,SAAA,OAAA,EAAkCA,OAAO,CAACE,MAA9C,CACC,IAAK,IAAK,CAAA,CAAG,CAAb,CAAgBC,CAAC,CAAGH,OAAO,CAACE,MAA5B,CAAoCC,CAAC,EAArC,CACoB,IAAf,GAAAH,OAAO,CAACG,CAAD,CAAP,EAAuB,CAAAH,CAAAA,GAAAA,OAAO,CAACG,CAAD,CAAP,CAAWJ,MADvC,EAEEK,GAAG,CAACC,UAAJ,CAAeL,OAAO,CAACG,CAAD,CAAP,CAAWG,OAAX,CAAqBN,OAAO,CAACG,CAAD,CAAP,CAAWG,OAAhC,CAA0CF,GAAG,CAACG,UAAJ,CAAe,UAAf,CAAzD,CAFF,CADD,aAOa,CAACC,OAPd,EAQEJ,GAAG,CAACK,eAAJ,EARF,CASEL,GAAG,CAACC,UAAJ,CAAe,CACdK,IAAI,CAAET,QAAQ,CAACK,OAAT,CAAmBL,QAAQ,CAACK,OAA5B,CAAsCF,GAAG,CAACG,UAAJ,CAAe,mBAAf,CAD9B,CAEdI,IAAI,CAAE,SAFQ,CAAf,CATF,CAaMV,QAAQ,CAACW,GAbf,CAcGC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuBd,QAAQ,CAACW,GAdnC,CAgBGC,MAAM,CAACC,QAAP,CAAgBE,MAAhB,EAhBH,EAmBEZ,GAAG,CAACC,UAAJ,CAAe,CACdK,IAAI,CAAET,QAAQ,CAACK,OAAT,CAAmBL,QAAQ,CAACK,OAA5B,CAAsCF,GAAG,CAACG,UAAJ,CAAe,UAAf,CAD9B,CAEdI,IAAI,CAAE,OAFQ,CAAf,CAnBF,CAyBuB,CAAnB,EAAAV,QAAQ,CAACC,MA5BQ,CA6BpBe,SAAS,CAACC,OAAV,CA7BoB,CAAA,CAAA,CAAA,CA+BpBD,SAAS,CAACC,OAAV,KAED,CAlCF,CAAA,CAmCEC,IAnCF,CAmCO,SAACC,UAAD,CAAaC,WAAb,CAA6B,CAClCjB,GAAG,CAACC,UAAJ,CAAe,CACdK,IAAI,CAAEN,GAAG,CAACG,UAAJ,CAAe,UAAf,CADQ,CAEdI,IAAI,CAAE,OAFQ,CAAf,CADkC,CAKlCP,GAAG,CAACkB,QAAJ,CAAaF,UAAb,CAAyBC,WAAzB,CALkC,CAMlCJ,SAAS,CAACC,OAAV,CACA,CAAA,CAAA,EAAA,CA1CF,EA4CD,CA5DD,EA6DA,CAtEF;AAyED;AACA;AACA,KACEK,cAAc,CAAE,SAAUC,cAAAA,CAAAA,cAAV,CAA0B,CACzC,IAAKhD,CAAAA,YAAL,CAAoBiD,cAAc,CAACC,WAAf,EADqB,CAEzC,IAAKlD,CAAAA,YAAL,CAAkBmD,mBAAlB,CAAsCH,cAAtC,CAFyC,CAGzC,IAAK/C,CAAAA,kBAAL,CAAwB+C,cAAxB,EACA,CAhFF,CAHD;;"}