{"version":3,"file":"SortOrderModal.min.js","sources":["SortOrderModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_SortOrderModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Modal container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Source container\n\t\t */\n\t\tsourceContainer: false,\n\t\t/**\n\t\t * Modal ID\n\t\t */\n\t\tsource: false,\n\t\t/**\n\t\t * Load data\n\t\t */\n\t\tloadData: function () {\n\t\t\tlet orderBy = this.sourceContainer.find('#orderBy').val();\n\t\t\torderBy = orderBy ? JSON.parse(orderBy) : [];\n\t\t\tif (orderBy && Object.keys(orderBy).length) {\n\t\t\t\tlet baseOrderBy = this.container.find('.js-base-element');\n\t\t\t\tfor (let field in orderBy) {\n\t\t\t\t\tif (!baseOrderBy.find(\"option[value='\" + field + \"']\").length) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet element = this.addRow();\n\t\t\t\t\telement.find('select.js-orderBy').val(field).change();\n\t\t\t\t\tlet sortIcon = element.find('.js-sort-icon-active');\n\t\t\t\t\tif (orderBy[field] && sortIcon.data('val') != orderBy[field]) {\n\t\t\t\t\t\tsortIcon.trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Add new row\n\t\t */\n\t\taddRow: function () {\n\t\t\tlet sortContainer = this.container.find('.js-base-element').clone(true, true).removeClass('js-base-element');\n\t\t\tthis.container.find('.js-sort-container').append(sortContainer);\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(sortContainer.find('select'));\n\t\t\treturn sortContainer.removeClass('d-none');\n\t\t},\n\t\t/**\n\t\t * Register list events\n\t\t */\n\t\tregisterListEvents: function () {\n\t\t\tthis.container.find('.js-add').on('click', (e) => {\n\t\t\t\tthis.addRow();\n\t\t\t});\n\t\t\tthis.container.find('.js-clear').on('click', (e) => {\n\t\t\t\t$(e.currentTarget).closest('.js-sort-container_element').remove();\n\t\t\t});\n\t\t\tthis.container.find('.js-sort-order-button').on('click', (e) => {\n\t\t\t\tlet element = $(e.currentTarget).closest('.js-sort-container_element');\n\t\t\t\telement.find('.js-sort-icon').toggleClass('d-none js-sort-icon-active');\n\t\t\t\telement.find('.js-sort-order').val(element.find('.js-sort-icon-active').data('val'));\n\t\t\t});\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.sourceContainer.find('.js-list-reload').trigger('click', { orderby: this.getSortData() });\n\t\t\t\tapp.hideModalWindow(null, this.source);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Gets sort data\n\t\t */\n\t\tgetSortData: function () {\n\t\t\tlet sortData = {};\n\t\t\tthis.container.find('.js-sort-container_element:not(.js-base-element)').each(function () {\n\t\t\t\tlet orderBy = $(this).find('.js-orderBy').val();\n\t\t\t\tif (orderBy) {\n\t\t\t\t\tsortData[orderBy] = $(this).find('.js-sort-order').val();\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn sortData;\n\t\t},\n\t\t/**\n\t\t * Gets basic container\n\t\t */\n\t\tgetSourceContainer: function () {\n\t\t\treturn $('[data-modalid=' + this.source + ']').closest(\n\t\t\t\t'.listViewContentDiv,.relatedContainer,.js-main-container'\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * Register modal events\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.container = modalContainer;\n\t\t\tthis.source = modalContainer.closest('.js-modal-container').attr('id');\n\t\t\tthis.sourceContainer = this.getSourceContainer();\n\t\t\tthis.registerListEvents();\n\t\t\tthis.loadData();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","sourceContainer","source","loadData","orderBy","find","val","JSON","parse","Object","keys","length","field","baseOrderBy","element","addRow","change","sortIcon","data","trigger","clone","removeClass","append","sortContainer","App","Fields","Picklist","showSelect2ElementView","registerListEvents","on","e","currentTarget","closest","remove","toggleClass","preventDefault","orderby","getSortData","app","hideModalWindow","sortData","each","getSourceContainer","registerEvents","modalContainer","attr"],"mappings":"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"}