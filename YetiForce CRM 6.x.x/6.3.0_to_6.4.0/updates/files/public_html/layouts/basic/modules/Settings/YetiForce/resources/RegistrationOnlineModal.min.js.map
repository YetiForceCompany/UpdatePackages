{"version":3,"file":"RegistrationOnlineModal.min.js","sources":["RegistrationOnlineModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n/**\n * Class Settings_YetiForce_RegistrationOnlineModal_Js.\n * @type {window.Settings_YetiForce_RegistrationOnlineModal_Js}\n */\nwindow.Settings_YetiForce_RegistrationOnlineModal_Js = class Settings_YetiForce_RegistrationOnlineModal_Js {\n\t/**\n\t * Register events for form checkbox element\n\t * @param {jQuery} modalContainer\n\t */\n\tregisterNewsletter(modalContainer) {\n\t\tmodalContainer\n\t\t\t.find('form')\n\t\t\t.find('[id$=\"newsletter\"]')\n\t\t\t.on('click', (e) => {\n\t\t\t\tlet inputsContainer = $(e.target).closest('.js-card-body');\n\t\t\t\tif ($(e.target).prop('checked')) {\n\t\t\t\t\tinputsContainer.find('[id$=\"firstname]\"]').attr('data-validation-engine', 'validate[required]');\n\t\t\t\t\tinputsContainer.find('[id$=\"lastname]\"]').attr('data-validation-engine', 'validate[required]');\n\t\t\t\t\tinputsContainer.find('[id$=\"email]\"]').attr('data-validation-engine', 'validate[required,custom[email]]');\n\t\t\t\t\tinputsContainer.find('.js-newsletter-content').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tinputsContainer.find('[id$=\"firstname]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('[id$=\"lastname]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('[id$=\"email]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('.js-newsletter-content').addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t}\n\t/**\n\t * Get companies from form\n\t * @param {jQuery} form\n\t * @returns {array}\n\t */\n\tgetCompanies(form) {\n\t\tlet companies = [];\n\t\tform.each(function () {\n\t\t\tcompanies.push($(this).serializeFormData());\n\t\t});\n\t\treturn companies;\n\t}\n\t/**\n\t * Register events.\n\t * @param {jQuery} modalContainer\n\t */\n\tregisterEvents(modalContainer) {\n\t\tconst self = this,\n\t\t\tform = modalContainer.find('form');\n\t\tform.validationEngine(app.validationEngineOptions);\n\t\tform.on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t\tmodalContainer.find('[name=\"saveButton\"]').click();\n\t\t});\n\t\tmodalContainer.find('[name=\"saveButton\"]').on('click', function (e) {\n\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\te.preventDefault();\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttext: app.vtranslate('JS_ENTER_ALL_REGISTRATION_DATA'),\n\t\t\t\t\ttype: 'error'\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tmodalContainer.find('button[name=saveButton]').prop('disabled', true);\n\t\t\tlet progress = $.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_LOADING_PLEASE_WAIT'),\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'YetiForce',\n\t\t\t\tparent: 'Settings',\n\t\t\t\taction: 'Register',\n\t\t\t\tmode: 'online',\n\t\t\t\tcompanies: self.getCompanies(form)\n\t\t\t})\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: data['result']['message'],\n\t\t\t\t\t\ttype: data['result']['type']\n\t\t\t\t\t});\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tif (data['result']['type'] === 'success') {\n\t\t\t\t\t\tlet href = location.href.replace('displayModal=online', '');\n\t\t\t\t\t\tlocation.replace(href);\n\t\t\t\t\t}\n\t\t\t\t\tmodalContainer.find('button[name=saveButton]').prop('disabled', false);\n\t\t\t\t\treturn data['result'];\n\t\t\t\t})\n\t\t\t\t.fail(function () {\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t});\n\t\tthis.registerNewsletter(modalContainer);\n\t}\n};\n"],"names":["window","Settings_YetiForce_RegistrationOnlineModal_Js","modalContainer","find","on","e","$","target","closest","prop","inputsContainer","attr","removeClass","removeAttr","val","addClass","form","companies","each","push","serializeFormData","self","validationEngine","app","validationEngineOptions","preventDefault","click","showNotify","text","vtranslate","type","progress","progressIndicator","message","blockInfo","enabled","AppConnector","request","module","parent","action","mode","getCompanies","done","data","location","href","replace","fail","registerNewsletter"],"mappings":"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"}