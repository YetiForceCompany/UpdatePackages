{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\n\t'Accounts_Detail_Js',\n\t{},\n\t{\n\t\t//It stores the Account Hierarchy response data\n\t\taccountHierarchyResponseCache: {},\n\t\t/**\n\t\t * function to get the AccountHierarchy response data\n\t\t * @returns {Promise}\n\t\t */\n\t\tgetAccountHierarchyResponseData: function (params) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar aDeferred = jQuery.Deferred();\n\n\t\t\t//Check in the cache\n\t\t\tif (!jQuery.isEmptyObject(thisInstance.accountHierarchyResponseCache)) {\n\t\t\t\taDeferred.resolve(thisInstance.accountHierarchyResponseCache);\n\t\t\t} else {\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t//store it in the cache, so that we dont do multiple request\n\t\t\t\t\tthisInstance.accountHierarchyResponseCache = data;\n\t\t\t\t\taDeferred.resolve(thisInstance.accountHierarchyResponseCache);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\n\t\t/*\n\t\t * function to display the AccountHierarchy response data\n\t\t */\n\t\tdisplayAccountHierarchyResponseData: function (data) {\n\t\t\tlet callbackFunction = function () {\n\t\t\t\tapp.showScrollBar($('#hierarchyScroll'), {\n\t\t\t\t\theight: '300px',\n\t\t\t\t\trailVisible: true,\n\t\t\t\t\tsize: '6px'\n\t\t\t\t});\n\t\t\t};\n\t\t\tapp.showModalWindow(data, function (modalContainer) {\n\t\t\t\tApp.Components.Scrollbar.xy($('#hierarchyScroll', modalContainer));\n\t\t\t\tif (typeof callbackFunction == 'function' && $('#hierarchyScroll', modalContainer).height() > 300) {\n\t\t\t\t\tcallbackFunction();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tregisterHierarchyRecordCount: function () {\n\t\t\tvar hierarchyButton = $('.detailViewTitle .hierarchy');\n\t\t\tif (hierarchyButton.length) {\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\tmode: 'getHierarchyCount'\n\t\t\t\t};\n\t\t\t\tAppConnector.request(params).done(function (response) {\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t$('.detailViewTitle .hierarchy .badge').html(response.result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tregisterShowHierarchy: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar hierarchyButton = $('.detailViewTitle');\n\t\t\tvar url = 'index.php?module=Accounts&view=AccountHierarchy&record=' + app.getRecordId();\n\t\t\thierarchyButton.on('click', '.js-detail__icon, .recordLabelValue', function (e) {\n\t\t\t\tthisInstance.getAccountHierarchyResponseData(url).done(function (data) {\n\t\t\t\t\tthisInstance.displayAccountHierarchyResponseData(data);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerHierarchyRecordCount();\n\t\t\tthis.registerShowHierarchy();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","accountHierarchyResponseCache","getAccountHierarchyResponseData","params","thisInstance","aDeferred","jQuery","Deferred","isEmptyObject","AppConnector","request","done","data","resolve","promise","displayAccountHierarchyResponseData","callbackFunction","app","showScrollBar","$","height","railVisible","size","showModalWindow","modalContainer","App","Components","Scrollbar","xy","registerHierarchyRecordCount","hierarchyButton","length","module","getModuleName","action","record","getRecordId","mode","response","success","html","result","registerShowHierarchy","url","on","registerEvents","_super"],"mappings":"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"}