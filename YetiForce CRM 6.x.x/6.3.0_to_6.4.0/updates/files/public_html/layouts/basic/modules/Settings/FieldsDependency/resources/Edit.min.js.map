{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/**\n * Fields dependency edit view js class\n *\n * @package     Settings.Edit\n *\n * @description Fields dependency edit view scripts\n * @license     YetiForce Public License 5.0\n * @author      Mariusz Krzaczkowski <m.krzaczkowski@yetiforce.com>\n */\n'use strict';\n\n$.Class(\n\t'Settings_FieldsDependency_Edit_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Register submit event\n\t\t */\n\t\tregisterSubmitEvent() {\n\t\t\tthis.container.off('submit').on('submit', (e) => {\n\t\t\t\tif ($(e.currentTarget).validationEngine('validate')) {\n\t\t\t\t\tthis.container.find('input[name=\"conditions\"]').val(JSON.stringify(this.conditionBuilder.getConditions()));\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Load condition builder\n\t\t */\n\t\tloadConditionBuilderView() {\n\t\t\tthis.conditionBuilder = new Vtiger_ConditionBuilder_Js(\n\t\t\t\tthis.container.find('.js-condition-builder'),\n\t\t\t\tthis.sourceModule\n\t\t\t);\n\t\t\tthis.conditionBuilder.registerEvents();\n\t\t},\n\t\t/**\n\t\t * Register source module change\n\t\t */\n\t\tregisterSourceModuleChange() {\n\t\t\tlet select = this.container.find('#inputSourceModule');\n\t\t\tlet blocks = this.container.find('.js-dynamic-blocks');\n\t\t\tselect.on('change', (e) => {\n\t\t\t\tthis.sourceModule = select.find('option:selected').data('module');\n\t\t\t\tblocks.html('');\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tview: 'Edit',\n\t\t\t\t\tmode: 'dynamic',\n\t\t\t\t\tselectedModule: this.sourceModule\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tblocks.html(data);\n\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(blocks);\n\t\t\t\t\tthis.loadConditionBuilderView();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterAddDependField() {\n\t\t\tthis.container.find('.js-dependence-add-field').on('click', (e) => {\n\t\t\t\tlet progress = $.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.sourceModule = select.find('option:selected').data('module');\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tview: 'FieldDependence',\n\t\t\t\t\tmode: 'dependencyRow',\n\t\t\t\t\tselectedModule: this.sourceModule\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tblocks.html(data);\n\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(blocks);\n\t\t\t\t\tthis.loadConditionBuilderView();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents() {\n\t\t\tthis.container = $('#EditView');\n\t\t\tthis.sourceModule = this.container.find('#inputSourceModule').data('module');\n\t\t\tthis.record = this.container.find('input[name=\"record\"]').val();\n\t\t\tthis.registerSourceModuleChange();\n\t\t\tthis.loadConditionBuilderView();\n\t\t\tthis.registerSubmitEvent();\n\t\t\tthis.registerAddDependField();\n\t\t\tthis.container.validationEngine(app.validationEngineOptions);\n\t\t}\n\t}\n);\n"],"names":["$","Class","registerSubmitEvent","container","off","on","e","currentTarget","validationEngine","find","val","JSON","stringify","conditionBuilder","getConditions","preventDefault","stopPropagation","loadConditionBuilderView","sourceModule","registerEvents","registerSourceModuleChange","select","blocks","data","html","AppConnector","request","module","app","getModuleName","parent","getParentModuleName","view","mode","selectedModule","done","App","Fields","Picklist","changeSelectElementView","registerAddDependField","progress","progressIndicator","position","blockInfo","enabled","record","validationEngineOptions"],"mappings":"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"}