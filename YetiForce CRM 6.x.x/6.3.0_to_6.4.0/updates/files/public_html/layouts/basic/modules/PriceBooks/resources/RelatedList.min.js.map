{"version":3,"file":"RelatedList.min.js","sources":["RelatedList.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_RelatedList_Js(\n\t'PriceBooks_RelatedList_Js',\n\t{\n\t\ttriggerMassMargin: function () {\n\t\t\tconst self = Vtiger_RelatedList_Js.relatedListInstance;\n\t\t\tlet selected_ids = self.readSelectedIds(true),\n\t\t\t\texcluded_ids = self.readExcludedIds(true);\n\t\t\tif (self.checkListRecordSelected() !== true) {\n\t\t\t\tapp.showModalWindow({\n\t\t\t\t\turl: 'index.php?module=PriceBooks&view=SpecifyMargin',\n\t\t\t\t\tcb: (modalContainer) => {\n\t\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', (e) => {\n\t\t\t\t\t\t\tlet element = modalContainer.find('.js-margin');\n\t\t\t\t\t\t\tlet resultOfValidation = Vtiger_NumberUserFormat_Validator_Js.invokeValidation(element);\n\t\t\t\t\t\t\tif (typeof resultOfValidation !== 'undefined') {\n\t\t\t\t\t\t\t\telement.validationEngine('showPrompt', resultOfValidation, '', 'topLeft', true);\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telement.validationEngine('hideAll');\n\t\t\t\t\t\t\t\tlet postData = self.getCompleteParams();\n\t\t\t\t\t\t\t\tdelete postData.view;\n\t\t\t\t\t\t\t\tpostData.selected_ids = selected_ids;\n\t\t\t\t\t\t\t\tpostData.excluded_ids = excluded_ids;\n\t\t\t\t\t\t\t\tpostData.mode = 'specifyMargin';\n\t\t\t\t\t\t\t\tpostData.action = 'RelationAjax';\n\t\t\t\t\t\t\t\tpostData.relatedModule = self.moduleName;\n\t\t\t\t\t\t\t\tpostData.record = self.getParentId();\n\t\t\t\t\t\t\t\tpostData.margin = element.val();\n\t\t\t\t\t\t\t\tAppConnector.request(postData).done((response) => {\n\t\t\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\t\t\tVtiger_Detail_Js.reloadRelatedList();\n\t\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tself.noRecordSelectedAlert();\n\t\t\t}\n\t\t}\n\t},\n\t{\n\t\tregisterEditListPrice: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet element = this.content.find('.js-edit-listprice');\n\t\t\telement.validationEngine(app.validationEngineOptions);\n\t\t\telement.on('change', (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber();\n\t\t\t\tif (!element.validationEngine('validate')) {\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\tmodule: thisInstance.parentModuleName,\n\t\t\t\t\t\trecord: element.closest('.js-list__row').data('id'),\n\t\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\t\tmode: 'addListPrice',\n\t\t\t\t\t\tsrc_record: thisInstance.parentRecordId,\n\t\t\t\t\t\trelated_module: thisInstance.moduleName,\n\t\t\t\t\t\tprice: element.val()\n\t\t\t\t\t}).done(function (responseData) {\n\t\t\t\t\t\tif (responseData.result) {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterPostLoadEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerEditListPrice();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_RelatedList_Js","triggerMassMargin","relatedListInstance","selected_ids","self","readSelectedIds","excluded_ids","readExcludedIds","checkListRecordSelected","noRecordSelectedAlert","app","showModalWindow","url","cb","modalContainer","find","on","e","resultOfValidation","Vtiger_NumberUserFormat_Validator_Js","invokeValidation","element","validationEngine","preventDefault","getCompleteParams","view","postData","mode","action","relatedModule","moduleName","record","getParentId","margin","val","AppConnector","request","done","response","success","Vtiger_Detail_Js","reloadRelatedList","hideModalWindow","registerEditListPrice","content","validationEngineOptions","stopPropagation","$","currentTarget","formatNumber","module","thisInstance","parentModuleName","closest","data","src_record","parentRecordId","related_module","price","responseData","result","showNotify","text","vtranslate","type","registerPostLoadEvents","_super"],"mappings":"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"}