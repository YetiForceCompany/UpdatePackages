'use strict';

/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */"use strict";Settings_Vtiger_Index_Js("Settings_Kanban_Index_Js",{},{/**
		 * Register add modal
		 */registerAddModal:function registerAddModal(){var _this=this;$(".js-add-board").on("click",function(){app.showModalWindow(null,"index.php?module=Kanban&parent=Settings&view=AddModal&sourceModule="+_this.module,function(modalContainer){modalContainer.find(".js-modal__save").on("click",function(){AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"Save",mode:"add",field:modalContainer.find(".js-system-fields").val()}).done(function(data){data.result.message&&(app.hideModalWindow(),window.location.reload());}).fail(function(error,err){app.errorLog(error,err);});});});});},/**
		 * Register delete event
		 */registerDeleteEvent:function registerDeleteEvent(){this.container.find(".js-delete").on("click",function(e){var board=$(e.currentTarget).closest(".js-board");AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"Save",mode:"delete",board:board.data("id")}).done(function(data){data.result.message&&window.location.reload();}).fail(function(error,err){app.errorLog(error,err);});});},/**
		 * Register add modal
		 */registerFieldsEvents:function registerFieldsEvents(){var _this2=this,fields=this.container.find(".js-sortable-fields");fields.on("sortable:change",function(e){_this2.saveField($(e.currentTarget));}),fields.on("change",function(e){_this2.saveField($(e.currentTarget));});var boards=this.container.find(".js-boards");boards.sortable({containment:boards,items:boards.find(".js-board"),handle:".js-drag",revert:!0,tolerance:"pointer",cursor:"move",update:function update(){_this2.saveSequence();}});},/**
		 * Save field
		 */saveField:function saveField(element){var board=element.closest(".js-board");AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"Save",mode:"update",board:board.data("id"),type:element.data("type"),value:element.val()}).done(function(data){data.result.message&&app.showNotify(data.result.message);}).fail(function(){app.showNotify({text:app.vtranslate("JS_UNEXPECTED_ERROR"),type:"error"});});},/**
		 * Save sequence
		 */saveSequence:function saveSequence(){var boards=[];this.container.find(".js-board").each(function(index){boards[index]=$(this).data("id");}),AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),sourceModule:this.module,action:"Save",mode:"sequence",boards:boards}).done(function(data){data.result.message&&app.showNotify(data.result.message);}).fail(function(){app.showNotify({text:app.vtranslate("JS_UNEXPECTED_ERROR"),type:"error"});});},/**
		 * Register module change
		 */registerModuleEvents:function registerModuleEvents(){$(".js-module-list").on("change",function(e){window.location.href="index.php?module=Kanban&parent=Settings&view=Index&sourceModule="+$(e.currentTarget).val();});},/**
		 * Register events
		 */registerEvents:function registerEvents(){this._super(),this.module=$("#js-module-name").val(),this.container=$(".js-fields-list"),this.registerAddModal(),this.registerDeleteEvent(),this.registerFieldsEvents(),this.registerModuleEvents();}});
//# sourceMappingURL=Index.min.js.map
