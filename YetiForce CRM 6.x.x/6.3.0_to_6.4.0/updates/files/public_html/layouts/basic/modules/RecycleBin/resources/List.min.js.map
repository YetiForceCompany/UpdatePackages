{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_List_Js(\n\t'RecycleBin_List_Js',\n\t{\n\t\t/**\n\t\t * Mass activation trigerred on the list\n\t\t */\n\t\tmassActivation: function () {\n\t\t\tconst self = this;\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_MASS_ACTIVATE'),\n\t\t\t\ttext: app.vtranslate('JS_ACTIVATE_RECORD_DESC'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\t\tparams.state = 'Active';\n\t\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\t\tparams.action = 'MassState';\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Mass delete trigerred on the list\n\t\t */\n\t\tmassDelete: function () {\n\t\t\tconst self = this;\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_MASS_DELETE'),\n\t\t\t\ttext: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\t\tparams.sourceModule = container.find('.js-source-module').val();\n\t\t\t\t\tparams.action = 'MassDelete';\n\t\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\t\tparams.viewname = 'undefined';\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t/**\n\t\t * Register module select\n\t\t */\n\t\tregisterModuleFilter: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tlet filterSelectElement = container.find('.js-source-module');\n\t\t\tfilterSelectElement.on('select2:selecting', function (e) {\n\t\t\t\tself\n\t\t\t\t\t.getListViewRecords({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\tsourceModule: e.params.args.data.id\n\t\t\t\t\t})\n\t\t\t\t\t.done(function () {\n\t\t\t\t\t\tself.calculatePages().done(function () {\n\t\t\t\t\t\t\tcontainer.find('.js-pagination-list').data('totalCount', 0);\n\t\t\t\t\t\t\tself.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to update pagination page numer\n\t\t * @param {boolean} force\n\t\t */\n\t\tupdatePaginationAjax(force = false) {\n\t\t\tconst self = this,\n\t\t\t\tlistViewPageDiv = this.getListViewContainer();\n\t\t\tlet params = self.getDefaultParams(),\n\t\t\t\tcontainer = listViewPageDiv.find('.paginationDiv');\n\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\ttext: app.vtranslate('JS_GET_PAGINATION_INFO'),\n\t\t\t\ttype: 'info'\n\t\t\t});\n\t\t\tif (container.find('.js-pagination-list').data('total-count') > 0 || force) {\n\t\t\t\tparams.totalCount = '-1';\n\t\t\t\tparams.view = 'Pagination';\n\t\t\t\tparams.mode = 'getPagination';\n\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\tparams.module = listViewPageDiv.find('.js-source-module').val();\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tcontainer.html(data);\n\t\t\t\t\tself.registerPageNavigationEvents();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Register empty recycle button\n\t\t */\n\t\tregisterEmptyRecycle: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tcontainer.find('.js-recycle-empty').on('click', function () {\n\t\t\t\tapp.showConfirmModal({\n\t\t\t\t\ttitle: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD'),\n\t\t\t\t\ttext: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'RecycleBin',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val(),\n\t\t\t\t\t\t\taction: 'MassDeleteAll',\n\t\t\t\t\t\t\tsourceView: 'List'\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\tlet result = {\n\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_FAILED_TO_SAVE')\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tif (data && data.result) {\n\t\t\t\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ADDED_TO_QUEUE'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(result);\n\t\t\t\t\t\t\t\tself.getListViewRecords();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Get record list of actual selected module\n\t\t * @param {string} urlParams\n\t\t * @returns {*|jQuery}\n\t\t */\n\t\tgetListViewRecords: function (urlParams) {\n\t\t\tlet overrideUrlParams = {},\n\t\t\t\taDeferred = $.Deferred();\n\t\t\toverrideUrlParams.sourceModule = $('.js-source-module').val();\n\t\t\turlParams = $.extend(overrideUrlParams, urlParams);\n\t\t\tthis._super(urlParams)\n\t\t\t\t.done(function () {\n\t\t\t\t\taDeferred.resolve();\n\t\t\t\t})\n\t\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tgetDefaultParams: function () {\n\t\t\tlet params = this._super();\n\t\t\tparams.module = $('.js-source-module').val();\n\t\t\tparams.entityState = 'Trash';\n\t\t\treturn params;\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerModuleFilter();\n\t\t\tthis.registerEmptyRecycle();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","massActivation","app","showConfirmModal","title","vtranslate","text","confirmedCallback","params","self","getSelectedRecordsParams","listInstance","getInstance","container","getListViewContainer","module","find","val","state","entityState","action","AppConnector","request","done","data","result","notify","Vtiger_Helper_Js","showMessage","getListViewRecords","getModuleName","view","sourceModule","massDelete","viewname","registerModuleFilter","filterSelectElement","on","e","args","id","calculatePages","updatePagination","updatePaginationAjax","force","listViewPageDiv","getDefaultParams","type","totalCount","mode","html","registerPageNavigationEvents","registerEmptyRecycle","$","progressIndicator","sourceView","progressIndicatorElement","fail","urlParams","overrideUrlParams","aDeferred","Deferred","extend","_super","resolve","textStatus","errorThrown","reject","promise","registerEvents"],"mappings":"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"}