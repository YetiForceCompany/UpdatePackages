{"version":3,"file":"BasicSearch.min.js","sources":["BasicSearch.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\n\t'Vtiger_BasicSearch_Js',\n\t{},\n\t{\n\t\t//stores the module that need to be searched\n\t\tsearchModule: false,\n\t\t//stores the module that need to be searched which is selected by the user\n\t\tcurrentSearchModule: false,\n\t\t// reduce the number of results\n\t\treduceNumberResults: false,\n\t\t// Should the result be in html\n\t\treturnHtml: true,\n\t\t// Main container with modules, value and buttons\n\t\tmainContainer: false,\n\t\t/**\n\t\t * Function to get the search module\n\t\t */\n\t\tgetSearchModule: function () {\n\t\t\tif (this.searchModule === false) {\n\t\t\t\t//default gives current module\n\t\t\t\tlet module = app.getModuleName();\n\t\t\t\tif (typeof this.getCurrentSearchModule() !== 'undefined') {\n\t\t\t\t\tmodule = this.getCurrentSearchModule();\n\t\t\t\t}\n\n\t\t\t\tthis.setSearchModule(module);\n\t\t\t}\n\t\t\treturn this.searchModule;\n\t\t},\n\t\t/**\n\t\t * Function to set the search module\n\t\t */\n\t\tsetSearchModule: function (moduleName) {\n\t\t\tthis.searchModule = moduleName;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to set main conatainer\n\t\t */\n\t\tsetMainContainer: function (container) {\n\t\t\tthis.mainContainer = container;\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * Function to get the user selected search module\n\t\t */\n\t\tgetCurrentSearchModule: function () {\n\t\t\tif (this.currentSearchModule === false && this.mainContainer) {\n\t\t\t\tthis.currentSearchModule = this.mainContainer.find('.basicSearchModulesList').val();\n\t\t\t}\n\t\t\treturn this.currentSearchModule;\n\t\t},\n\t\t/**\n\t\t * Function which will perform the search\n\t\t */\n\t\t_search: function (params) {\n\t\t\tlet aDeferred = jQuery.Deferred();\n\t\t\tif (typeof params === 'undefined') {\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tif (params.searchModule && params.searchModule !== '-') {\n\t\t\t\tparams.module = params.searchModule;\n\t\t\t} else {\n\t\t\t\tparams.module = app.getModuleName();\n\t\t\t}\n\t\t\tparams.view = 'BasicAjax';\n\t\t\tparams.mode = 'showSearchResults';\n\t\t\tparams.limit = this.reduceNumberResults;\n\t\t\tparams.html = this.returnHtml;\n\t\t\tif (app.getParentModuleName()) {\n\t\t\t\tparams.parent = app.getParentModuleName();\n\t\t\t}\n\t\t\tparams.operator = CONFIG.globalSearchDefaultOperator;\n\t\t\tif (this.mainContainer) {\n\t\t\t\tlet operatorElement = this.mainContainer.find('.js-global-search-operator .active[data-operator]');\n\t\t\t\tif (operatorElement.length && operatorElement.data('operator') != '') {\n\t\t\t\t\tparams.operator = operatorElement.data('operator');\n\t\t\t\t}\n\t\t\t}\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function (data) {\n\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t})\n\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\taDeferred.reject(error);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Helper function whicn invokes search\n\t\t */\n\t\tsearch: function (value) {\n\t\t\tlet searchModule = this.getCurrentSearchModule();\n\t\t\tlet params = {};\n\t\t\tparams.value = value;\n\t\t\tif (typeof searchModule !== 'undefined' && searchModule !== false) {\n\t\t\t\tparams.searchModule = searchModule;\n\t\t\t} else if (this.searchModule) {\n\t\t\t\tparams.searchModule = this.searchModule;\n\t\t\t}\n\t\t\treturn this._search(params);\n\t\t},\n\t\t/**\n\t\t * Function which shows the search results\n\t\t */\n\t\tshowSearchResults: function (data) {\n\t\t\tlet aDeferred = jQuery.Deferred();\n\t\t\tlet postLoad = function (data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t};\n\t\t\tlet params = {};\n\t\t\tparams.data = data;\n\t\t\tparams.cb = postLoad;\n\t\t\tapp.showModalWindow(params);\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","searchModule","currentSearchModule","reduceNumberResults","returnHtml","mainContainer","getSearchModule","app","getModuleName","getCurrentSearchModule","module","setSearchModule","moduleName","setMainContainer","container","find","val","_search","params","Deferred","view","mode","limit","html","getParentModuleName","parent","operator","CONFIG","globalSearchDefaultOperator","operatorElement","length","data","request","done","aDeferred","resolve","fail","error","reject","promise","search","value","showSearchResults","cb","postLoad","showModalWindow"],"mappings":"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"}