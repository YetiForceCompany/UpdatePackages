'use strict';

/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */"use strict";jQuery.Class("Settings_MarketingProcesses_Index_Js",{},{registerChangeVal:function registerChangeVal(content){content.find(".configField").on("change",function(e){var val,target=$(e.currentTarget);val="checkbox"===target.attr("type")?this.checked:null==target.val()?"":target.val(),AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:"updateConfig",type:target.data("type"),param:target.attr("name"),value:val}).done(function(data){Settings_Vtiger_Index_Js.showMessage({type:"success",text:data.result.message});});});},registerSaveMapping:function registerSaveMapping(content){var thisInstance=this;content.find("button.saveMapping").on("click",function(){var mapping=[];jQuery("#convertLeadMapping tr.listViewEntries:not(.d-none)").each(function(){var leadName=jQuery(this).find("select.leadsFields").val(),accountName=jQuery(this).find("select.accountsFields").val(),relations=[];relations[leadName]=accountName,relations=jQuery.extend({},relations),thisInstance.uniqueReduce(mapping,relations)&&mapping.push(relations);}),mapping.length?jQuery("[name=\"mapping\"]").val(JSON.stringify(mapping)).change():Settings_Vtiger_Index_Js.showMessage({type:"info",text:app.vtranslate("JS_NO_CONDITIONS")});});},uniqueReduce:function uniqueReduce(mapping,relations){for(var key in mapping)if(JSON.stringify(mapping[key])===JSON.stringify(relations))return !1;return !0},registerEventToDeleteMapping:function registerEventToDeleteMapping(content){content.find(".deleteMapping").on("click",function(e){var element=jQuery(e.currentTarget),trContainer=element.closest("tr");trContainer.remove();});},registerMapping:function registerMapping(content){content.find("[name=\"create_always\"]").on("change",function(){var mappingTable=jQuery(".mappingTable");this.checked?mappingTable.removeClass("d-none"):mappingTable.addClass("d-none");});},registerEvents:function registerEvents(){var content=$("#supportProcessesContainer");this.registerChangeVal(content),this.registerSaveMapping(content),this.registerMapping(content),this.registerEventToDeleteMapping(content);var instance=new Settings_LeadMapping_Js;instance.registerEventForAddingNewMapping();}});
//# sourceMappingURL=Index.min.js.map
