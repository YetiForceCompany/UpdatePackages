{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_List_Js(\n\t'Settings_Vtiger_List_Js',\n\t{\n\t\ttriggerDelete: function (event, url) {\n\t\t\tevent.stopPropagation();\n\t\t\tvar instance = Vtiger_List_Js.getInstance();\n\t\t\tinstance.DeleteRecord(url);\n\t\t},\n\t\t/**\n\t\t * Make delete request\n\t\t *\n\t\t * @param   {object}  params\n\t\t * @param   {jQuery.Deferred}  aDeferred\n\t\t * @param   {Vtiger_List_Js}  instance\n\t\t */\n\t\tmakeDeleteRequest(params, aDeferred, instance) {\n\t\t\tAppConnector.request(params).done((data) => {\n\t\t\t\tlet response = data.result;\n\t\t\t\tif (response && response.success) {\n\t\t\t\t\t$('#recordsCount').val('');\n\t\t\t\t\t$('#totalPageCount').text('');\n\t\t\t\t\tinstance.getListViewRecords().done(() => {\n\t\t\t\t\t\tinstance.updatePagination();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Delete by id\n\t\t *\n\t\t * @param   {number}  id\n\t\t * @param   {bool}  showConfirmation\n\t\t *\n\t\t * @return  {jQuery.Deferred}\n\t\t */\n\t\tdeleteById(id, showConfirmation = true) {\n\t\t\tconst aDeferred = jQuery.Deferred();\n\t\t\tconst instance = Vtiger_List_Js.getInstance();\n\t\t\tconst params = $.extend(instance.getDeleteParams(), {\n\t\t\t\trecord: id\n\t\t\t});\n\t\t\tif (showConfirmation) {\n\t\t\t\tapp.showConfirmModal({\n\t\t\t\t\ttitle: app.vtranslate('JS_DELETE_RECORD_CONFIRMATION'),\n\t\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\t\tthis.makeDeleteRequest(params, aDeferred, instance);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.makeDeleteRequest(params, aDeferred, instance);\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t},\n\t{\n\t\tgetDeleteParams: function () {\n\t\t\treturn {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'DeleteAjax'\n\t\t\t};\n\t\t},\n\t\t/*\n\t\t * Function to register the list view container\n\t\t */\n\t\tgetListViewContainer() {\n\t\t\tif (this.listViewContainer == false) {\n\t\t\t\tthis.listViewContainer = $('div.contentsDiv');\n\t\t\t}\n\t\t\treturn this.listViewContainer;\n\t\t},\n\n\t\t/*\n\t\t * Function to register the list view delete record click event\n\t\t */\n\t\tDeleteRecord: function (url) {\n\t\t\tvar thisInstance = this;\n\n\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tapp.showModalWindow(data, function (container) {\n\t\t\t\t\t\tthisInstance.postDeleteAction(container);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to load list view after deletion of record from list view\n\t\t */\n\t\tpostDeleteAction: function (container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar deleteConfirmForm = jQuery(container).find('#DeleteModal');\n\t\t\tdeleteConfirmForm.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar deleteActionUrl = deleteConfirmForm.serializeFormData();\n\t\t\t\tAppConnector.request(deleteActionUrl)\n\t\t\t\t\t.done(function () {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_RECORD_DELETED_SUCCESSFULLY')\n\t\t\t\t\t\t};\n\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\tjQuery('#recordsCount').val('');\n\t\t\t\t\t\tjQuery('#totalPageCount').text('');\n\t\t\t\t\t\tthisInstance.getListViewRecords().done(function () {\n\t\t\t\t\t\t\tthisInstance.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to get Page Jump Params\n\t\t */\n\t\tgetPageJumpParams: function () {\n\t\t\tvar module = app.getModuleName();\n\t\t\tvar cvId = this.getCurrentCvId();\n\t\t\tvar pageCountParams = {\n\t\t\t\tmodule: module,\n\t\t\t\tparent: 'Settings',\n\t\t\t\taction: 'ListAjax',\n\t\t\t\tmode: 'getPageCount',\n\t\t\t\tviewname: cvId\n\t\t\t};\n\t\t\tvar sourceModule = jQuery('#moduleFilter').val();\n\t\t\tif (typeof sourceModule !== 'undefined') {\n\t\t\t\tpageCountParams['sourceModule'] = sourceModule;\n\t\t\t}\n\t\t\treturn pageCountParams;\n\t\t},\n\t\t/**\n\t\t * Register button to create record\n\t\t */\n\t\tregisterButtons: function () {\n\t\t\tthis.getListViewContainer().on('click', '.js-add-record-modal, .js-edit-record-modal', (e) => {\n\t\t\t\tapp.showModalWindow({\n\t\t\t\t\turl: e.currentTarget.dataset.url,\n\t\t\t\t\tsendByAjaxCb: () => {\n\t\t\t\t\t\tthis.getListViewRecords();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tthis.registerRowClickEvent();\n\t\t\tthis.registerCheckBoxClickEvent();\n\t\t\tthis.registerHeadersClickEvent();\n\t\t\tthis.registerPageNavigationEvents();\n\t\t\tthis.registerEventForTotalRecordsCount();\n\t\t\tthis.registerButtons();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","triggerDelete","event","url","stopPropagation","instance","getInstance","DeleteRecord","makeDeleteRequest","params","aDeferred","AppConnector","request","done","data","response","result","success","$","val","text","getListViewRecords","updatePagination","app","showNotify","message","vtranslate","type","resolve","deleteById","id","showConfirmation","jQuery","Deferred","extend","getDeleteParams","record","showConfirmModal","title","confirmedCallback","promise","module","getModuleName","parent","getParentModuleName","action","getListViewContainer","listViewContainer","showModalWindow","container","thisInstance","postDeleteAction","deleteConfirmForm","find","on","e","preventDefault","deleteActionUrl","serializeFormData","hideModalWindow","Settings_Vtiger_Index_Js","showMessage","fail","getPageJumpParams","cvId","getCurrentCvId","pageCountParams","mode","viewname","sourceModule","registerButtons","currentTarget","dataset","sendByAjaxCb","registerEvents","registerRowClickEvent","registerCheckBoxClickEvent","registerHeadersClickEvent","registerPageNavigationEvents","registerEventForTotalRecordsCount"],"mappings":"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"}