{"version":3,"file":"DetailPreview.min.js","sources":["DetailPreview.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Vtiger_DetailPreview_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Redirects to the clicked link from the iframe.\n\t\t */\n\t\tregisterLinkEvent: function () {\n\t\t\t$('#page').on('click', 'a', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tlet target = $(this);\n\t\t\t\tif (!target.closest('div').hasClass('fieldValue') || target.hasClass('showReferenceTooltip')) {\n\t\t\t\t\tif (target.attr('href') && target.attr('href') != '#') {\n\t\t\t\t\t\ttop.location.href = target.attr('href');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Redirects to the current iframe parent.\n\t\t */\n\t\tupdateParentFrame: function () {\n\t\t\tparent.app.getPageController().updateWindowHeight($('.mainContainer').height(), $(window.frameElement));\n\t\t},\n\t\t/**\n\t\t * Function sets the correct iframe size.\n\t\t * @param {jQuery} currentHeight - ifrmae body height to be set.\n\t\t * @param {jQuery} frame - ifrmae height to be changed.\n\t\t */\n\t\tupdateWindowHeight: function (currentHeight, frame) {\n\t\t\tlet thisInstance = this;\n\t\t\tlet relatedContents = frame.closest('.relatedContents');\n\t\t\tlet fixedListHeight = relatedContents.find('.js-list-preview--scroll').height();\n\t\t\tframe.height(currentHeight);\n\t\t\tif (fixedListHeight > currentHeight) {\n\t\t\t\tcurrentHeight = fixedListHeight;\n\t\t\t}\n\t\t\trelatedContents\n\t\t\t\t.find('.gutter, .js-list-preview, .js-side-block, .js-list-detail, .recordsListPreview')\n\t\t\t\t.height(currentHeight);\n\n\t\t\tif (window.frameElement) {\n\t\t\t\tthisInstance.updateParentFrame();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Creates ResizeSensor, which detects size changes.\n\t\t */\n\t\tregisterSizeEvent: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tnew ResizeSensor($('.mainContainer'), function () {\n\t\t\t\tthisInstance.updateParentFrame();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register detail events\n\t\t */\n\t\tregisterDetailEvent: function () {\n\t\t\tlet moduleClassName = app.getModuleName() + '_Detail_Js',\n\t\t\t\tparent = false;\n\t\t\tif (typeof window[moduleClassName] === 'undefined') {\n\t\t\t\tmoduleClassName = 'Vtiger_Detail_Js';\n\t\t\t}\n\t\t\tif (typeof window[moduleClassName] !== 'undefined') {\n\t\t\t\tif (typeof window[moduleClassName] === 'function') {\n\t\t\t\t\tparent = new window[moduleClassName]();\n\t\t\t\t}\n\t\t\t\tif (typeof window[moduleClassName] === 'object') {\n\t\t\t\t\tparent = window[moduleClassName];\n\t\t\t\t}\n\t\t\t\tif (parent) {\n\t\t\t\t\tparent.registerEvents();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tupdateChatConfig() {\n\t\t\tif (window.parent.vuexStore && window.ChatModalVueComponent) {\n\t\t\t\twindow.parent.vuexStore.commit('Chat/setDetailPreview', {\n\t\t\t\t\tid: window.app.getRecordId(),\n\t\t\t\t\tmodule: window.app.getModuleName()\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Registers DetailPreview events.\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tthis.registerDetailEvent();\n\t\t\tthis.registerLinkEvent();\n\t\t\tthis.registerSizeEvent();\n\t\t\tthis.updateChatConfig();\n\t\t}\n\t}\n);\n"],"names":["$","Class","registerLinkEvent","on","e","preventDefault","target","closest","hasClass","attr","top","location","href","updateParentFrame","parent","app","getPageController","updateWindowHeight","height","window","frameElement","currentHeight","frame","relatedContents","fixedListHeight","find","thisInstance","registerSizeEvent","ResizeSensor","registerDetailEvent","getModuleName","moduleClassName","registerEvents","updateChatConfig","vuexStore","ChatModalVueComponent","commit","id","getRecordId","module"],"mappings":"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"}