{"version":3,"file":"LogsOwasp.min.js","sources":["LogsOwasp.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nSettings_Vtiger_Index_Js(\n\t'Settings_Log_LogsOwasp_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Get data from server\n\t\t *\n\t\t * @param {function} callback\n\t\t */\n\t\tgetData(callback) {\n\t\t\tconst progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request({\n\t\t\t\turl: 'index.php',\n\t\t\t\ttype: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\tmodule: 'Log',\n\t\t\t\t\tparent: 'Settings',\n\t\t\t\t\taction: 'LogsOwasp',\n\t\t\t\t\ttype: this.container.find('.nav .active').data('type'),\n\t\t\t\t\trange: this.container.find('.js-date-range-filter').val()\n\t\t\t\t}\n\t\t\t}).done((response) => {\n\t\t\t\tconst columns = [],\n\t\t\t\t\tdata = [];\n\t\t\t\tfor (let key in response.columns) {\n\t\t\t\t\tconst render = key === 'url' || key === 'request' ? (data) => data : $.fn.dataTable.render.text();\n\t\t\t\t\tcolumns.push({\n\t\t\t\t\t\ttitle: response.columns[key],\n\t\t\t\t\t\tname: key,\n\t\t\t\t\t\tdata: key,\n\t\t\t\t\t\trender\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tfor (let key in response.data) {\n\t\t\t\t\tlet row = response.data[key];\n\t\t\t\t\tif (typeof row.url !== 'undefined') {\n\t\t\t\t\t\tconst original = row.url;\n\t\t\t\t\t\tif (row.url.indexOf('?') === -1) {\n\t\t\t\t\t\t\trow.url = 'index.php?' + row.url;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trow.url = `<a href=\"${row.url}\" title=\"${\n\t\t\t\t\t\t\tresponse.columns['url']\n\t\t\t\t\t\t}\" data-content=\"${original}\" class=\"js-popover-tooltip\">${\n\t\t\t\t\t\t\toriginal.length > 50 ? original.substr(0, 50) + '...' : original\n\t\t\t\t\t\t}</a>`;\n\t\t\t\t\t}\n\t\t\t\t\tdata.push(row);\n\t\t\t\t}\n\t\t\t\tcallback(data, columns);\n\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Initialize data table component\n\t\t *\n\t\t * @param {array} data\n\t\t * @param {array} columns\n\t\t * @returns {jQuery}\n\t\t */\n\t\tinitDataTable(data, columns) {\n\t\t\treturn this.container.find('.js-data-table').dataTable({\n\t\t\t\tsearching: false,\n\t\t\t\tprocessing: false,\n\t\t\t\tscrollX: true,\n\t\t\t\tbAutoWidth: false,\n\t\t\t\tdata,\n\t\t\t\tcolumns,\n\t\t\t\tlanguage: {\n\t\t\t\t\tsLengthMenu: app.vtranslate('JS_S_LENGTH_MENU'),\n\t\t\t\t\tsZeroRecords: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfo: app.vtranslate('JS_S_INFO'),\n\t\t\t\t\tsInfoEmpty: app.vtranslate('JS_S_INFO_EMPTY'),\n\t\t\t\t\tsSearch: app.vtranslate('JS_SEARCH'),\n\t\t\t\t\tsEmptyTable: app.vtranslate('JS_NO_RESULTS_FOUND'),\n\t\t\t\t\tsInfoFiltered: app.vtranslate('JS_S_INFO_FILTERED'),\n\t\t\t\t\tsLoadingRecords: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\tsProcessing: app.vtranslate('JS_LOADING_OF_RECORDS'),\n\t\t\t\t\toPaginate: {\n\t\t\t\t\t\tsFirst: app.vtranslate('JS_S_FIRST'),\n\t\t\t\t\t\tsPrevious: app.vtranslate('JS_S_PREVIOUS'),\n\t\t\t\t\t\tsNext: app.vtranslate('JS_S_NEXT'),\n\t\t\t\t\t\tsLast: app.vtranslate('JS_S_LAST')\n\t\t\t\t\t},\n\t\t\t\t\toAria: {\n\t\t\t\t\t\tsSortAscending: app.vtranslate('JS_S_SORT_ASCENDING'),\n\t\t\t\t\t\tsSortDescending: app.vtranslate('JS_S_SORT_DESCENDING')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register data table component\n\t\t */\n\t\tregisterDataTable() {\n\t\t\tApp.Fields.Date.registerRange(this.container.find('.js-log-range'));\n\t\t\tlet table, tableApi;\n\t\t\tthis.getData((data, columns) => {\n\t\t\t\ttable = this.initDataTable(data, columns);\n\t\t\t\ttableApi = table.api();\n\t\t\t});\n\t\t\tthis.container.find('.js-date-range-btn').click((e) => {\n\t\t\t\tthis.getData((data, columns) => {\n\t\t\t\t\ttableApi.data().clear();\n\t\t\t\t\ttableApi.rows.add(data);\n\t\t\t\t\ttableApi.draw();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents() {\n\t\t\tthis._super();\n\t\t\tthis.container = $('.js-log');\n\t\t\tthis.registerDataTable();\n\t\t}\n\t}\n);\n"],"names":["Settings_Vtiger_Index_Js","getData","callback","jQuery","progressIndicator","position","blockInfo","enabled","AppConnector","request","url","type","data","module","parent","action","container","find","range","val","done","response","key","columns","$","fn","dataTable","render","text","push","title","name","original","row","indexOf","length","substr","progressIndicatorElement","mode","initDataTable","searching","processing","scrollX","bAutoWidth","language","sLengthMenu","app","vtranslate","sZeroRecords","sInfo","sInfoEmpty","sSearch","sEmptyTable","sInfoFiltered","sLoadingRecords","sProcessing","oPaginate","sFirst","sPrevious","sNext","sLast","oAria","sSortAscending","sSortDescending","registerDataTable","App","Fields","Date","registerRange","tableApi","table","api","click","clear","rows","add","draw","registerEvents","_super"],"mappings":"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"}