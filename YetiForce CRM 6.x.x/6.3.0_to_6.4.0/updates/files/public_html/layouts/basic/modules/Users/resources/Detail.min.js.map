{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce S.A.\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\n\t'Users_Detail_Js',\n\t{\n\t\t/*\n\t\t * function to trigger delete record action\n\t\t * @params: delete record url.\n\t\t */\n\t\ttriggerDeleteUser: function (deleteUserUrl) {\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_DELETE_USER_CONFIRMATION'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tAppConnector.request(deleteUserUrl).done(function (data) {\n\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\tvar callback = function (data) {\n\t\t\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\t\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\t\t\tUsers_Detail_Js.deleteUser(form);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t$('#deleteUser').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdeleteUser: function (form) {\n\t\t\tvar userid = form.find('[name=\"userid\"]').val();\n\t\t\tvar transferUserId = form.find('[name=\"tranfer_owner_id\"]').val();\n\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'DeleteAjax',\n\t\t\t\tmode: 'deleteUser',\n\t\t\t\ttransfer_user_id: transferUserId,\n\t\t\t\tuserid: userid,\n\t\t\t\tpermanent: form.find('[name=\"deleteUserPermanent\"]:checked').val()\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate(data.result.message),\n\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t});\n\t\t\t\t\tvar url = data.result.listViewUrl;\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttriggerChangeAccessKey: function (url) {\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_NEW_ACCESS_KEY_REQUESTED'),\n\t\t\t\ttext: app.vtranslate('JS_CHANGE_ACCESS_KEY_CONFIRMATION'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\t\t\tlet params = {},\n\t\t\t\t\t\t\tmessage;\n\t\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\t\tdata = data.result;\n\t\t\t\t\t\t\tparams['type'] = 'success';\n\t\t\t\t\t\t\tmessage = app.vtranslate(data.message);\n\t\t\t\t\t\t\tlet accessKeyEle = $('#Users_detailView_fieldValue_accesskey');\n\t\t\t\t\t\t\tif (accessKeyEle.length) {\n\t\t\t\t\t\t\t\taccessKeyEle.find('.value').html(data.accessKey);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmessage = app.vtranslate(data['error']['message']);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparams['text'] = message;\n\t\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\tusersEditInstance: false,\n\t\tupdateStartHourElement: function (form) {\n\t\t\tthis.usersEditInstance.triggerHourFormatChangeEvent(form);\n\t\t\tthis.updateStartHourElementValue();\n\t\t},\n\t\thourFormatUpdateEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.getForm().on(this.fieldUpdatedEvent, '[name=\"hour_format\"]', function (e, params) {\n\t\t\t\tthisInstance.updateStartHourElementValue();\n\t\t\t});\n\t\t},\n\t\tupdateStartHourElementValue: function () {\n\t\t\tvar form = this.getForm();\n\t\t\tvar startHourSelectElement = $('select[name=\"start_hour\"]', form);\n\t\t\tvar selectedElementValue = startHourSelectElement.find('option:selected').text();\n\t\t\tstartHourSelectElement.closest('.fieldValue').find('span.value').text(selectedElementValue);\n\t\t\tvar endHourSelectElement = $('select[name=\"end_hour\"]', form);\n\t\t\tendHourSelectElement\n\t\t\t\t.closest('.fieldValue')\n\t\t\t\t.find('span.value')\n\t\t\t\t.text(endHourSelectElement.find('option:selected').text());\n\t\t},\n\t\tstartHourUpdateEvent: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tform.on(this.fieldUpdatedEvent, '[name=\"start_hour\"]', function (e, params) {\n\t\t\t\tthisInstance.updateStartHourElement(form);\n\t\t\t});\n\t\t},\n\t\tsaveFieldValues: function (fieldDetailList) {\n\t\t\tvar aDeferred = $.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tvar lock = false;\n\t\t\tvar recordId = this.getRecordId();\n\t\t\tvar data = {};\n\t\t\tif (typeof fieldDetailList !== 'undefined') {\n\t\t\t\tdata = fieldDetailList;\n\t\t\t\tif (data['field'] == 'email1') {\n\t\t\t\t\tthisInstance.usersEditInstance.checkEmail(data['value']).done(\n\t\t\t\t\t\tfunction (data) {},\n\t\t\t\t\t\tfunction (data, error) {\n\t\t\t\t\t\t\tlock = true;\n\t\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (lock !== true) {\n\t\t\t\tdata['record'] = recordId;\n\t\t\t\tdata['module'] = app.getModuleName();\n\t\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\t\tvar params = {};\n\t\t\t\tparams.data = data;\n\t\t\t\tparams.async = false;\n\t\t\t\tparams.dataType = 'json';\n\t\t\t\tAppConnector.request(params).done(function (reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tvar form = this.getForm();\n\t\t\tthis.usersEditInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.updateStartHourElement(form);\n\t\t\tthis.hourFormatUpdateEvent();\n\t\t\tthis.startHourUpdateEvent(form);\n\t\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","triggerDeleteUser","deleteUserUrl","app","showConfirmModal","title","vtranslate","confirmedCallback","AppConnector","request","done","data","validationEngineOptions","params","onValidationComplete","form","valid","Users_Detail_Js","deleteUser","$","validationEngine","showModalWindow","callback","find","val","transferUserId","module","getModuleName","action","mode","transfer_user_id","userid","permanent","success","hideModalWindow","showNotify","text","result","message","type","url","listViewUrl","window","location","href","triggerChangeAccessKey","accessKeyEle","length","html","accessKey","usersEditInstance","updateStartHourElement","triggerHourFormatChangeEvent","updateStartHourElementValue","hourFormatUpdateEvent","thisInstance","getForm","on","fieldUpdatedEvent","startHourSelectElement","selectedElementValue","closest","endHourSelectElement","startHourUpdateEvent","saveFieldValues","fieldDetailList","aDeferred","Deferred","lock","recordId","getRecordId","checkEmail","reject","async","dataType","reponseData","resolve","promise","registerEvents","_super","Vtiger_Edit_Js","getInstance","Users_Edit_Js","registerChangeEventForCurrencySeparator"],"mappings":"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"}