{"version":3,"file":"TreeInventoryModal.min.js","sources":["TreeInventoryModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_TreeInventoryModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Tree instance\n\t\t */\n\t\ttreeInstance: false,\n\t\t/**\n\t\t * Set event for select row\n\t\t * @param {function} cb\n\t\t */\n\t\tsetSelectEvent: function (cb) {\n\t\t\tthis.selectEvent = cb;\n\t\t},\n\t\t/**\n\t\t * Gets tree data\n\t\t */\n\t\tgetTreeData: function () {\n\t\t\tlet treeData = this.container.find('.js-tree-value').val();\n\t\t\treturn treeData ? JSON.parse(treeData) : [];\n\t\t},\n\n\t\t/*\n\t\t * Function generates a tree.\n\t\t */\n\t\tgenerateTree: function () {\n\t\t\tif (this.treeInstance == false) {\n\t\t\t\tthis.treeInstance = this.container.find('.js-tree-contents');\n\t\t\t\tlet plugins = ['search', 'category', 'checkbox'];\n\t\t\t\tthis.treeInstance.jstree(\n\t\t\t\t\t$.extend(\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcore: {\n\t\t\t\t\t\t\t\tdata: this.getTreeData(),\n\t\t\t\t\t\t\t\tthemes: {\n\t\t\t\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcheckbox: {\n\t\t\t\t\t\t\t\tthree_state: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tplugins: plugins\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis.treeInstance.data('params')\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * Function looks up the entered phrases.\n\t\t */\n\t\tsearching: function (text) {\n\t\t\tthis.treeInstance.jstree(true).search(text);\n\t\t},\n\n\t\t/*\n\t\t * Function retrieves the search terms.\n\t\t */\n\t\tregisterSearchEvent: function () {\n\t\t\tlet valueSearch = this.container.find('#valueSearchTree');\n\t\t\tlet btnSearch = this.container.find('#btnSearchTree');\n\t\t\tvalueSearch.on('keypress', (e) => {\n\t\t\t\tif (e.which == 13) {\n\t\t\t\t\tthis.searching(valueSearch.val());\n\t\t\t\t}\n\t\t\t});\n\t\t\tbtnSearch.on('click', () => {\n\t\t\t\tthis.searching(valueSearch.val());\n\t\t\t});\n\t\t},\n\n\t\t/*\n\t\t * Function retrieves the selected records.\n\t\t */\n\t\tregisterSelectRecords: function () {\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\tlet recordsToAdd = [];\n\t\t\t\t$.each(this.treeInstance.jstree('getCategory', true), function (_, treeElement) {\n\t\t\t\t\tif (treeElement.attr === 'record') {\n\t\t\t\t\t\trecordsToAdd[treeElement.record_id] = treeElement.text;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (recordsToAdd.length) {\n\t\t\t\t\tthis.selectEvent(recordsToAdd);\n\t\t\t\t\tapp.hideModalWindow(false, this.container.parent().attr('id'));\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_PLEASE_SELECT_ONE_RECORD') });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register modal events\n\t\t */\n\t\tregisterEvents: function (container) {\n\t\t\tthis.container = container;\n\t\t\tthis.generateTree();\n\t\t\tthis.registerSelectRecords();\n\t\t\tthis.registerSearchEvent();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","treeInstance","setSelectEvent","cb","selectEvent","getTreeData","treeData","find","val","JSON","parse","generateTree","jstree","extend","core","data","themes","name","responsive","checkbox","three_state","plugins","searching","text","search","registerSearchEvent","valueSearch","btnSearch","on","e","which","registerSelectRecords","each","_","treeElement","attr","recordsToAdd","record_id","length","app","hideModalWindow","parent","showNotify","vtranslate","registerEvents"],"mappings":"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"}