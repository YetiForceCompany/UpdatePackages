{"version":3,"file":"Calendar.min.js","sources":["Calendar.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n/** Class representing a calendar. */\nwindow.Calendar_Js = class {\n\t/**\n\t * Create calendar's options.\n\t * @param {jQuery} container\n\t * @param {bool} readonly\n\t */\n\tconstructor(container = $('.js-base-container'), readonly = false, browserHistory = true) {\n\t\tthis.calendarView = false;\n\t\tthis.calendarCreateView = false;\n\t\tthis.container = container;\n\t\tthis.readonly = readonly;\n\t\tthis.eventCreate = app.getMainParams('eventCreate');\n\t\tthis.eventEdit = app.getMainParams('eventEdit');\n\t\tthis.browserHistory = !readonly && browserHistory;\n\t\tthis.sidebarView = {\n\t\t\tlength: 0\n\t\t};\n\t\tthis.browserHistoryConfig = this.browserHistory ? {} : this.setBrowserHistoryOptions();\n\t\tthis.calendarOptions = this.setCalendarOptions();\n\t\tthis.eventTypeKeyName = false;\n\t\tthis.module = app.getModuleName();\n\t}\n\n\t/**\n\t * Set calendar's options.\n\t * @returns {object}\n\t */\n\tsetCalendarOptions() {\n\t\treturn Object.assign(\n\t\t\tthis.setCalendarBasicOptions(),\n\t\t\tthis.setCalendarAdvancedOptions(),\n\t\t\tthis.setCalendarModuleOptions(),\n\t\t\tthis.browserHistoryConfig\n\t\t);\n\t}\n\n\t/**\n\t * Set calendar's basic options.\n\t * @returns {object}\n\t */\n\tsetCalendarBasicOptions() {\n\t\tlet eventLimit = app.getMainParams('eventLimit'),\n\t\t\tuserDefaultActivityView = app.getMainParams('activity_view'),\n\t\t\tdefaultView = app.moduleCacheGet('defaultView'),\n\t\t\tuserDefaultTimeFormat = CONFIG.hourFormat;\n\t\tif (eventLimit == 'true') {\n\t\t\teventLimit = true;\n\t\t} else if (eventLimit == 'false') {\n\t\t\teventLimit = false;\n\t\t} else {\n\t\t\teventLimit = parseInt(eventLimit) + 1;\n\t\t}\n\t\tif (userDefaultActivityView === 'Today') {\n\t\t\tuserDefaultActivityView = app.getMainParams('dayView');\n\t\t} else if (userDefaultActivityView === 'This Week') {\n\t\t\tuserDefaultActivityView = app.getMainParams('weekView');\n\t\t} else if (userDefaultActivityView === 'This Year') {\n\t\t\tuserDefaultActivityView = 'year';\n\t\t} else {\n\t\t\tuserDefaultActivityView = 'month';\n\t\t}\n\t\tif (defaultView != null) {\n\t\t\tuserDefaultActivityView = defaultView;\n\t\t}\n\t\tif (userDefaultTimeFormat == 24) {\n\t\t\tuserDefaultTimeFormat = 'H:mm';\n\t\t} else {\n\t\t\tuserDefaultTimeFormat = 'h:mmt';\n\t\t}\n\n\t\tlet options = {\n\t\t\ttimeFormat: userDefaultTimeFormat,\n\t\t\tslotLabelFormat: userDefaultTimeFormat,\n\t\t\tdefaultView: userDefaultActivityView,\n\t\t\tslotMinutes: 15,\n\t\t\tdefaultEventMinutes: 0,\n\t\t\tforceEventDuration: true,\n\t\t\tdefaultTimedEventDuration: '01:00:00',\n\t\t\teventLimit: eventLimit,\n\t\t\teventLimitText: app.vtranslate('JS_MORE'),\n\t\t\tselectHelper: true,\n\t\t\tscrollTime: app.getMainParams('startHour') + ':00',\n\t\t\tmonthNamesShort: App.Fields.Date.monthsTranslated,\n\t\t\tdayNames: App.Fields.Date.fullDaysTranslated,\n\t\t\tbuttonText: {\n\t\t\t\ttoday: app.vtranslate('JS_CURRENT'),\n\t\t\t\tyear: app.vtranslate('JS_YEAR'),\n\t\t\t\tmonth: app.vtranslate('JS_MONTH'),\n\t\t\t\tweek: app.vtranslate('JS_WEEK'),\n\t\t\t\tday: app.vtranslate('JS_DAY')\n\t\t\t},\n\t\t\tallDayText: app.vtranslate('JS_ALL_DAY')\n\t\t};\n\t\tif (app.moduleCacheGet('start') !== null) {\n\t\t\tlet s = moment(app.moduleCacheGet('start')).valueOf();\n\t\t\tlet e = moment(app.moduleCacheGet('end')).valueOf();\n\t\t\toptions.defaultDate = moment(moment(s + (e - s) / 2).format('YYYY-MM-DD'));\n\t\t}\n\t\treturn Object.assign(this.setCalendarMinimalOptions(), options);\n\t}\n\n\t/**\n\t * Converts the date format.\n\t * @param {string} partOfDate\n\t */\n\tparseDateFormat(partOfDate) {\n\t\tlet parseMonthFormat = {\n\t\t\t'yyyy-mm-dd': 'YYYY-MMMM',\n\t\t\t'mm-dd-yyyy': 'MMMM-YYYY',\n\t\t\t'dd-mm-yyyy': 'MMMM-YYYY',\n\t\t\t'yyyy.mm.dd': 'YYYY.MMMM',\n\t\t\t'mm.dd.yyyy': 'MMMM.YYYY',\n\t\t\t'dd.mm.yyyy': 'MMMM.YYYY',\n\t\t\t'yyyy/mm/dd': 'YYYY/MMMM',\n\t\t\t'mm/dd/yyyy': 'MMMM/YYYY',\n\t\t\t'dd/mm/yyyy': 'MMMM/YYYY'\n\t\t};\n\t\tlet parseWeekAndDayFormat = {\n\t\t\t'yyyy-mm-dd': 'YYYY-MMM-D',\n\t\t\t'mm-dd-yyyy': 'MMM-D-YYYY',\n\t\t\t'dd-mm-yyyy': 'D-MMM-YYYY',\n\t\t\t'yyyy.mm.dd': 'YYYY.MMM.D',\n\t\t\t'mm.dd.yyyy': 'MMM.D.YYYY',\n\t\t\t'dd.mm.yyyy': 'D.MMM.YYYY',\n\t\t\t'yyyy/mm/dd': 'YYYY/MMM/D',\n\t\t\t'mm/dd/yyyy': 'MMM/D/YYYY',\n\t\t\t'dd/mm/yyyy': 'D/MMM/YYYY'\n\t\t};\n\t\tlet formatDate = CONFIG.dateFormat;\n\t\tswitch (partOfDate) {\n\t\t\tcase 'month':\n\t\t\t\treturn parseMonthFormat[formatDate];\n\t\t\t\tbreak;\n\t\t\tcase 'week':\n\t\t\t\treturn parseWeekAndDayFormat[formatDate];\n\t\t\t\tbreak;\n\t\t\tcase 'day':\n\t\t\t\treturn parseWeekAndDayFormat[formatDate];\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Set calendar's minimal options.\n\t * @returns {object}\n\t */\n\tsetCalendarMinimalOptions() {\n\t\tlet hiddenDays = [];\n\t\tif (app.getMainParams('switchingDays') === 'workDays') {\n\t\t\thiddenDays = app.getMainParams('hiddenDays', true);\n\t\t}\n\t\treturn {\n\t\t\tfirstDay: CONFIG.firstDayOfWeekNo,\n\t\t\tselectable: true,\n\t\t\thiddenDays: hiddenDays,\n\t\t\tmonthNames: App.Fields.Date.fullMonthsTranslated,\n\t\t\tdayNamesShort: App.Fields.Date.daysTranslated\n\t\t};\n\t}\n\n\t/**\n\t * Set calendar's advanced options.\n\t * @returns {object}\n\t */\n\tsetCalendarAdvancedOptions() {\n\t\tlet self = this;\n\t\treturn {\n\t\t\teditable: !this.readonly && this.eventEdit,\n\t\t\tselectable: !this.readonly && this.eventCreate,\n\t\t\theader: {\n\t\t\t\tleft: 'month,' + app.getMainParams('weekView') + ',' + app.getMainParams('dayView'),\n\t\t\t\tcenter: 'title today',\n\t\t\t\tright: 'prev,next'\n\t\t\t},\n\t\t\tallDaySlot: app.getMainParams('allDaySlot'),\n\t\t\tviews: {\n\t\t\t\tbasic: {\n\t\t\t\t\teventLimit: false\n\t\t\t\t},\n\t\t\t\tmonth: {\n\t\t\t\t\ttitleFormat: this.parseDateFormat('month')\n\t\t\t\t},\n\t\t\t\tweek: {\n\t\t\t\t\ttitleFormat: this.parseDateFormat('week')\n\t\t\t\t},\n\t\t\t\tday: {\n\t\t\t\t\ttitleFormat: this.parseDateFormat('day')\n\t\t\t\t}\n\t\t\t},\n\t\t\teventDrop: function (event, delta, revertFunc) {\n\t\t\t\tself.updateEvent(event, delta, revertFunc);\n\t\t\t},\n\t\t\teventResize: function (event, delta, revertFunc) {\n\t\t\t\tself.updateEvent(event, delta, revertFunc);\n\t\t\t},\n\t\t\tviewRender: function () {\n\t\t\t\tself.loadCalendarData();\n\t\t\t},\n\t\t\teventRender: self.eventRenderer,\n\t\t\theight: this.setCalendarHeight(this.container)\n\t\t};\n\t}\n\n\t/**\n\t * Update calendar's event.\n\t * @param {Object} event\n\t * @param {Object} delta\n\t * @param {Object} revertFunc\n\t */\n\tupdateEvent(event, delta, revertFunc) {\n\t\tlet progressInstance = jQuery.progressIndicator({ blockInfo: { enabled: true } });\n\t\tlet start = event.start.format();\n\t\tlet params = {\n\t\t\tmodule: CONFIG.module,\n\t\t\taction: 'Calendar',\n\t\t\tmode: 'updateEvent',\n\t\t\tid: event.id,\n\t\t\tstart: start,\n\t\t\tdelta: delta._data,\n\t\t\tallDay: event.allDay\n\t\t};\n\t\tAppConnector.request(params)\n\t\t\t.done(function (response) {\n\t\t\t\tif (!response['result']) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate('JS_NO_EDIT_PERMISSION'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t\trevertFunc();\n\t\t\t\t} else {\n\t\t\t\t\twindow.popoverCache = {};\n\t\t\t\t}\n\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t})\n\t\t\t.fail(function () {\n\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttext: app.vtranslate('JS_NO_EDIT_PERMISSION'),\n\t\t\t\t\ttype: 'error'\n\t\t\t\t});\n\t\t\t\trevertFunc();\n\t\t\t});\n\t}\n\n\t/**\n\t * Render event.\n\t * @param {Object} event\n\t * @param {jQuery} element\n\t */\n\teventRenderer(event, element) {\n\t\telement.find('.fc-title').html(event.title);\n\t\tif (event.rendering === 'background') {\n\t\t\telement.append(\n\t\t\t\t`<span class=\"js-popover-text d-block\"><span class=\"${event.icon} js-popover-icon mr-1\"></span>${event.title}</span>`\n\t\t\t);\n\t\t\telement.addClass('js-popover-tooltip--ellipsis').attr('data-content', event.title);\n\t\t\tapp.registerPopoverEllipsis({ element });\n\t\t}\n\t}\n\n\t/**\n\t * Returns counted calendar height.\n\t * @returns {(number|string)}\n\t */\n\tsetCalendarHeight() {\n\t\tconst defaultHeightValue = 'auto';\n\t\tif ($(window).width() > 993) {\n\t\t\tlet calendarContainer = this.container.find('.js-calendar__container'),\n\t\t\t\tcalendarPadding;\n\t\t\tif (this.container.hasClass('js-modal-container')) {\n\t\t\t\tcalendarPadding = this.container.find('.js-modal-header').outerHeight(); // modal needs bigger padding to prevent modal's scrollbar\n\t\t\t} else {\n\t\t\t\tcalendarPadding = this.container.find('.js-contents-div').css('margin-left').replace('px', ''); //equals calendar padding bottom to left margin\n\t\t\t}\n\t\t\tlet setCalendarH = () => {\n\t\t\t\treturn (\n\t\t\t\t\t$(window).height() -\n\t\t\t\t\tthis.container.find('.js-calendar__container').offset().top -\n\t\t\t\t\t$('.js-footer').height() -\n\t\t\t\t\tcalendarPadding\n\t\t\t\t);\n\t\t\t};\n\t\t\tnew ResizeSensor(this.container.find('.contentsDiv'), () => {\n\t\t\t\tcalendarContainer.fullCalendar('option', 'height', setCalendarH());\n\t\t\t});\n\t\t}\n\t\treturn defaultHeightValue;\n\t}\n\n\t/**\n\t * Set calendar module's options.\n\t * @returns {object}\n\t */\n\tsetCalendarModuleOptions() {\n\t\treturn {};\n\t}\n\n\t/**\n\t * Set calendar options from browser history.\n\t * @returns {object}\n\t */\n\tsetBrowserHistoryOptions() {\n\t\tlet historyParams = app.getMainParams('historyParams', true),\n\t\t\toptions = null;\n\t\tif (historyParams && (historyParams.length || Object.keys(historyParams).length)) {\n\t\t\toptions = {\n\t\t\t\tstart: historyParams.start,\n\t\t\t\tend: historyParams.end,\n\t\t\t\tuser: historyParams.user.split(',').map((x) => {\n\t\t\t\t\treturn parseInt(x);\n\t\t\t\t}),\n\t\t\t\ttime: historyParams.time,\n\t\t\t\thiddenDays: historyParams.hiddenDays.split(',').map((x) => {\n\t\t\t\t\tlet parsedValue = parseInt(x);\n\t\t\t\t\treturn isNaN(parsedValue) ? '' : parsedValue;\n\t\t\t\t}),\n\t\t\t\tcvid: historyParams.cvid,\n\t\t\t\tdefaultView: historyParams.viewType\n\t\t\t};\n\t\t\tlet dateFormat = CONFIG.dateFormat.toUpperCase();\n\t\t\tlet s = moment(options.start, dateFormat).valueOf();\n\t\t\tlet e = moment(options.end, dateFormat).valueOf();\n\t\t\toptions.defaultDate = moment(moment(s + (e - s) / 2).format('YYYY-MM-DD'));\n\t\t\tObject.keys(options).forEach((key) => options[key] === 'undefined' && delete options[key]);\n\t\t\tapp.moduleCacheSet('browserHistoryEvent', false);\n\t\t\tapp.setMainParams('showType', options.time);\n\t\t\tapp.setMainParams('usersId', options.user);\n\t\t\tapp.setMainParams('defaultView', options.defaultView);\n\t\t}\n\t\twindow.addEventListener(\n\t\t\t'popstate',\n\t\t\tfunction (event) {\n\t\t\t\tapp.moduleCacheSet('browserHistoryEvent', true);\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\t\treturn options;\n\t}\n\t/**\n\t * Register filters\n\t */\n\tregisterFilters() {\n\t\tconst thisInstance = this;\n\t\tlet aDeferred = jQuery.Deferred();\n\n\t\tlet sideBar = thisInstance.getSidebarView();\n\t\tif (!sideBar || sideBar.length <= 0) {\n\t\t\taDeferred.resolve(true);\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t\tsideBar.find('.js-sidebar-filter-container').each((_, row) => {\n\t\t\tif (row.dataset.url) {\n\t\t\t\tAppConnector.request(row.dataset.url).done(function (data) {\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tlet formContainer = $(row).find('.js-sidebar-filter-body');\n\t\t\t\t\t\tformContainer.html(data);\n\t\t\t\t\t\tthisInstance.registerUsersChange(formContainer);\n\t\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(formContainer.find('select'));\n\t\t\t\t\t\tapp.showNewScrollbar(formContainer, {\n\t\t\t\t\t\t\tsuppressScrollX: true\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthisInstance.registerFilterForm(formContainer);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\t/**\n\t * Register filter for users and groups\n\t * @param {jQuery} container\n\t */\n\tregisterFilterForm(container) {\n\t\tif (container.find('.js-filter__search').length) {\n\t\t\tcontainer.find('.js-filter__search').on('keyup', this.findElementOnList.bind(self));\n\t\t}\n\t\tcontainer.find('.js-calendar__filter__select, .filterField').each((_, e) => {\n\t\t\tlet element = $(e);\n\t\t\tlet name = element.data('cache');\n\t\t\tlet cachedValue = app.moduleCacheGet(name);\n\t\t\tif (element.length > 0 && cachedValue !== undefined) {\n\t\t\t\tif (element.prop('tagName') == 'SELECT') {\n\t\t\t\t\telement.val(cachedValue);\n\t\t\t\t}\n\t\t\t} else if (name && element.length > 0 && cachedValue === undefined && !element.find(':selected').length) {\n\t\t\t\tlet allOptions = [];\n\t\t\t\telement.find('option').each((i, option) => {\n\t\t\t\t\tallOptions.push($(option).val());\n\t\t\t\t});\n\t\t\t\telement.val(allOptions);\n\t\t\t\tapp.moduleCacheSet(name, cachedValue);\n\t\t\t}\n\n\t\t\telement.off('change');\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(element);\n\t\t\telement.on('change', (e) => {\n\t\t\t\tlet item = $(e.currentTarget);\n\t\t\t\tlet value = item.val();\n\t\t\t\tif (value == null) {\n\t\t\t\t\tvalue = '';\n\t\t\t\t}\n\t\t\t\tif (item.attr('type') == 'checkbox') {\n\t\t\t\t\tvalue = element.is(':checked');\n\t\t\t\t}\n\t\t\t\tapp.moduleCacheSet(item.data('cache'), value);\n\t\t\t\tthis.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t\t});\n\t\t});\n\t\tcontainer\n\t\t\t.find('.js-filter__container_checkbox_list .js-filter__item__val')\n\t\t\t.off('change')\n\t\t\t.on('change', (e) => {\n\t\t\t\tthis.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t\t});\n\t}\n\n\tregisterUsersChange(formContainer) {\n\t\tformContainer.find('.js-input-user-owner-id-ajax, .js-input-user-owner-id').on('change', () => {\n\t\t\tthis.getCalendarView().fullCalendar('getCalendar').view.options.loadView();\n\t\t});\n\t}\n\t/**\n\t * Register events.\n\t * @returns {object}\n\t */\n\tregisterEvents() {\n\t\tthis.registerFilters();\n\t\tthis.registerSitebarEvents();\n\t\tthis.renderCalendar();\n\t\tthis.registerButtonSelectAll();\n\t\tthis.registerAddButton();\n\t}\n\n\t/**\n\t * Invokes fullcalendar with options.\n\t */\n\trenderCalendar() {\n\t\tthis.getCalendarView().fullCalendar(this.calendarOptions);\n\t}\n\n\t/**\n\t * Register sitebar events.\n\t */\n\tregisterSitebarEvents() {\n\t\t$('.bodyContents').on('Vtiger.Widget.Load.undefined', () => {\n\t\t\tthis.registerSelect2Event();\n\t\t});\n\t}\n\n\t/**\n\t * Load calendar data\n\t */\n\tloadCalendarData() {\n\t\tconst defaultParams = this.getDefaultParams();\n\t\tthis.getCalendarView().fullCalendar('removeEvents');\n\t\tif (!defaultParams.emptyFilters) {\n\t\t\tconst progressInstance = $.progressIndicator();\n\t\t\tAppConnector.request(defaultParams).done((events) => {\n\t\t\t\tthis.getCalendarView().fullCalendar('addEventSource', events.result);\n\t\t\t\tprogressInstance.hide();\n\t\t\t});\n\t\t}\n\t}\n\tgetSidebarView() {\n\t\tif (!this.sidebarView.length) {\n\t\t\tthis.sidebarView = this.container.find('.js-calendar-right-panel');\n\t\t}\n\t\treturn this.sidebarView;\n\t}\n\tgetCurrentCvId() {\n\t\treturn $('.js-calendar__extended-filter-tab .active').parent('.js-filter-tab').data('cvid');\n\t}\n\t/**\n\t * Default params\n\t * @returns {{module: *, action: string, mode: string, start: *, end: *, user: *, emptyFilters: boolean}}\n\t */\n\tgetDefaultParams() {\n\t\tlet formatDate = CONFIG.dateFormat.toUpperCase(),\n\t\t\tview = this.getCalendarView().fullCalendar('getView'),\n\t\t\tcvid = this.getCurrentCvId(),\n\t\t\tusers = app.moduleCacheGet('calendar-users') || CONFIG.userId,\n\t\t\tsideBar = this.getSidebarView();\n\t\tlet params = {\n\t\t\tmodule: this.module ? this.module : CONFIG.module,\n\t\t\taction: 'Calendar',\n\t\t\tmode: 'getEvents',\n\t\t\tstart: view.start.format(formatDate),\n\t\t\tend: view.end.format(formatDate),\n\t\t\tuser: users,\n\t\t\tcvid: cvid,\n\t\t\temptyFilters: users.length === 0\n\t\t};\n\t\tlet filters = [];\n\t\tsideBar.find('.calendarFilters .filterField').each(function () {\n\t\t\tlet element = $(this),\n\t\t\t\tname,\n\t\t\t\tvalue;\n\t\t\tif (element.attr('type') == 'checkbox') {\n\t\t\t\tname = element.val();\n\t\t\t\tvalue = element.prop('checked') ? 1 : 0;\n\t\t\t} else {\n\t\t\t\tname = element.attr('name');\n\t\t\t\tvalue = element.val();\n\t\t\t}\n\t\t\tfilters.push({ name: name, value: value });\n\t\t});\n\t\tif (filters.length) {\n\t\t\tparams.filters = filters;\n\t\t}\n\t\tsideBar.find('.js-sidebar-filter-container').each((_, e) => {\n\t\t\tlet element = $(e);\n\t\t\tlet name = element.data('name');\n\t\t\tlet cacheName = element.data('cache');\n\t\t\tif (name && cacheName && app.moduleCacheGet(cacheName)) {\n\t\t\t\tparams[name] = app.moduleCacheGet(cacheName);\n\t\t\t\tparams.emptyFilters = !params.emptyFilters && params[name].length === 0;\n\t\t\t}\n\t\t});\n\t\tsideBar.find('.js-filter__container_checkbox_list').each((_, e) => {\n\t\t\tlet filters = [];\n\t\t\tlet element = $(e);\n\t\t\tlet name = element.data('name');\n\t\t\telement.find('.js-filter__item__val:checked').each(function () {\n\t\t\t\tfilters.push($(this).val());\n\t\t\t});\n\t\t\tif (name) {\n\t\t\t\tparams[name] = filters;\n\t\t\t}\n\t\t});\n\t\tsideBar.find('.js-calendar__filter__select').each((_, e) => {\n\t\t\tlet element = $(e);\n\t\t\tlet name = element.attr('name');\n\t\t\tlet cacheName = element.data('cache');\n\t\t\tif (name) {\n\t\t\t\tparams[name] = cacheName && app.moduleCacheGet(cacheName) ? app.moduleCacheGet(cacheName) : element.val();\n\t\t\t\tparams.emptyFilters = !params.emptyFilters && params[name].length === 0;\n\t\t\t}\n\t\t});\n\t\treturn params;\n\t}\n\n\t/**\n\t * Register select2 event.\n\t */\n\tregisterSelect2Event() {\n\t\tlet self = this;\n\t\t$('.siteBarRight .js-calendar__filter__select').each(function () {\n\t\t\tlet element = $(this);\n\t\t\tlet name = element.data('cache');\n\t\t\tlet cachedValue = app.moduleCacheGet(name);\n\t\t\tif (element.length > 0 && cachedValue !== undefined) {\n\t\t\t\tif (element.prop('tagName') == 'SELECT') {\n\t\t\t\t\telement.val(cachedValue);\n\t\t\t\t}\n\t\t\t} else if (element.length > 0 && cachedValue === undefined && !element.find(':selected').length) {\n\t\t\t\tlet allOptions = [];\n\t\t\t\telement.find('option').each((i, option) => {\n\t\t\t\t\tallOptions.push($(option).val());\n\t\t\t\t});\n\t\t\t\telement.val(allOptions);\n\t\t\t\tapp.moduleCacheSet(name, cachedValue);\n\t\t\t}\n\t\t});\n\t\tlet selectsElements = $('.siteBarRight .select2, .siteBarRight .filterField');\n\t\tselectsElements.off('change');\n\t\tApp.Fields.Picklist.showSelect2ElementView(selectsElements);\n\t\tselectsElements.on('change', function () {\n\t\t\tlet element = $(this);\n\t\t\tlet value = element.val();\n\t\t\tif (value == null) {\n\t\t\t\tvalue = '';\n\t\t\t}\n\t\t\tif (element.attr('type') == 'checkbox') {\n\t\t\t\tvalue = element.is(':checked');\n\t\t\t}\n\t\t\tapp.moduleCacheSet(element.data('cache'), value);\n\t\t\tself.loadCalendarData();\n\t\t});\n\t}\n\n\t/**\n\t * Register button select all.\n\t */\n\tregisterButtonSelectAll() {\n\t\tlet selectBtn = $('.selectAllBtn');\n\t\tselectBtn.on('click', function (e) {\n\t\t\tlet selectAllLabel = $(this).find('.selectAll');\n\t\t\tlet deselectAllLabel = $(this).find('.deselectAll');\n\t\t\tif (selectAllLabel.hasClass('d-none')) {\n\t\t\t\tselectAllLabel.removeClass('d-none');\n\t\t\t\tdeselectAllLabel.addClass('d-none');\n\t\t\t\t$(this).closest('.quickWidget').find('select option').prop('selected', false);\n\t\t\t} else {\n\t\t\t\t$(this).closest('.quickWidget').find('select option').prop('selected', true);\n\t\t\t\tdeselectAllLabel.removeClass('d-none');\n\t\t\t\tselectAllLabel.addClass('d-none');\n\t\t\t}\n\t\t\t$(this).closest('.quickWidget').find('select').trigger('change');\n\t\t});\n\t}\n\n\t/**\n\t * Register add button.\n\t */\n\tregisterAddButton() {\n\t\tconst self = this;\n\t\t$('.js-add').on('click', (e) => {\n\t\t\tself.getCalendarCreateView().done((data) => {\n\t\t\t\tApp.Components.QuickCreate.showModal(data, {\n\t\t\t\t\tcallbackFunction: (data) => {\n\t\t\t\t\t\tself.addCalendarEvent(data.result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Get calendar create view.\n\t * @returns {promise}\n\t */\n\tgetCalendarCreateView() {\n\t\tlet self = this;\n\t\tlet aDeferred = jQuery.Deferred();\n\n\t\tif (this.calendarCreateView !== false) {\n\t\t\taDeferred.resolve(this.calendarCreateView.clone(true, true));\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t\tlet progressInstance = jQuery.progressIndicator();\n\t\tthis.loadCalendarCreateView()\n\t\t\t.done(function (data) {\n\t\t\t\tprogressInstance.hide();\n\t\t\t\tself.calendarCreateView = data;\n\t\t\t\taDeferred.resolve(data.clone(true, true));\n\t\t\t})\n\t\t\t.fail(function () {\n\t\t\t\tprogressInstance.hide();\n\t\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\t/**\n\t * Load calendar create view.\n\t * @returns {promise}\n\t */\n\tloadCalendarCreateView() {\n\t\tlet aDeferred = jQuery.Deferred();\n\t\tlet moduleName = app.getModuleName();\n\t\tlet url = 'index.php?module=' + moduleName + '&view=QuickCreateAjax';\n\t\tApp.Components.QuickCreate.getForm(url, moduleName)\n\t\t\t.done(function (data) {\n\t\t\t\taDeferred.resolve(jQuery(data));\n\t\t\t})\n\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\t/**\n\t * Add event data to render.\n\t */\n\tgetEventRenderData(calendarDetails) {\n\t\tconst calendar = this.getCalendarView();\n\t\tconst eventObject = {\n\t\t\tid: calendarDetails._recordId,\n\t\t\ttitle: calendarDetails._recordLabel,\n\t\t\tstart: calendar\n\t\t\t\t.fullCalendar('moment', calendarDetails.date_start.value + ' ' + calendarDetails.time_start.value)\n\t\t\t\t.format(),\n\t\t\tend: calendar\n\t\t\t\t.fullCalendar('moment', calendarDetails.due_date.value + ' ' + calendarDetails.time_end.value)\n\t\t\t\t.format(),\n\t\t\tstart_display: calendarDetails.date_start.display_value + ' ' + calendarDetails.time_start.display_value,\n\t\t\tend_display: calendarDetails.due_date.display_value + ' ' + calendarDetails.time_end.display_value,\n\t\t\turl: `index.php?module=${CONFIG.module}&view=Detail&record=${calendarDetails._recordId}`,\n\t\t\tclassName: `js-popover-tooltip--record ownerCBg_${calendarDetails.assigned_user_id.value} picklistCBr_${\n\t\t\t\tCONFIG.module\n\t\t\t}_${\n\t\t\t\t$('.js-calendar__filter__select[data-cache=\"calendar-types\"]').length && calendarDetails[this.eventTypeKeyName]\n\t\t\t\t\t? this.eventTypeKeyName + '_' + calendarDetails[this.eventTypeKeyName]['value']\n\t\t\t\t\t: ''\n\t\t\t}`,\n\t\t\tallDay: typeof calendarDetails.allday === 'undefined' ? false : calendarDetails.allday.value == 'on'\n\t\t};\n\t\treturn eventObject;\n\t}\n\n\tisNewEventToDisplay(eventObject) {\n\t\tlet ownerSelects = $('.js-calendar__filter__select[data-cache=\"calendar-users\"]').add(\n\t\t\t$('.js-calendar__filter__select[data-cache=\"calendar-groups\"]')\n\t\t);\n\t\tif ($.inArray(eventObject.assigned_user_id.value, ownerSelects.val()) < 0) {\n\t\t\tthis.refreshFilterValues(eventObject, ownerSelects);\n\t\t\treturn false;\n\t\t}\n\t\tlet calendarTypes = $('.js-calendar__filter__select[data-cache=\"calendar-types\"]');\n\t\tif (calendarTypes.length) {\n\t\t\tif (!this.eventTypeKeyName) {\n\t\t\t\tthis.setEventTypeKey(eventObject, calendarTypes.data('name'));\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.eventTypeKeyName &&\n\t\t\t\tcalendarTypes.val().length &&\n\t\t\t\t$.inArray(eventObject[this.eventTypeKeyName]['value'], calendarTypes.val()) < 0\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tsetEventTypeKey(eventObject, keyName) {\n\t\tlet self = this;\n\t\tif (keyName && eventObject.keyName !== undefined) {\n\t\t\tself.eventTypeKeyName = keyName;\n\t\t} else {\n\t\t\tObject.keys(eventObject).forEach(function (key, index) {\n\t\t\t\tif (key.endsWith('type')) {\n\t\t\t\t\t// there are different names for event types in modules\n\t\t\t\t\tself.eventTypeKeyName = key;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\trefreshFilterValues(eventObject, filtersValues) {\n\t\tif (CONFIG.searchShowOwnerOnlyInList) {\n\t\t\tlet allOptions = [];\n\t\t\tfiltersValues.find('option').each((i, option) => {\n\t\t\t\tallOptions.push($(option).val());\n\t\t\t});\n\t\t\tif ($.inArray(eventObject.assigned_user_id.value, allOptions) < 0) {\n\t\t\t\tAppConnector.request(`module=${CONFIG.module}&view=RightPanel&mode=getUsersList`).done((usersData) => {\n\t\t\t\t\tlet filterUsers = $('.js-calendar__filter--users');\n\t\t\t\t\tlet filterGroups = $('.js-calendar__filter--groups');\n\t\t\t\t\tfilterUsers.html(usersData);\n\t\t\t\t\tif (usersData) {\n\t\t\t\t\t\tfilterUsers.closest('.js-toggle-panel').removeClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t\tif (filterGroups.length) {\n\t\t\t\t\t\tAppConnector.request(`module=${CONFIG.module}&view=RightPanel&mode=getGroupsList`).done((groupsData) => {\n\t\t\t\t\t\t\tfilterGroups.html(groupsData);\n\t\t\t\t\t\t\tif (groupsData) {\n\t\t\t\t\t\t\t\tfilterGroups.closest('.js-toggle-panel').removeClass('d-none');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.registerSelect2Event();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.registerSelect2Event();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Add calendar event.\n\t */\n\taddCalendarEvent(eventObject) {\n\t\tif (this.isNewEventToDisplay(eventObject)) {\n\t\t\tthis.getCalendarView().fullCalendar('renderEvent', this.getEventRenderData(eventObject));\n\t\t}\n\t}\n\n\t/**\n\t * Get calendar container.\n\t * @returns {(boolean|jQuery)}\n\t */\n\tgetCalendarView() {\n\t\tif (this.calendarView == false) {\n\t\t\tthis.calendarView = this.container.find('.js-calendar__container');\n\t\t}\n\t\treturn this.calendarView;\n\t}\n};\n\n/**\n *  Class representing a calendar with creating events by day click instead of selecting days.\n * @extends Calendar_Js\n */\nwindow.Calendar_Unselectable_Js = class extends (\n\tCalendar_Js\n) {\n\t/**\n\t * Set calendar module options.\n\t * @returns {{allDaySlot: boolean, dayClick: object, selectable: boolean}}\n\t */\n\tsetCalendarModuleOptions() {\n\t\tlet self = this;\n\t\treturn {\n\t\t\tallDaySlot: false,\n\t\t\tdayClick: this.eventCreate\n\t\t\t\t? function (date) {\n\t\t\t\t\t\tself.registerDayClickEvent(date.format());\n\t\t\t\t\t\tself.getCalendarView().fullCalendar('unselect');\n\t\t\t\t  }\n\t\t\t\t: false,\n\t\t\tselectable: false\n\t\t};\n\t}\n\n\t/**\n\t * Register day click event.\n\t * @param {string} date\n\t */\n\tregisterDayClickEvent(date) {\n\t\tlet self = this;\n\t\tself.getCalendarCreateView().done(function (data) {\n\t\t\tif (data.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet dateFormat = data.find('[name=\"date_start\"]').data('dateFormat').toUpperCase(),\n\t\t\t\ttimeFormat = data.find('[name=\"time_start\"]').data('format'),\n\t\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t\tif (timeFormat == 24) {\n\t\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t\t}\n\t\t\tlet startDateInstance = Date.parse(date);\n\t\t\tlet startDateString = moment(date).format(dateFormat);\n\t\t\tlet startTimeString = moment(date).format(defaultTimeFormat);\n\t\t\tlet endDateInstance = Date.parse(date);\n\t\t\tlet endDateString = moment(date).format(dateFormat);\n\n\t\t\tlet view = self.getCalendarView().fullCalendar('getView');\n\t\t\tlet endTimeString;\n\t\t\tif ('month' == view.name) {\n\t\t\t\tlet diffDays = parseInt((endDateInstance - startDateInstance) / (1000 * 60 * 60 * 24));\n\t\t\t\tif (diffDays > 1) {\n\t\t\t\t\tlet defaultFirstHour = app.getMainParams('startHour');\n\t\t\t\t\tlet explodedTime = defaultFirstHour.split(':');\n\t\t\t\t\tstartTimeString = explodedTime['0'];\n\t\t\t\t\tlet defaultLastHour = app.getMainParams('endHour');\n\t\t\t\t\texplodedTime = defaultLastHour.split(':');\n\t\t\t\t\tendTimeString = explodedTime['0'];\n\t\t\t\t} else {\n\t\t\t\t\tlet now = new Date();\n\t\t\t\t\tstartTimeString = moment(now).format(defaultTimeFormat);\n\t\t\t\t\tendTimeString = moment(now).add(15, 'minutes').format(defaultTimeFormat);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tendTimeString = moment(endDateInstance).add(30, 'minutes').format(defaultTimeFormat);\n\t\t\t}\n\t\t\tdata.find('[name=\"date_start\"]').val(startDateString);\n\t\t\tdata.find('[name=\"due_date\"]').val(endDateString);\n\t\t\tdata.find('[name=\"time_start\"]').val(startTimeString);\n\t\t\tdata.find('[name=\"time_end\"]').val(endTimeString);\n\n\t\t\tApp.Components.QuickCreate.showModal(data, {\n\t\t\t\tcallbackFunction(data) {\n\t\t\t\t\tself.addCalendarEvent(data.result, dateFormat);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n};\n"],"names":["window","Calendar_Js","$","readonly","browserHistory","calendarView","calendarCreateView","container","eventCreate","app","getMainParams","eventEdit","sidebarView","length","browserHistoryConfig","setBrowserHistoryOptions","calendarOptions","setCalendarOptions","eventTypeKeyName","module","getModuleName","assign","setCalendarBasicOptions","setCalendarAdvancedOptions","setCalendarModuleOptions","userDefaultActivityView","defaultView","moduleCacheGet","userDefaultTimeFormat","CONFIG","hourFormat","eventLimit","parseInt","timeFormat","slotLabelFormat","slotMinutes","defaultEventMinutes","forceEventDuration","defaultTimedEventDuration","eventLimitText","vtranslate","selectHelper","scrollTime","monthNamesShort","App","Fields","Date","monthsTranslated","dayNames","fullDaysTranslated","buttonText","today","year","month","week","day","allDayText","moment","valueOf","e","options","defaultDate","s","format","setCalendarMinimalOptions","partOfDate","formatDate","dateFormat","hiddenDays","firstDay","firstDayOfWeekNo","selectable","monthNames","fullMonthsTranslated","dayNamesShort","daysTranslated","editable","header","left","center","right","allDaySlot","views","basic","titleFormat","parseDateFormat","eventDrop","event","delta","revertFunc","self","updateEvent","eventResize","viewRender","loadCalendarData","eventRender","eventRenderer","height","setCalendarHeight","jQuery","progressIndicator","blockInfo","enabled","start","params","action","mode","id","_data","allDay","AppConnector","request","done","response","popoverCache","showNotify","text","type","progressInstance","fail","element","find","html","title","rendering","append","icon","addClass","attr","registerPopoverEllipsis","width","calendarContainer","calendarPadding","hasClass","outerHeight","css","replace","offset","top","fullCalendar","setCalendarH","historyParams","Object","keys","end","user","split","map","x","time","parsedValue","cvid","viewType","toUpperCase","forEach","key","moduleCacheSet","setMainParams","addEventListener","aDeferred","Deferred","sideBar","thisInstance","getSidebarView","resolve","promise","each","_","row","dataset","url","data","formContainer","registerUsersChange","Picklist","showSelect2ElementView","showNewScrollbar","suppressScrollX","registerFilterForm","on","findElementOnList","bind","name","cachedValue","prop","val","i","option","allOptions","push","off","currentTarget","value","item","is","getCalendarView","view","loadView","registerFilters","registerSitebarEvents","renderCalendar","registerButtonSelectAll","registerAddButton","registerSelect2Event","defaultParams","getDefaultParams","emptyFilters","events","result","hide","parent","getCurrentCvId","users","userId","filters","cacheName","selectsElements","selectBtn","deselectAllLabel","selectAllLabel","removeClass","closest","trigger","getCalendarCreateView","Components","QuickCreate","showModal","callbackFunction","addCalendarEvent","clone","loadCalendarCreateView","moduleName","getForm","textStatus","errorThrown","reject","calendarDetails","eventObject","_recordId","_recordLabel","calendar","date_start","time_start","due_date","time_end","start_display","display_value","end_display","className","assigned_user_id","allday","add","inArray","ownerSelects","refreshFilterValues","calendarTypes","setEventTypeKey","keyName","endsWith","filtersValues","searchShowOwnerOnlyInList","usersData","filterGroups","filterUsers","groupsData","isNewEventToDisplay","getEventRenderData","Calendar_Unselectable_Js","dayClick","date","registerDayClickEvent","defaultTimeFormat","parse","startDateString","startTimeString","endDateInstance","endDateString","endTimeString","startDateInstance","explodedTime","defaultFirstHour","defaultLastHour","now"],"mappings":"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"}