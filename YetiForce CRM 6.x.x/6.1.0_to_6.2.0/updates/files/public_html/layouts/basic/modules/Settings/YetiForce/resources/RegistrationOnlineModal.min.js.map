{"version":3,"file":"RegistrationOnlineModal.min.js","sources":["RegistrationOnlineModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_YetiForce_RegistrationOnlineModal_Js',\n\t{\n\t\t/**\n\t\t * Register events for form checkbox element\n\t\t */\n\t\tregisterNewsletter() {\n\t\t\tconst form = $('[data-view=\"RegistrationOnlineModal\"]').find('form');\n\t\t\tform.find('[id$=\"newsletter\"]').on('click', (e) => {\n\t\t\t\tlet inputsContainer = $(e.target).closest('.js-card-body');\n\t\t\t\tif ($(e.target).prop('checked')) {\n\t\t\t\t\tinputsContainer.find('[id$=\"firstname]\"]').attr('data-validation-engine', 'validate[required]');\n\t\t\t\t\tinputsContainer.find('[id$=\"lastname]\"]').attr('data-validation-engine', 'validate[required]');\n\t\t\t\t\tinputsContainer.find('[id$=\"email]\"]').attr('data-validation-engine', 'validate[required,custom[email]]');\n\t\t\t\t\tinputsContainer.find('.js-newsletter-content').removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tinputsContainer.find('[id$=\"firstname]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('[id$=\"lastname]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('[id$=\"email]\"]').removeAttr('data-validation-engine').val('');\n\t\t\t\t\tinputsContainer.find('.js-newsletter-content').addClass('d-none');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetCompanies(form) {\n\t\t\tlet companies = [];\n\t\t\tform.each(function () {\n\t\t\t\tcompanies.push($(this).serializeFormData());\n\t\t\t});\n\t\t\treturn companies;\n\t\t},\n\t\tregisterEvents() {\n\t\t\tconst self = this;\n\t\t\tconst container = $(\"[data-view='RegistrationOnlineModal']\");\n\t\t\tconst form = container.find('form');\n\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\tform.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcontainer.find('[name=\"saveButton\"]').click();\n\t\t\t});\n\t\t\tcontainer.find('[name=\"saveButton\"]').on('click', function (e) {\n\t\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate('JS_ENTER_ALL_REGISTRATION_DATA'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tcontainer.find('button[name=saveButton]').prop('disabled', true);\n\t\t\t\tlet progress = $.progressIndicator({\n\t\t\t\t\tmessage: app.vtranslate('JS_LOADING_PLEASE_WAIT'),\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'YetiForce',\n\t\t\t\t\tparent: 'Settings',\n\t\t\t\t\taction: 'Register',\n\t\t\t\t\tmode: 'online',\n\t\t\t\t\tcompanies: self.getCompanies(form)\n\t\t\t\t})\n\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: data['result']['message'],\n\t\t\t\t\t\t\ttype: data['result']['type']\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tif (data['result']['type'] === 'success') {\n\t\t\t\t\t\t\tlet href = location.href.replace('displayModal=online', '');\n\t\t\t\t\t\t\tlocation.replace(href);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontainer.find('button[name=saveButton]').prop('disabled', false);\n\t\t\t\t\t\treturn data['result'];\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function (error, title) {\n\t\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\ttext: error,\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tthis.registerNewsletter();\n\t\t}\n\t},\n\t{}\n);\nSettings_YetiForce_RegistrationOnlineModal_Js.registerEvents();\n"],"names":["jQuery","Class","registerNewsletter","$","find","form","on","e","target","closest","prop","inputsContainer","attr","removeClass","removeAttr","val","addClass","getCompanies","each","companies","push","serializeFormData","registerEvents","container","validationEngine","app","validationEngineOptions","preventDefault","click","showNotify","text","vtranslate","type","progressIndicator","message","blockInfo","enabled","AppConnector","request","module","parent","action","mode","self","done","data","progress","location","href","replace","fail","error","title","Settings_YetiForce_RegistrationOnlineModal_Js"],"mappings":"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"}