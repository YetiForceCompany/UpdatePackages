{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_AutomaticAssignment_Edit_Js',\n\t{},\n\t{\n\t\tcontainer: false,\n\t\tadvanceFilterInstance: false,\n\t\tgetContainer: function () {\n\t\t\tif (this.container == false) {\n\t\t\t\tthis.container = jQuery('div.contentsDiv');\n\t\t\t}\n\t\t\treturn this.container;\n\t\t},\n\t\tregisterBasicEvents: function (container) {\n\t\t\tvar thisInstance = this;\n\n\t\t\tvar advanceFilterContainer = container.find('.filterContainer');\n\t\t\tif (advanceFilterContainer.length) {\n\t\t\t\tthis.advanceFilterInstance = Vtiger_AdvanceFilter_Js.getInstance(advanceFilterContainer);\n\t\t\t}\n\t\t\tvar form = container.find('form');\n\t\t\tif (form.length) {\n\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t\tform.find('[data-inputmask]').inputmask();\n\t\t\t}\n\t\t\tcontainer.find('.select2noactive').each(function (index, domElement) {\n\t\t\t\tvar select = $(domElement);\n\t\t\t\tif (!select.data('select2')) {\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(select, {\n\t\t\t\t\t\tplaceholder: app.vtranslate('JS_SELECT_AN_OPTION')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar table = app.registerDataTables(container.find('.dataTable'));\n\t\t\tif (table) {\n\t\t\t\ttable.$('.changeRoleType').on('click', function (e) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\t\tvar dataElement = element.closest('tr');\n\t\t\t\t\tapp\n\t\t\t\t\t\t.saveAjax('changeRoleType', dataElement.data('value'), {\n\t\t\t\t\t\t\trecord: app.getMainParams('record')\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\ttable.$('.delete').on('click', function (e) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\t\tvar dataElement = element.closest('tr');\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\trecord: app.getMainParams('record'),\n\t\t\t\t\t\tvalue: dataElement.data('value'),\n\t\t\t\t\t\tname: dataElement.data('name')\n\t\t\t\t\t};\n\t\t\t\t\tapp.saveAjax('deleteElement', null, params).done(function (data) {\n\t\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\tcontainer.find('.fieldContainer').on('click', function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t});\n\n\t\t\tcontainer.find('.saveValue').on('click', function (e) {\n\t\t\t\tlet button = jQuery(e.currentTarget),\n\t\t\t\t\tfieldContainer = button.closest('.fieldContainer'),\n\t\t\t\t\tbaseFieldName = fieldContainer.data('dbname'),\n\t\t\t\t\tvalue = '';\n\t\t\t\tif (baseFieldName === 'conditions') {\n\t\t\t\t\tlet advfilterlist = thisInstance.advanceFilterInstance.getValues();\n\t\t\t\t\tvalue = JSON.stringify(advfilterlist);\n\t\t\t\t} else {\n\t\t\t\t\tlet fieldName = fieldContainer.data('name'),\n\t\t\t\t\t\tfieldElement = fieldContainer.find('[name=\"' + fieldName + '\"]');\n\t\t\t\t\tif (fieldElement.validationEngine('validate')) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tvalue = fieldElement.val();\n\t\t\t\t}\n\n\t\t\t\tlet params = [];\n\t\t\t\tparams[baseFieldName] = value;\n\t\t\t\tapp.saveAjax('save', jQuery.extend({}, params), { record: app.getMainParams('record') }).done(function () {\n\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t});\n\t\t\t});\n\t\t\tcontainer.find('.js-switch').on('change', (e) => {\n\t\t\t\tconst currentTarget = $(e.currentTarget),\n\t\t\t\t\tstate = currentTarget.val();\n\t\t\t\tlet params = [];\n\t\t\t\tif (currentTarget.hasClass('noField')) {\n\t\t\t\t\tif (state === '1') {\n\t\t\t\t\t\tcurrentTarget.closest('form').find('.fieldToShowHide').removeClass('d-none');\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (state === '0') {\n\t\t\t\t\t\tcurrentTarget.closest('form').find('.fieldToShowHide').addClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparams[currentTarget.attr('name')] = Number(state);\n\t\t\t\tapp\n\t\t\t\t\t.saveAjax('save', jQuery.extend({}, params), { record: app.getMainParams('record') })\n\t\t\t\t\t.done(function (respons) {\n\t\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\trefreshTab: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tSettings_Vtiger_Index_Js.showMessage({ text: app.vtranslate('JS_SAVE_SUCCESS') });\n\t\t\tvar tabContainer = this.getContainer().find('.tab-pane.active');\n\t\t\tif (tabContainer.hasClass('noRefresh')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tAppConnector.request(tabContainer.data('url'))\n\t\t\t\t.done(function (data) {\n\t\t\t\t\ttabContainer.html(data);\n\t\t\t\t\tthisInstance.registerBasicEvents(tabContainer);\n\t\t\t\t})\n\t\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis.registerBasicEvents(this.getContainer());\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","container","advanceFilterInstance","getContainer","registerBasicEvents","advanceFilterContainer","find","length","Vtiger_AdvanceFilter_Js","getInstance","form","validationEngine","app","validationEngineOptions","inputmask","each","index","domElement","$","select","data","App","Fields","Picklist","showSelect2ElementView","placeholder","vtranslate","registerDataTables","table","on","e","stopPropagation","preventDefault","currentTarget","dataElement","element","closest","saveAjax","record","getMainParams","done","thisInstance","refreshTab","params","value","name","fieldContainer","button","baseFieldName","getValues","JSON","stringify","advfilterlist","fieldElement","fieldName","val","extend","state","hasClass","removeClass","addClass","attr","Number","Settings_Vtiger_Index_Js","showMessage","text","tabContainer","request","html","fail","textStatus","errorThrown","errorLog","registerEvents"],"mappings":"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"}