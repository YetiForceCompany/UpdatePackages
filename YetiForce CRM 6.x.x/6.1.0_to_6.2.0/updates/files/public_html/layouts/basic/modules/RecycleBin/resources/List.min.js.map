{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_List_Js(\n\t'RecycleBin_List_Js',\n\t{\n\t\t/**\n\t\t * Mass activation trigerred on the list\n\t\t */\n\t\tmassActivation: function () {\n\t\t\tconst self = this;\n\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\tmessage: app.vtranslate('JS_ACTIVATE_RECORD_DESC'),\n\t\t\t\ttitle: app.vtranslate('JS_MASS_ACTIVATE')\n\t\t\t}).done(function (e) {\n\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\tparams.state = 'Active';\n\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\tparams.action = 'MassState';\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t}\n\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Mass delete trigerred on the list\n\t\t */\n\t\tmassDelete: function () {\n\t\t\tconst self = this;\n\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\tmessage: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\ttitle: app.vtranslate('JS_MASS_DELETE')\n\t\t\t}).done(function (e) {\n\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\tparams.sourceModule = container.find('.js-source-module').val();\n\t\t\t\tparams.action = 'MassDelete';\n\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\tparams.viewname = 'undefined';\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t}\n\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t/**\n\t\t * Register module select\n\t\t */\n\t\tregisterModuleFilter: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tlet filterSelectElement = container.find('.js-source-module');\n\t\t\tfilterSelectElement.on('select2:selecting', function (e) {\n\t\t\t\tself\n\t\t\t\t\t.getListViewRecords({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\tsourceModule: e.params.args.data.id\n\t\t\t\t\t})\n\t\t\t\t\t.done(function () {\n\t\t\t\t\t\tself.calculatePages().done(function () {\n\t\t\t\t\t\t\tcontainer.find('.js-pagination-list').data('totalCount', 0);\n\t\t\t\t\t\t\tself.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to update pagination page numer\n\t\t * @param {boolean} force\n\t\t */\n\t\tupdatePaginationAjax(force = false) {\n\t\t\tconst self = this,\n\t\t\t\tlistViewPageDiv = this.getListViewContainer();\n\t\t\tlet params = self.getDefaultParams(),\n\t\t\t\tcontainer = listViewPageDiv.find('.paginationDiv');\n\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\ttext: app.vtranslate('JS_GET_PAGINATION_INFO'),\n\t\t\t\ttype: 'info'\n\t\t\t});\n\t\t\tif (container.find('.js-pagination-list').data('total-count') > 0 || force) {\n\t\t\t\tparams.totalCount = '-1';\n\t\t\t\tparams.view = 'Pagination';\n\t\t\t\tparams.mode = 'getPagination';\n\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\tparams.module = listViewPageDiv.find('.js-source-module').val();\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tcontainer.html(data);\n\t\t\t\t\tself.registerPageNavigationEvents();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Register empty recycle button\n\t\t */\n\t\tregisterEmptyRecycle: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tcontainer.find('.js-recycle-empty').on('click', function () {\n\t\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\t\tmessage: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\t\ttitle: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD')\n\t\t\t\t}).done(function (e) {\n\t\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\tmodule: 'RecycleBin',\n\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val(),\n\t\t\t\t\t\taction: 'MassDeleteAll',\n\t\t\t\t\t\tsourceView: 'List'\n\t\t\t\t\t})\n\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\tlet result = {\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_FAILED_TO_SAVE')\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (data && data.result) {\n\t\t\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ADDED_TO_QUEUE'),\n\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(result);\n\t\t\t\t\t\t\tself.getListViewRecords();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Get record list of actual selected module\n\t\t * @param {string} urlParams\n\t\t * @returns {*|jQuery}\n\t\t */\n\t\tgetListViewRecords: function (urlParams) {\n\t\t\tlet overrideUrlParams = {},\n\t\t\t\taDeferred = $.Deferred();\n\t\t\toverrideUrlParams.sourceModule = $('.js-source-module').val();\n\t\t\turlParams = $.extend(overrideUrlParams, urlParams);\n\t\t\tthis._super(urlParams)\n\t\t\t\t.done(function () {\n\t\t\t\t\taDeferred.resolve();\n\t\t\t\t})\n\t\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerModuleFilter();\n\t\t\tthis.registerEmptyRecycle();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","massActivation","Vtiger_Helper_Js","showConfirmationBox","message","app","vtranslate","title","done","self","getSelectedRecordsParams","listInstance","getInstance","container","getListViewContainer","params","module","find","val","state","entityState","action","AppConnector","request","data","result","notify","showMessage","getListViewRecords","getModuleName","view","sourceModule","massDelete","viewname","registerModuleFilter","filterSelectElement","on","e","args","id","calculatePages","updatePagination","updatePaginationAjax","listViewPageDiv","getDefaultParams","text","type","force","totalCount","mode","html","registerPageNavigationEvents","registerEmptyRecycle","$","progressIndicator","sourceView","progressIndicatorElement","fail","urlParams","aDeferred","Deferred","extend","overrideUrlParams","_super","resolve","textStatus","errorThrown","reject","promise","registerEvents"],"mappings":"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"}