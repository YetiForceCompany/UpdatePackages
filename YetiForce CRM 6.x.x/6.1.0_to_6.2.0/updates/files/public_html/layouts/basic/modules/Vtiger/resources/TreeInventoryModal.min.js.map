{"version":3,"file":"TreeInventoryModal.min.js","sources":["TreeInventoryModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_TreeInventoryModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Tree instance\n\t\t */\n\t\ttreeInstance: false,\n\t\t/**\n\t\t * Set event for select row\n\t\t * @param {function} cb\n\t\t */\n\t\tsetSelectEvent: function (cb) {\n\t\t\tthis.selectEvent = cb;\n\t\t},\n\t\t/**\n\t\t * Gets tree data\n\t\t */\n\t\tgetTreeData: function () {\n\t\t\tlet treeData = this.container.find('.js-tree-value').val();\n\t\t\treturn treeData ? JSON.parse(treeData) : [];\n\t\t},\n\n\t\t/*\n\t\t * Function generates a tree.\n\t\t */\n\t\tgenerateTree: function () {\n\t\t\tif (this.treeInstance == false) {\n\t\t\t\tthis.treeInstance = this.container.find('.js-tree-contents');\n\t\t\t\tlet plugins = ['search', 'category', 'checkbox'];\n\t\t\t\tthis.treeInstance.jstree(\n\t\t\t\t\t$.extend(\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcore: {\n\t\t\t\t\t\t\t\tdata: this.getTreeData(),\n\t\t\t\t\t\t\t\tthemes: {\n\t\t\t\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcheckbox: {\n\t\t\t\t\t\t\t\tthree_state: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tplugins: plugins\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis.treeInstance.data('params')\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * Function looks up the entered phrases.\n\t\t */\n\t\tsearching: function (text) {\n\t\t\tthis.treeInstance.jstree(true).search(text);\n\t\t},\n\n\t\t/*\n\t\t * Function retrieves the search terms.\n\t\t */\n\t\tregisterSearchEvent: function () {\n\t\t\tlet valueSearch = this.container.find('#valueSearchTree');\n\t\t\tlet btnSearch = this.container.find('#btnSearchTree');\n\t\t\tvalueSearch.on('keypress', (e) => {\n\t\t\t\tif (e.which == 13) {\n\t\t\t\t\tthis.searching(valueSearch.val());\n\t\t\t\t}\n\t\t\t});\n\t\t\tbtnSearch.on('click', () => {\n\t\t\t\tthis.searching(valueSearch.val());\n\t\t\t});\n\t\t},\n\n\t\t/*\n\t\t * Function retrieves the selected records.\n\t\t */\n\t\tregisterSelectRecords: function () {\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\tlet recordsToAdd = [];\n\t\t\t\t$.each(this.treeInstance.jstree('getCategory', true), function (_, treeElement) {\n\t\t\t\t\tif (treeElement.attr === 'record') {\n\t\t\t\t\t\trecordsToAdd[treeElement.record_id] = treeElement.text;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (recordsToAdd.length) {\n\t\t\t\t\tthis.selectEvent(recordsToAdd);\n\t\t\t\t\tapp.hideModalWindow(false, this.container.parent().attr('id'));\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_PLEASE_SELECT_ONE_RECORD') });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register modal events\n\t\t */\n\t\tregisterEvents: function (container) {\n\t\t\tthis.container = container;\n\t\t\tthis.generateTree();\n\t\t\tthis.registerSelectRecords();\n\t\t\tthis.registerSearchEvent();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","treeInstance","setSelectEvent","cb","selectEvent","getTreeData","find","val","JSON","parse","treeData","generateTree","jstree","extend","core","data","themes","name","responsive","checkbox","three_state","plugins","searching","text","search","registerSearchEvent","valueSearch","btnSearch","on","e","which","registerSelectRecords","each","_","treeElement","attr","recordsToAdd","record_id","length","app","hideModalWindow","parent","showNotify","vtranslate","registerEvents"],"mappings":";;AAGAA,EAAEC,KAAF,CACC,4BADD,CAEC,EAFD,CAGC;;KAICC,YAJD;;KAQCC,eARD;;;KAaCC,eAAgB,wBAAUC,EAAV,CAAc,CAC7B,KAAKC,WAAL,CAAmBD,GACnB,CAfF;;KAmBCE,YAAa,sBAAY,CACxB,aAAe,KAAKL,SAAL,CAAeM,IAAf,CAAoB,gBAApB,EAAsCC,GAAtC,EAAf,CACA,gBAAkBC,KAAKC,KAAL,CAAWC,QAAX,CAAX,CAAkC,EACzC,CAtBF;;KA2BCC,aAAc,uBAAY,CACzB,GAAI,SAAKV,YAAT,CAAgC,CAC/B,KAAKA,YAAL,CAAoB,KAAKD,SAAL,CAAeM,IAAf,CAAoB,mBAApB,CADW,CAG/B,KAAKL,YAAL,CAAkBW,MAAlB,CACCd,EAAEe,MAAF,IAEC,CACCC,KAAM,CACLC,KAAM,KAAKV,WAAL,EADD,CAELW,OAAQ,CACPC,KAAM,QADC,CAEPC,aAFO,CAFH,CADP,CAQCC,SAAU,CACTC,cADS,CARX,CAWCC,QAfW,CAAC,QAAD,CAAW,UAAX,CAAuB,UAAvB,CAIZ,CAFD,CAeC,KAAKpB,YAAL,CAAkBc,IAAlB,CAAuB,QAAvB,CAfD,CADD,EAmBA,CACD,CAnDF;;KAwDCO,UAAW,mBAAUC,IAAV,CAAgB,CAC1B,KAAKtB,YAAL,CAAkBW,MAAlB,KAA+BY,MAA/B,CAAsCD,IAAtC,EACA,CA1DF;;KA+DCE,oBAAqB,8BAAY,gBAC5BC,YAAc,KAAK1B,SAAL,CAAeM,IAAf,CAAoB,kBAApB,CADc,CAE5BqB,UAAY,KAAK3B,SAAL,CAAeM,IAAf,CAAoB,gBAApB,CAFgB,CAGhCoB,YAAYE,EAAZ,CAAe,UAAf,CAA2B,SAACC,CAAD,CAAO,CAClB,EAAX,IAAEC,KAD2B,EAEhC,MAAKR,SAAL,CAAeI,YAAYnB,GAAZ,EAAf,EAED,CAJD,CAHgC,CAQhCoB,UAAUC,EAAV,CAAa,OAAb,CAAsB,UAAM,CAC3B,MAAKN,SAAL,CAAeI,YAAYnB,GAAZ,EAAf,EACA,CAFD,EAGA,CA1EF;;KA+ECwB,sBAAuB,gCAAY,iBAClC,KAAK/B,SAAL,CAAeM,IAAf,CAAoB,iBAApB,EAAuCsB,EAAvC,CAA0C,OAA1C,CAAmD,UAAO,CACzD,iBAAmB,EAAnB,CACA9B,EAAEkC,IAAF,CAAO,OAAK/B,YAAL,CAAkBW,MAAlB,CAAyB,aAAzB,IAAP,CAAsD,SAAUqB,CAAV,CAAaC,WAAb,CAA0B,CACtD,QAArB,eAAYC,IAD+D,GAE9EC,aAAaF,YAAYG,SAAzB,EAAsCH,YAAYX,IAF4B,EAI/E,CAJD,CAFyD,CAOrDa,aAAaE,MAPwC,EAQxD,OAAKlC,WAAL,CAAiBgC,YAAjB,CARwD,CASxDG,IAAIC,eAAJ,IAA2B,OAAKxC,SAAL,CAAeyC,MAAf,GAAwBN,IAAxB,CAA6B,IAA7B,CAA3B,CATwD,EAWxDI,IAAIG,UAAJ,CAAe,CAAEnB,KAAMgB,IAAII,UAAJ,CAAe,6BAAf,CAAR,CAAf,EAED,CAbD,EAcA,CA9FF;;KAmGCC,eAAgB,wBAAU5C,SAAV,CAAqB,CACpC,KAAKA,SAAL,CAAiBA,SADmB,CAEpC,KAAKW,YAAL,EAFoC,CAGpC,KAAKoB,qBAAL,EAHoC,CAIpC,KAAKN,mBAAL,GACA,CAxGF,CAHD"}