{"version":3,"file":"CalendarView.min.js","sources":["CalendarView.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\nwindow.Occurrences_Calendar_Js = class Occurrences_Calendar_Js extends Vtiger_Calendar_Js {\n\t/**\n\t * Register day click event.\n\t * @param {string} date\n\t */\n\tregisterDayClickEvent(date) {\n\t\tlet self = this;\n\t\tself.getCalendarCreateView().done(function (data) {\n\t\t\tif (data.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet dateElement = data.find('[name=\"date_start\"]');\n\t\t\tlet dateFormat = dateElement.data('dateFormat').toUpperCase(),\n\t\t\t\ttimeFormat = dateElement.data('hour-format'),\n\t\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t\tif (timeFormat == 24) {\n\t\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t\t}\n\t\t\tlet startDateInstance = Date.parse(date);\n\t\t\tlet startDateString = moment(date).format(dateFormat);\n\t\t\tlet startTimeString = moment(date).format(defaultTimeFormat);\n\t\t\tlet endDateInstance = Date.parse(date);\n\t\t\tlet endDateString = moment(date).format(dateFormat);\n\n\t\t\tlet view = self.getCalendarView().fullCalendar('getView');\n\t\t\tlet endTimeString;\n\t\t\tif ('month' == view.name) {\n\t\t\t\tlet diffDays = parseInt((endDateInstance - startDateInstance) / (1000 * 60 * 60 * 24));\n\t\t\t\tif (diffDays > 1) {\n\t\t\t\t\tlet defaultFirstHour = app.getMainParams('startHour');\n\t\t\t\t\tlet explodedTime = defaultFirstHour.split(':');\n\t\t\t\t\tstartTimeString = explodedTime['0'];\n\t\t\t\t\tlet defaultLastHour = app.getMainParams('endHour');\n\t\t\t\t\texplodedTime = defaultLastHour.split(':');\n\t\t\t\t\tendTimeString = explodedTime['0'];\n\t\t\t\t} else {\n\t\t\t\t\tlet now = new Date();\n\t\t\t\t\tstartTimeString = moment(now).format(defaultTimeFormat);\n\t\t\t\t\tendTimeString = moment(now).add(15, 'minutes').format(defaultTimeFormat);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tendTimeString = moment(endDateInstance).add(30, 'minutes').format(defaultTimeFormat);\n\t\t\t}\n\t\t\tdata.find('[name=\"date_start\"]').val(startDateString + ' ' + startTimeString);\n\t\t\tdata.find('[name=\"date_end\"]').val(endDateString + ' ' + endTimeString);\n\n\t\t\tApp.Components.QuickCreate.showModal(data, {\n\t\t\t\tcallbackFunction(data) {\n\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n};\n"],"names":["window","Occurrences_Calendar_Js","date","self","getCalendarCreateView","done","data","length","find","dateFormat","dateElement","toUpperCase","timeFormat","defaultTimeFormat","Date","parse","startDateString","moment","format","startTimeString","endDateInstance","endDateString","view","getCalendarView","fullCalendar","endTimeString","name","parseInt","startDateInstance","app","getMainParams","explodedTime","defaultFirstHour","split","defaultLastHour","now","add","val","App","Components","QuickCreate","showModal","callbackFunction","loadCalendarData","Vtiger_Calendar_Js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEAA,OAAOC,uBAAP;;;IAAA,qCAKuBC,IALvB,CAK6B,CAC3B,SAAW,IAAX,CACAC,KAAKC,qBAAL,GAA6BC,IAA7B,CAAkC,SAAUC,IAAV,CAAgB,CACjD,KAAmB,CAAf,OAAKC,MAAT,mBAGkBD,KAAKE,IAAL,CAAU,qBAAV,CAHlB,CAIIC,WAAaC,YAAYJ,IAAZ,CAAiB,YAAjB,EAA+BK,WAA/B,EAJjB,CAKCC,WAAaF,YAAYJ,IAAZ,CAAiB,aAAjB,CALd,CAMCO,kBAAoB,SANrB,CAOkB,EAAd,YAPJ,GAQCA,kBAAoB,OARrB,wBAUwBC,KAAKC,KAAL,CAAWb,IAAX,CAVxB,CAWIc,gBAAkBC,OAAOf,IAAP,EAAagB,MAAb,CAAoBT,UAApB,CAXtB,CAYIU,gBAAkBF,OAAOf,IAAP,EAAagB,MAAb,CAAoBL,iBAApB,CAZtB,CAaIO,gBAAkBN,KAAKC,KAAL,CAAWb,IAAX,CAbtB,CAcImB,cAAgBJ,OAAOf,IAAP,EAAagB,MAAb,CAAoBT,UAApB,CAdpB,CAgBIa,KAAOnB,KAAKoB,eAAL,GAAuBC,YAAvB,CAAoC,SAApC,CAhBX,CAiBIC,oBAjBJ,CAkBA,GAAI,SAAWH,KAAKI,IAApB,CAA0B,CACzB,aAAeC,SAAS,CAACP,gBAAkBQ,iBAAnB,UAAT,CAAf,CACA,GAAe,CAAX,SAAJ,CAAkB,sBACMC,IAAIC,aAAJ,CAAkB,WAAlB,CADN,CAEbC,aAAeC,iBAAiBC,KAAjB,CAAuB,GAAvB,CAFF,CAGjBd,gBAAkBY,eAHD,CAIjB,oBAAsBF,IAAIC,aAAJ,CAAkB,SAAlB,CAAtB,CACAC,aAAeG,gBAAgBD,KAAhB,CAAsB,GAAtB,CALE,CAMjBR,cAAgBM,gBAChB,CAPD,KAOO,CACN,QAAU,QAAV,CACAZ,gBAAkBF,OAAOkB,GAAP,EAAYjB,MAAZ,CAAmBL,iBAAnB,CAFZ,CAGNY,cAAgBR,OAAOkB,GAAP,EAAYC,GAAZ,CAAgB,EAAhB,CAAoB,SAApB,EAA+BlB,MAA/B,CAAsCL,iBAAtC,EAChB,CACD,CAdD,mBAeiBI,OAAOG,eAAP,EAAwBgB,GAAxB,CAA4B,EAA5B,CAAgC,SAAhC,EAA2ClB,MAA3C,CAAkDL,iBAAlD,CAfjB,CAiBAP,KAAKE,IAAL,CAAU,qBAAV,EAAiC6B,GAAjC,CAAqCrB,gBAAkB,GAAlB,CAAwBG,eAA7D,CAnCA,CAoCAb,KAAKE,IAAL,CAAU,mBAAV,EAA+B6B,GAA/B,CAAmChB,cAAgB,GAAhB,CAAsBI,aAAzD,CApCA,CAsCAa,IAAIC,UAAJ,CAAeC,WAAf,CAA2BC,SAA3B,CAAqCnC,IAArC,CAA2C,CAC1CoC,gBAD0C,4BACnB,CACtBvC,KAAKwC,gBAAL,GACA,CAHyC,CAA3C,EAtCA,CA2CA,CA5CD,EA6CA,CApDF,6BAAuEC,kBAAvE"}