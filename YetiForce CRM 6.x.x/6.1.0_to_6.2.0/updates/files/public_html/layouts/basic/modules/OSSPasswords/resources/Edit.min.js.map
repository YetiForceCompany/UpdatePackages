{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_Edit_Js(\n\t'OSSPasswords_Edit_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to register recordpresave event\n\t\t */\n\t\tregisterRecordPreSaveEvent: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tif (typeof form === 'undefined') {\n\t\t\t\tform = this.getForm();\n\t\t\t}\n\t\t\tform.on(Vtiger_Edit_Js.recordPreSave, function (e, data) {\n\t\t\t\tvar password = form.find('[name=\"password\"]').val();\n\t\t\t\tvar id = form.find('[name=\"record\"]').val();\n\t\t\t\tvar params = {};\n\t\t\t\tif (password === '**********') {\n\t\t\t\t\tparams = {};\n\t\t\t\t\tparams.data = {\n\t\t\t\t\t\tmodule: 'OSSPasswords',\n\t\t\t\t\t\taction: 'GetPass',\n\t\t\t\t\t\trecord: id\n\t\t\t\t\t};\n\t\t\t\t\tparams.async = false;\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tvar response = data['result'];\n\t\t\t\t\t\tif (response['success']) {\n\t\t\t\t\t\t\tvar el = document.getElementById('OSSPasswords_editView_fieldName_password');\n\t\t\t\t\t\t\tel.value = response['password'];\n\t\t\t\t\t\t\tel.onchange();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// validate password\n\t\t\t\t\tPasswordHelper.passwordStrength('', '');\n\t\t\t\t}\n\t\t\t\tpassword = form.find('[name=\"password\"]').val();\n\t\t\t\tparams = {};\n\t\t\t\tparams.data = { module: 'OSSPasswords', action: 'CheckPass', password: password, id: id };\n\t\t\t\tparams.async = false;\n\t\t\t\tparams.dataType = 'json';\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tif (data.result.success === false) {\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\t\tsticker: false,\n\t\t\t\t\t\t\tsticker_hover: false,\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t};\n\t\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t\t\tthisInstance.sending = false;\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t} else if (data.result.success === true && (thisInstance.sending === undefined || !thisInstance.sending)) {\n\t\t\t\t\t\tthisInstance.sending = true;\n\t\t\t\t\t} else if (thisInstance.sending) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tgeneratePassword: function (e) {\n\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\tvar form = element.closest('form');\n\t\t\tvar min = parseInt(jQuery('#minChars').val());\n\t\t\tvar max = parseInt(jQuery('#maxChars').val());\n\t\t\tvar allowedChars = jQuery('#allowedLetters').val();\n\t\t\tvar password = ''; // variable holding new password\n\t\t\t// array of allowed characters that will consist of password\n\t\t\t// if there there is something wrong build the password from only exclamation marks\n\t\t\tif (typeof allowedChars === 'undefined') allowedChars = '!';\n\t\t\tvar chArray = allowedChars.split(',');\n\t\t\t// min length of a password\n\t\t\tif (typeof min === 'undefined') min = 10; // default 10\n\t\t\t// max length of a password\n\t\t\tif (typeof max === 'undefined') max = 15; // default 15\n\t\t\t// get the password length\n\t\t\tvar passlength = parseInt(Math.random() * (max - min) + min);\n\t\t\tvar i = 0; // index for the loop\n\t\t\t// loop to get random string with *pass_length* characters\n\t\t\tfor (i = 0; i <= passlength; i++) {\n\t\t\t\tvar charIndex = parseInt(Math.random() * chArray.length);\n\t\t\t\tpassword += chArray[charIndex];\n\t\t\t}\n\t\t\t// get desired text field\n\t\t\tvar passForm = form.find('[name =\"password\"]');\n\t\t\t// change its value to the generated password\n\t\t\tpassForm.val(password);\n\t\t\tpassForm.trigger('change');\n\t\t},\n\t\tregisterButtonsEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\t$('.js-generatePass').on('click', function (e) {\n\t\t\t\tthisInstance.generatePassword(e);\n\t\t\t});\n\t\t},\n\t\tregisterBasicEvents: function (container) {\n\t\t\tthis._super(container);\n\t\t\tthis.registerButtonsEvents();\n\t\t\tthis.registerRecordPreSaveEvent(container);\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Edit_Js","registerRecordPreSaveEvent","form","getForm","on","recordPreSave","e","find","val","id","params","data","module","action","record","async","AppConnector","request","done","response","document","getElementById","el","value","onchange","PasswordHelper","passwordStrength","password","dataType","result","success","text","message","sticker","sticker_hover","type","app","showNotify","thisInstance","sending","preventDefault","stopPropagation","generatePassword","jQuery","currentTarget","element","closest","min","parseInt","max","allowedChars","split","Math","random","i","passlength","chArray","length","charIndex","passForm","trigger","registerButtonsEvents","$","registerBasicEvents","container","_super"],"mappings":"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"}