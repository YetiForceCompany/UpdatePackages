{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_Edit_Js(\n\t'OSSTimeControl_Edit_Js',\n\t{},\n\t{\n\t\tregisterGenerateTCFieldTimeAndCost: function () {\n\t\t\tvar thisInstance = this;\n\t\t\t$('input[name=\"sum_time\"]').attr('readonly', 'readonly').css('width', '80px');\n\t\t\tvar form = thisInstance.getForm();\n\t\t\tvar sumeTime = thisInstance.differenceDays(form);\n\t\t\tvar hours = (Math.ceil((sumeTime / 3600000) * 100) / 100).toFixed(2);\n\n\t\t\tjQuery('input[name=\"sum_time\"]').val(hours);\n\t\t\tjQuery('.dateField').on('change', function () {\n\t\t\t\tsumeTime = thisInstance.differenceDays(form);\n\t\t\t\tif (sumeTime == 'Error') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\thours = (Math.ceil((sumeTime / 3600000) * 100) / 100).toFixed(2);\n\t\t\t\tjQuery('input[name=\"sum_time\"]').val(hours);\n\t\t\t});\n\t\t\tjQuery('.clockPicker').on('change', function () {\n\t\t\t\tsumeTime = thisInstance.differenceDays(form);\n\t\t\t\tif (sumeTime == 'Error') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\thours = (Math.round((sumeTime / 3600000) * 100) / 100).toFixed(2);\n\t\t\t\tjQuery('input[name=\"sum_time\"]').val(hours);\n\t\t\t});\n\t\t},\n\n\t\tdifferenceDays: function (container) {\n\t\t\tlet firstDate = container.find('input[name=\"date_start\"]');\n\t\t\tlet firstDateFormat = firstDate.data('date-format');\n\t\t\tlet firstDateValue = firstDate.val();\n\t\t\tlet secondDate = container.find('input[name=\"due_date\"]');\n\t\t\tlet secondDateFormat = secondDate.data('date-format');\n\t\t\tlet secondDateValue = secondDate.val();\n\t\t\tlet firstTime = container.find('input[name=\"time_start\"]');\n\t\t\tlet secondTime = container.find('input[name=\"time_end\"]');\n\t\t\tif (firstTime.length) {\n\t\t\t\tfirstDateValue = firstDateValue + ' ' + firstTime.val();\n\t\t\t}\n\t\t\tif (secondTime.length) {\n\t\t\t\tsecondDateValue = secondDateValue + ' ' + secondTime.val();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tlet firstDateInstance = Vtiger_Helper_Js.getDateInstance(firstDateValue, firstDateFormat);\n\t\t\t\tlet secondDateInstance = Vtiger_Helper_Js.getDateInstance(secondDateValue, secondDateFormat);\n\t\t\t\tlet timeBetweenDates = secondDateInstance - firstDateInstance;\n\t\t\t\tif (timeBetweenDates >= 0) {\n\t\t\t\t\treturn timeBetweenDates;\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\treturn 'Error';\n\t\t\t}\n\t\t\treturn 'Error';\n\t\t},\n\n\t\t/**\n\t\t * Function to register recordpresave event\n\t\t */\n\t\tregisterRecordPreSaveEvent: function (container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar form = $('form.js-form');\n\t\t\tif (form.length == 0) {\n\t\t\t\tform = this.getForm();\n\t\t\t}\n\t\t\tform.on(Vtiger_Edit_Js.recordPreSave, function (e, data) {\n\t\t\t\tvar sumeTime2 = thisInstance.differenceDays(form);\n\t\t\t\tif (sumeTime2 == 'Error') {\n\t\t\t\t\tvar parametres = {\n\t\t\t\t\t\ttext: app.vtranslate('JS_DATE_SHOULD_BE_GREATER_THAN'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tapp.showNotify(parametres);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tescapeRegExp: function (string) {\n\t\t\treturn string.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n\t\t},\n\t\treplaceAll: function (string, find, replace) {\n\t\t\tvar thisInstance = this;\n\t\t\tstring = string.replace(new RegExp(thisInstance.escapeRegExp('&Oacute;'), 'g'), 'Ã“');\n\t\t\treturn string.replace(new RegExp(thisInstance.escapeRegExp(find), 'g'), replace);\n\t\t},\n\t\tregisterBasicEvents: function (container) {\n\t\t\tthis._super(container);\n\t\t\tthis.registerRecordPreSaveEvent(container);\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerGenerateTCFieldTimeAndCost();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Edit_Js","registerGenerateTCFieldTimeAndCost","$","attr","css","thisInstance","getForm","sumeTime","differenceDays","form","hours","Math","ceil","toFixed","jQuery","val","on","round","container","find","firstDateFormat","firstDate","data","firstDateValue","secondDate","secondDateFormat","secondDateValue","firstTime","secondTime","length","Vtiger_Helper_Js","getDateInstance","secondDateInstance","timeBetweenDates","firstDateInstance","err","registerRecordPreSaveEvent","recordPreSave","text","app","vtranslate","type","showNotify","parametres","escapeRegExp","string","replace","replaceAll","registerBasicEvents","_super","registerEvents"],"mappings":"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"}