{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\n\t'Users_Detail_Js',\n\t{\n\t\t/*\n\t\t * function to trigger delete record action\n\t\t * @params: delete record url.\n\t\t */\n\t\ttriggerDeleteUser: function (deleteUserUrl) {\n\t\t\tvar message = app.vtranslate('JS_DELETE_USER_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ message: message })\n\t\t\t\t.done(function (data) {\n\t\t\t\t\tAppConnector.request(deleteUserUrl).done(function (data) {\n\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\tvar callback = function (data) {\n\t\t\t\t\t\t\t\tvar params = app.validationEngineOptions;\n\t\t\t\t\t\t\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\t\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\t\t\t\tUsers_Detail_Js.deleteUser(form);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t$('#deleteUser').validationEngine(app.validationEngineOptions);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.showModalWindow(data, function (data) {\n\t\t\t\t\t\t\t\tif (typeof callback == 'function') {\n\t\t\t\t\t\t\t\t\tcallback(data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t});\n\t\t},\n\t\tdeleteUser: function (form) {\n\t\t\tvar userid = form.find('[name=\"userid\"]').val();\n\t\t\tvar transferUserId = form.find('[name=\"tranfer_owner_id\"]').val();\n\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'DeleteAjax',\n\t\t\t\tmode: 'deleteUser',\n\t\t\t\ttransfer_user_id: transferUserId,\n\t\t\t\tuserid: userid,\n\t\t\t\tpermanent: form.find('[name=\"deleteUserPermanent\"]:checked').val()\n\t\t\t};\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate(data.result.message),\n\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t});\n\t\t\t\t\tvar url = data.result.listViewUrl;\n\t\t\t\t\twindow.location.href = url;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttriggerChangeAccessKey: function (url) {\n\t\t\tvar title = app.vtranslate('JS_NEW_ACCESS_KEY_REQUESTED');\n\t\t\tvar message = app.vtranslate('JS_CHANGE_ACCESS_KEY_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ title: title, message: message }).done(function (data) {\n\t\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\t\tvar params = {};\n\t\t\t\t\tif (data['success']) {\n\t\t\t\t\t\tdata = data.result;\n\t\t\t\t\t\tparams['type'] = 'success';\n\t\t\t\t\t\tmessage = app.vtranslate(data.message);\n\t\t\t\t\t\tvar accessKeyEle = $('#Users_detailView_fieldValue_accesskey');\n\t\t\t\t\t\tif (accessKeyEle.length) {\n\t\t\t\t\t\t\taccessKeyEle.find('.value').html(data.accessKey);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmessage = app.vtranslate(data['error']['message']);\n\t\t\t\t\t}\n\t\t\t\t\tparams['text'] = message;\n\t\t\t\t\tapp.showNotify(params);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\tusersEditInstance: false,\n\t\tupdateStartHourElement: function (form) {\n\t\t\tthis.usersEditInstance.triggerHourFormatChangeEvent(form);\n\t\t\tthis.updateStartHourElementValue();\n\t\t},\n\t\thourFormatUpdateEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.getForm().on(this.fieldUpdatedEvent, '[name=\"hour_format\"]', function (e, params) {\n\t\t\t\tthisInstance.updateStartHourElementValue();\n\t\t\t});\n\t\t},\n\t\tupdateStartHourElementValue: function () {\n\t\t\tvar form = this.getForm();\n\t\t\tvar startHourSelectElement = $('select[name=\"start_hour\"]', form);\n\t\t\tvar selectedElementValue = startHourSelectElement.find('option:selected').text();\n\t\t\tstartHourSelectElement.closest('.fieldValue').find('span.value').text(selectedElementValue);\n\t\t\tvar endHourSelectElement = $('select[name=\"end_hour\"]', form);\n\t\t\tendHourSelectElement\n\t\t\t\t.closest('.fieldValue')\n\t\t\t\t.find('span.value')\n\t\t\t\t.text(endHourSelectElement.find('option:selected').text());\n\t\t},\n\t\tstartHourUpdateEvent: function (form) {\n\t\t\tvar thisInstance = this;\n\t\t\tform.on(this.fieldUpdatedEvent, '[name=\"start_hour\"]', function (e, params) {\n\t\t\t\tthisInstance.updateStartHourElement(form);\n\t\t\t});\n\t\t},\n\t\tsaveFieldValues: function (fieldDetailList) {\n\t\t\tvar aDeferred = $.Deferred();\n\t\t\tvar thisInstance = this;\n\t\t\tvar lock = false;\n\t\t\tvar recordId = this.getRecordId();\n\t\t\tvar data = {};\n\t\t\tif (typeof fieldDetailList !== 'undefined') {\n\t\t\t\tdata = fieldDetailList;\n\t\t\t\tif (data['field'] == 'email1') {\n\t\t\t\t\tthisInstance.usersEditInstance.checkEmail(data['value']).done(\n\t\t\t\t\t\tfunction (data) {},\n\t\t\t\t\t\tfunction (data, error) {\n\t\t\t\t\t\t\tlock = true;\n\t\t\t\t\t\t\taDeferred.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (lock !== true) {\n\t\t\t\tdata['record'] = recordId;\n\t\t\t\tdata['module'] = app.getModuleName();\n\t\t\t\tdata['action'] = 'SaveAjax';\n\n\t\t\t\tvar params = {};\n\t\t\t\tparams.data = data;\n\t\t\t\tparams.async = false;\n\t\t\t\tparams.dataType = 'json';\n\t\t\t\tAppConnector.request(params).done(function (reponseData) {\n\t\t\t\t\taDeferred.resolve(reponseData);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tvar form = this.getForm();\n\t\t\tthis.usersEditInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.updateStartHourElement(form);\n\t\t\tthis.hourFormatUpdateEvent();\n\t\t\tthis.startHourUpdateEvent(form);\n\t\t\tUsers_Edit_Js.registerChangeEventForCurrencySeparator();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","triggerDeleteUser","deleteUserUrl","app","vtranslate","Vtiger_Helper_Js","showConfirmationBox","message","done","AppConnector","request","data","validationEngineOptions","params","onValidationComplete","form","valid","Users_Detail_Js","deleteUser","$","validationEngine","showModalWindow","callback","fail","error","console","find","val","transferUserId","module","getModuleName","action","mode","transfer_user_id","userid","permanent","success","hideModalWindow","showNotify","text","result","type","listViewUrl","window","location","href","url","triggerChangeAccessKey","title","accessKeyEle","length","html","accessKey","usersEditInstance","updateStartHourElement","triggerHourFormatChangeEvent","updateStartHourElementValue","hourFormatUpdateEvent","getForm","on","fieldUpdatedEvent","thisInstance","startHourSelectElement","selectedElementValue","closest","endHourSelectElement","startHourUpdateEvent","saveFieldValues","fieldDetailList","Deferred","lock","recordId","getRecordId","checkEmail","aDeferred","reject","async","dataType","reponseData","resolve","promise","registerEvents","_super","Vtiger_Edit_Js","getInstance","Users_Edit_Js","registerChangeEventForCurrencySeparator"],"mappings":";;AAWAA,iBACC,iBADD,CAEC;;;KAKCC,kBAAmB,2BAAUC,aAAV,CAAyB,CAC3C,YAAcC,IAAIC,UAAJ,CAAe,6BAAf,CAAd,CACAC,iBAAiBC,mBAAjB,CAAqC,CAAEC,QAASA,OAAX,CAArC,EACEC,IADF,CACO,UAAgB,CACrBC,aAAaC,OAAb,CAAqBR,aAArB,EAAoCM,IAApC,CAAyC,SAAUG,IAAV,CAAgB,CACxD,GAAIA,IAAJ,CAAU,CACT,aAAe,UAAgB,CAC9B,WAAaR,IAAIS,uBAAjB,CACAC,OAAOC,oBAAP,CAA8B,SAAUC,IAAV,CAAgBC,KAAhB,CAAuB,CAIpD,YAAA,EAFCC,gBAAgBC,UAAhB,CAA2BH,IAA3B,CAED,GACA,CAP6B,CAQ9BI,EAAE,aAAF,EAAiBC,gBAAjB,CAAkCjB,IAAIS,uBAAtC,EACA,CATD,CAUAT,IAAIkB,eAAJ,CAAoBV,IAApB,CAA0B,SAAUA,IAAV,CAAgB,CAClB,UAAnB,iBADqC,EAExCW,SAASX,IAAT,EAED,CAJD,EAKA,CACD,CAlBD,EAmBA,CArBF,EAsBEY,IAtBF,CAsBO,SAAUC,KAAV,CAAsB,CAC3BC,QAAQD,KAAR,CAAcA,KAAd,EACA,CAxBF,EAyBA,CAhCF,CAiCCN,WAAY,oBAAUH,IAAV,CAAgB,YACdA,KAAKW,IAAL,CAAU,iBAAV,EAA6BC,GAA7B,EADc,CAEvBC,eAAiBb,KAAKW,IAAL,CAAU,2BAAV,EAAuCC,GAAvC,EAFM,CAIvBd,OAAS,CACZgB,OAAQ1B,IAAI2B,aAAJ,EADI,CAEZC,OAAQ,YAFI,CAGZC,KAAM,YAHM,CAIZC,iBAAkBL,cAJN,CAKZM,OAAQA,MALI,CAMZC,UAAWpB,KAAKW,IAAL,CAAU,sCAAV,EAAkDC,GAAlD,EANC,CAJc,CAY3BlB,aAAaC,OAAb,CAAqBG,MAArB,EAA6BL,IAA7B,CAAkC,SAAUG,IAAV,CAAgB,CACjD,GAAIA,KAAKyB,OAAT,CAAkB,CACjBjC,IAAIkC,eAAJ,EADiB,CAEjBlC,IAAImC,UAAJ,CAAe,CACdC,KAAMpC,IAAIC,UAAJ,CAAeO,KAAK6B,MAAL,CAAYjC,OAA3B,CADQ,CAEdkC,KAAM,SAFQ,CAAf,CAFiB,CAMjB,QAAU9B,KAAK6B,MAAL,CAAYE,WAAtB,CACAC,OAAOC,QAAP,CAAgBC,IAAhB,CAAuBC,IACvB,CACD,CAVD,EAWA,CAxDF,CAyDCC,uBAAwB,gCAAUD,GAAV,CAAe,WAC1B3C,IAAIC,UAAJ,CAAe,6BAAf,CAD0B,CAElCG,QAAUJ,IAAIC,UAAJ,CAAe,mCAAf,CAFwB,CAGtCC,iBAAiBC,mBAAjB,CAAqC,CAAE0C,MAAOA,KAAT,CAAgBzC,QAASA,OAAzB,CAArC,EAAyEC,IAAzE,CAA8E,UAAgB,CAC7FC,aAAaC,OAAb,CAAqBoC,GAArB,EAA0BtC,IAA1B,CAA+B,SAAUG,IAAV,CAAgB,CAC9C,WAAa,EAAb,CACA,GAAIA,YAAJ,CAAqB,CACpBA,KAAOA,KAAK6B,MADQ,CAEpB3B,YAAiB,SAFG,CAGpBN,QAAUJ,IAAIC,UAAJ,CAAeO,KAAKJ,OAApB,CAHU,CAIpB,iBAAmBY,EAAE,wCAAF,CAAnB,CACI8B,aAAaC,MALG,EAMnBD,aAAavB,IAAb,CAAkB,QAAlB,EAA4ByB,IAA5B,CAAiCxC,KAAKyC,SAAtC,EAED,CARD,aASWjD,IAAIC,UAAJ,CAAeO,kBAAf,CATX,CAWAE,YAAiBN,OAb6B,CAc9CJ,IAAImC,UAAJ,CAAezB,MAAf,EACA,CAfD,EAgBA,CAjBD,EAkBA,CA9EF,CAFD,CAkFC,CACCwC,oBADD,CAECC,uBAAwB,gCAAUvC,IAAV,CAAgB,CACvC,KAAKsC,iBAAL,CAAuBE,4BAAvB,CAAoDxC,IAApD,CADuC,CAEvC,KAAKyC,2BAAL,GACA,CALF,CAMCC,sBAAuB,gCAAY,CAClC,iBAAmB,IAAnB,CACA,KAAKC,OAAL,GAAeC,EAAf,CAAkB,KAAKC,iBAAvB,CAA0C,sBAA1C,CAAkE,UAAqB,CACtFC,aAAaL,2BAAb,GACA,CAFD,EAGA,CAXF,CAYCA,4BAA6B,sCAAY,UAC7B,KAAKE,OAAL,EAD6B,CAEpCI,uBAAyB3C,EAAE,2BAAF,CAA+BJ,IAA/B,CAFW,CAGpCgD,qBAAuBD,uBAAuBpC,IAAvB,CAA4B,iBAA5B,EAA+Ca,IAA/C,EAHa,CAIxCuB,uBAAuBE,OAAvB,CAA+B,aAA/B,EAA8CtC,IAA9C,CAAmD,YAAnD,EAAiEa,IAAjE,CAAsEwB,oBAAtE,CAJwC,CAKxC,yBAA2B5C,EAAE,yBAAF,CAA6BJ,IAA7B,CAA3B,CACAkD,qBACED,OADF,CACU,aADV,EAEEtC,IAFF,CAEO,YAFP,EAGEa,IAHF,CAGO0B,qBAAqBvC,IAArB,CAA0B,iBAA1B,EAA6Ca,IAA7C,EAHP,EAIA,CAtBF,CAuBC2B,qBAAsB,8BAAUnD,IAAV,CAAgB,CACrC,iBAAmB,IAAnB,CACAA,KAAK4C,EAAL,CAAQ,KAAKC,iBAAb,CAAgC,qBAAhC,CAAuD,UAAqB,CAC3EC,aAAaP,sBAAb,CAAoCvC,IAApC,EACA,CAFD,EAGA,CA5BF,CA6BCoD,gBAAiB,yBAAUC,eAAV,CAA2B,eAC3BjD,EAAEkD,QAAF,EAD2B,CAEvCR,aAAe,IAFwB,CAGvCS,OAHuC,CAIvCC,SAAW,KAAKC,WAAL,EAJ4B,CAKvC7D,KAAO,EALgC,CAkB3C,GAZ+B,WAA3B,wBAYJ,GAXCA,KAAOyD,eAWR,CAVsB,QAAjB,YAUL,EATEP,aAAaR,iBAAb,CAA+BoB,UAA/B,CAA0C9D,UAA1C,EAAyDH,IAAzD,CACC,UAAgB,EADjB,CAEC,UAAuB,CACtB8D,OADsB,CAEtBI,UAAUC,MAAV,GACA,CALF,CASF,EAAI,QAAJ,CAAmB,CAClBhE,YAAiB4D,QADC,CAElB5D,YAAiBR,IAAI2B,aAAJ,EAFC,CAGlBnB,YAAiB,UAHC,CAKlB,WAAa,EAAb,CACAE,OAAOF,IAAP,CAAcA,IANI,CAOlBE,OAAO+D,KAAP,GAPkB,CAQlB/D,OAAOgE,QAAP,CAAkB,MARA,CASlBpE,aAAaC,OAAb,CAAqBG,MAArB,EAA6BL,IAA7B,CAAkC,SAAUsE,WAAV,CAAuB,CACxDJ,UAAUK,OAAV,CAAkBD,WAAlB,EACA,CAFD,EAGA,CACD,iBAAiBE,OAAV,EACP,CA7DF,CA8DCC,eAAgB,yBAAY,CAC3B,KAAKC,MAAL,EAD2B,CAE3B,SAAW,KAAKxB,OAAL,EAAX,CACA,KAAKL,iBAAL,CAAyB8B,eAAeC,WAAf,EAHE,CAI3B,KAAK9B,sBAAL,CAA4BvC,IAA5B,CAJ2B,CAK3B,KAAK0C,qBAAL,EAL2B,CAM3B,KAAKS,oBAAL,CAA0BnD,IAA1B,CAN2B,CAO3BsE,cAAcC,uCAAd,GACA,CAtEF,CAlFD"}