{"version":3,"file":"TreeInventoryModal.min.js","sources":["TreeInventoryModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_TreeInventoryModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Tree instance\n\t\t */\n\t\ttreeInstance: false,\n\t\t/**\n\t\t * Set event for select row\n\t\t * @param {function} cb\n\t\t */\n\t\tsetSelectEvent: function (cb) {\n\t\t\tthis.selectEvent = cb;\n\t\t},\n\t\t/**\n\t\t * Gets tree data\n\t\t */\n\t\tgetTreeData: function () {\n\t\t\tlet treeData = this.container.find('.js-tree-value').val();\n\t\t\treturn treeData ? JSON.parse(treeData) : [];\n\t\t},\n\n\t\t/*\n\t\t * Function generates a tree.\n\t\t */\n\t\tgenerateTree: function () {\n\t\t\tif (this.treeInstance == false) {\n\t\t\t\tthis.treeInstance = this.container.find('.js-tree-contents');\n\t\t\t\tlet plugins = ['search', 'category', 'checkbox'];\n\t\t\t\tthis.treeInstance.jstree(\n\t\t\t\t\t$.extend(\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcore: {\n\t\t\t\t\t\t\t\tdata: this.getTreeData(),\n\t\t\t\t\t\t\t\tthemes: {\n\t\t\t\t\t\t\t\t\tname: 'proton',\n\t\t\t\t\t\t\t\t\tresponsive: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcheckbox: {\n\t\t\t\t\t\t\t\tthree_state: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tplugins: plugins\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis.treeInstance.data('params')\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * Function looks up the entered phrases.\n\t\t */\n\t\tsearching: function (text) {\n\t\t\tthis.treeInstance.jstree(true).search(text);\n\t\t},\n\n\t\t/*\n\t\t * Function retrieves the search terms.\n\t\t */\n\t\tregisterSearchEvent: function () {\n\t\t\tlet valueSearch = this.container.find('#valueSearchTree');\n\t\t\tlet btnSearch = this.container.find('#btnSearchTree');\n\t\t\tvalueSearch.on('keypress', (e) => {\n\t\t\t\tif (e.which == 13) {\n\t\t\t\t\tthis.searching(valueSearch.val());\n\t\t\t\t}\n\t\t\t});\n\t\t\tbtnSearch.on('click', () => {\n\t\t\t\tthis.searching(valueSearch.val());\n\t\t\t});\n\t\t},\n\n\t\t/*\n\t\t * Function retrieves the selected records.\n\t\t */\n\t\tregisterSelectRecords: function () {\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\tlet recordsToAdd = [];\n\t\t\t\t$.each(this.treeInstance.jstree('getCategory', true), function (_, treeElement) {\n\t\t\t\t\tif (treeElement.attr === 'record') {\n\t\t\t\t\t\trecordsToAdd[treeElement.record_id] = treeElement.text;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (recordsToAdd.length) {\n\t\t\t\t\tthis.selectEvent(recordsToAdd);\n\t\t\t\t\tapp.hideModalWindow(false, this.container.parent().attr('id'));\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({ text: app.vtranslate('JS_PLEASE_SELECT_ONE_RECORD') });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register modal events\n\t\t */\n\t\tregisterEvents: function (container) {\n\t\t\tthis.container = container;\n\t\t\tthis.generateTree();\n\t\t\tthis.registerSelectRecords();\n\t\t\tthis.registerSearchEvent();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","treeInstance","setSelectEvent","cb","selectEvent","getTreeData","treeData","find","val","JSON","parse","generateTree","jstree","extend","core","data","themes","name","responsive","checkbox","three_state","plugins","searching","text","search","registerSearchEvent","_this","valueSearch","btnSearch","on","e","which","registerSelectRecords","_this2","recordsToAdd","each","_","treeElement","attr","record_id","length","app","hideModalWindow","parent","showNotify","vtranslate","registerEvents"],"mappings":"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"}