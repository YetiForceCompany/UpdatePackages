{"version":3,"file":"RelatedList.min.js","sources":["RelatedList.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_RelatedList_Js(\n\t'PriceBooks_RelatedList_Js',\n\t{\n\t\ttriggerMassMargin: function () {\n\t\t\tconst self = Vtiger_RelatedList_Js.relatedListInstance;\n\t\t\tlet selected_ids = self.readSelectedIds(true),\n\t\t\t\texcluded_ids = self.readExcludedIds(true);\n\t\t\tif (self.checkListRecordSelected() !== true) {\n\t\t\t\tapp.showModalWindow({\n\t\t\t\t\turl: 'index.php?module=PriceBooks&view=SpecifyMargin',\n\t\t\t\t\tcb: (modalContainer) => {\n\t\t\t\t\t\tmodalContainer.find('.js-modal__save').on('click', (e) => {\n\t\t\t\t\t\t\tlet element = modalContainer.find('.js-margin');\n\t\t\t\t\t\t\tlet resultOfValidation = Vtiger_NumberUserFormat_Validator_Js.invokeValidation(element);\n\t\t\t\t\t\t\tif (typeof resultOfValidation !== 'undefined') {\n\t\t\t\t\t\t\t\telement.validationEngine('showPrompt', resultOfValidation, '', 'topLeft', true);\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telement.validationEngine('hideAll');\n\t\t\t\t\t\t\t\tlet postData = self.getCompleteParams();\n\t\t\t\t\t\t\t\tdelete postData.view;\n\t\t\t\t\t\t\t\tpostData.selected_ids = selected_ids;\n\t\t\t\t\t\t\t\tpostData.excluded_ids = excluded_ids;\n\t\t\t\t\t\t\t\tpostData.mode = 'specifyMargin';\n\t\t\t\t\t\t\t\tpostData.action = 'RelationAjax';\n\t\t\t\t\t\t\t\tpostData.relatedModule = self.moduleName;\n\t\t\t\t\t\t\t\tpostData.record = self.getParentId();\n\t\t\t\t\t\t\t\tpostData.margin = element.val();\n\t\t\t\t\t\t\t\tAppConnector.request(postData).done((response) => {\n\t\t\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\t\t\tVtiger_Detail_Js.reloadRelatedList();\n\t\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tself.noRecordSelectedAlert();\n\t\t\t}\n\t\t}\n\t},\n\t{\n\t\tregisterEditListPrice: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tlet element = this.content.find('.js-edit-listprice');\n\t\t\telement.validationEngine(app.validationEngineOptions);\n\t\t\telement.on('change', (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber();\n\t\t\t\tif (!element.validationEngine('validate')) {\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\tmodule: thisInstance.parentModuleName,\n\t\t\t\t\t\trecord: element.closest('.js-list__row').data('id'),\n\t\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\t\tmode: 'addListPrice',\n\t\t\t\t\t\tsrc_record: thisInstance.parentRecordId,\n\t\t\t\t\t\trelated_module: thisInstance.moduleName,\n\t\t\t\t\t\tprice: element.val()\n\t\t\t\t\t}).done(function (responseData) {\n\t\t\t\t\t\tif (responseData.result) {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterPostLoadEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerEditListPrice();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_RelatedList_Js","triggerMassMargin","self","relatedListInstance","selected_ids","readSelectedIds","excluded_ids","readExcludedIds","checkListRecordSelected","noRecordSelectedAlert","app","showModalWindow","url","cb","modalContainer","find","on","e","element","resultOfValidation","Vtiger_NumberUserFormat_Validator_Js","invokeValidation","validationEngine","preventDefault","postData","getCompleteParams","view","mode","action","relatedModule","moduleName","record","getParentId","margin","val","AppConnector","request","done","response","success","Vtiger_Detail_Js","reloadRelatedList","hideModalWindow","registerEditListPrice","thisInstance","content","validationEngineOptions","stopPropagation","$","currentTarget","formatNumber","module","parentModuleName","closest","data","src_record","parentRecordId","related_module","price","responseData","result","showNotify","text","vtranslate","type","registerPostLoadEvents","_super"],"mappings":"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"}