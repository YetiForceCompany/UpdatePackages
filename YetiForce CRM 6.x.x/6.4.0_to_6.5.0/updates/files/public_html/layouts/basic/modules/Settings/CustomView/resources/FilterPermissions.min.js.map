{"version":3,"file":"FilterPermissions.min.js","sources":["FilterPermissions.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_CustomView_FilterPermissions_Js',\n\t{},\n\t{\n\t\tformElement: false,\n\t\tregisterButtonsEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = this.getForm();\n\t\t\tcontainer.find('button.moveItem').on('click', function (e) {\n\t\t\t\tthisInstance.setDefaultPreferences(e);\n\t\t\t});\n\t\t},\n\t\tregisterDisabledButtons: function () {\n\t\t\tvar container = this.getForm();\n\t\t\tcontainer.find('button.moveItem').each(function (n, e) {\n\t\t\t\tvar currentTarget = jQuery(e);\n\t\t\t\tvar sourceClass = currentTarget.data('source');\n\t\t\t\tvar source = container.find('.' + sourceClass);\n\t\t\t\tif (source.find('option').length && !source.is(':disabled')) {\n\t\t\t\t\tcurrentTarget.prop('disabled', false);\n\t\t\t\t} else {\n\t\t\t\t\tcurrentTarget.prop('disabled', true);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmove: function (currentTarget) {\n\t\t\tvar container = this.getForm();\n\t\t\tvar sourceClass = currentTarget.data('source');\n\t\t\tvar targetClass = currentTarget.data('target');\n\t\t\tvar target = container.find('.' + targetClass);\n\t\t\tvar source = container.find('.' + sourceClass).find('option:selected');\n\n\t\t\tvar values = {};\n\t\t\tvalues.val = source.val();\n\t\t\tvalues.label = source.text();\n\t\t\tvalues.blockLabel = source.closest('optgroup').attr('label');\n\n\t\t\tvar targetOption = '<option value=\"' + values.val + '\">' + values.label + '</option>';\n\t\t\tvar targetOpt = target.find('optgroup[label=\"' + values.blockLabel + '\"]');\n\t\t\tif (targetOpt.length) {\n\t\t\t\ttargetOpt.append(targetOption);\n\t\t\t} else {\n\t\t\t\ttarget.append('<optgroup label=\"' + values.blockLabel + '\">' + targetOption + '</optgroup>');\n\t\t\t}\n\t\t\tsource.remove();\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('.select2'));\n\t\t},\n\t\t/**\n\t\t * Saves permission for filter\n\t\t * @param {jQuery.Event} e\n\t\t */\n\t\tsetDefaultPreferences: function (e) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = this.getForm();\n\t\t\tvar progressIndicatorElement = $.progressIndicator({\n\t\t\t\tmessage: app.vtranslate('JS_SAVE_LOADER_INFO'),\n\t\t\t\tposition: this.getForm(),\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar sourceClass = currentTarget.data('source');\n\t\t\tvar params = {\n\t\t\t\ttabid: container.find('#sourceModule').val(),\n\t\t\t\tuser: container.find('.' + sourceClass).val(),\n\t\t\t\tcvid: container.find('#cvid').val(),\n\t\t\t\toperator: currentTarget.data('operator'),\n\t\t\t\ttype: container.find('#type').val()\n\t\t\t};\n\t\t\tapp.saveAjax('setFilterPermissions', {}, params).done(function (data) {\n\t\t\t\tif (data.success) {\n\t\t\t\t\tif (data.result.success) {\n\t\t\t\t\t\tthisInstance.move(currentTarget);\n\t\t\t\t\t\tthisInstance.registerDisabledButtons();\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tapp.showNotify({ text: data.result.message, type: 'success' });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tapp.showNotify({ text: data.result.message, type: 'error' });\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetForm: function () {\n\t\t\tif (this.formElement == false) {\n\t\t\t\tthis.setForm(jQuery('#modalFilterPermissions'));\n\t\t\t}\n\t\t\treturn this.formElement;\n\t\t},\n\t\tsetForm: function (element) {\n\t\t\tthis.formElement = element;\n\t\t\treturn this;\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis.registerButtonsEvent();\n\t\t\tthis.registerDisabledButtons();\n\t\t}\n\t}\n);\n\njQuery(document).ready(function (e) {\n\tvar instance = new Settings_CustomView_FilterPermissions_Js();\n\tinstance.registerEvents();\n});\n"],"names":["jQuery","Class","formElement","registerButtonsEvent","thisInstance","container","getForm","find","on","e","setDefaultPreferences","registerDisabledButtons","each","n","currentTarget","sourceClass","data","source","length","is","prop","move","targetClass","target","values","val","label","text","blockLabel","closest","attr","targetOption","targetOpt","append","remove","App","Fields","Picklist","showSelect2ElementView","progressIndicatorElement","$","progressIndicator","message","app","vtranslate","position","blockInfo","enabled","params","tabid","user","cvid","operator","type","saveAjax","done","success","result","mode","showNotify","setForm","element","registerEvents","document","ready","instance","Settings_CustomView_FilterPermissions_Js"],"mappings":"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"}