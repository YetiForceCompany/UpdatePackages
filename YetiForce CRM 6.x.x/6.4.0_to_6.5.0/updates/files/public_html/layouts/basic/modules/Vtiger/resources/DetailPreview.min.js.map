{"version":3,"file":"DetailPreview.min.js","sources":["DetailPreview.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Vtiger_DetailPreview_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Redirects to the clicked link from the iframe.\n\t\t */\n\t\tregisterLinkEvent: function () {\n\t\t\t$('#page').on('click', 'a', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tlet target = $(this);\n\t\t\t\tif (!target.closest('div').hasClass('fieldValue') || target.hasClass('showReferenceTooltip')) {\n\t\t\t\t\tif (target.attr('href') && target.attr('href') != '#') {\n\t\t\t\t\t\ttop.location.href = target.attr('href');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Redirects to the current iframe parent.\n\t\t */\n\t\tupdateParentFrame: function () {\n\t\t\tparent.app.getPageController().updateWindowHeight($('.mainContainer').height(), $(window.frameElement));\n\t\t},\n\t\t/**\n\t\t * Function sets the correct iframe size.\n\t\t * @param {jQuery} currentHeight - ifrmae body height to be set.\n\t\t * @param {jQuery} frame - ifrmae height to be changed.\n\t\t */\n\t\tupdateWindowHeight: function (currentHeight, frame) {\n\t\t\tlet thisInstance = this;\n\t\t\tlet relatedContents = frame.closest('.relatedContents');\n\t\t\tlet fixedListHeight = relatedContents.find('.js-list-preview--scroll').height();\n\t\t\tframe.height(currentHeight);\n\t\t\tif (fixedListHeight > currentHeight) {\n\t\t\t\tcurrentHeight = fixedListHeight;\n\t\t\t}\n\t\t\trelatedContents\n\t\t\t\t.find('.gutter, .js-list-preview, .js-side-block, .js-list-detail, .recordsListPreview')\n\t\t\t\t.height(currentHeight);\n\n\t\t\tif (window.frameElement) {\n\t\t\t\tthisInstance.updateParentFrame();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Creates ResizeSensor, which detects size changes.\n\t\t */\n\t\tregisterSizeEvent: function () {\n\t\t\tlet thisInstance = this;\n\t\t\tnew ResizeSensor($('.mainContainer'), function () {\n\t\t\t\tthisInstance.updateParentFrame();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register detail events\n\t\t */\n\t\tregisterDetailEvent: function () {\n\t\t\tlet moduleClassName = app.getModuleName() + '_Detail_Js',\n\t\t\t\tparent = false;\n\t\t\tif (typeof window[moduleClassName] === 'undefined') {\n\t\t\t\tmoduleClassName = 'Vtiger_Detail_Js';\n\t\t\t}\n\t\t\tif (typeof window[moduleClassName] !== 'undefined') {\n\t\t\t\tif (typeof window[moduleClassName] === 'function') {\n\t\t\t\t\tparent = new window[moduleClassName]();\n\t\t\t\t}\n\t\t\t\tif (typeof window[moduleClassName] === 'object') {\n\t\t\t\t\tparent = window[moduleClassName];\n\t\t\t\t}\n\t\t\t\tif (parent) {\n\t\t\t\t\tparent.registerEvents();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tupdateChatConfig() {\n\t\t\tif (window.parent.vuexStore && window.ChatModalVueComponent) {\n\t\t\t\twindow.parent.vuexStore.commit('Chat/setDetailPreview', {\n\t\t\t\t\tid: window.app.getRecordId(),\n\t\t\t\t\tmodule: window.app.getModuleName()\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Registers DetailPreview events.\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tthis.registerDetailEvent();\n\t\t\tthis.registerLinkEvent();\n\t\t\tthis.registerSizeEvent();\n\t\t\tthis.updateChatConfig();\n\t\t}\n\t}\n);\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","$","Class","registerLinkEvent","on","e","preventDefault","target","closest","hasClass","attr","top","location","href","updateParentFrame","parent","app","getPageController","updateWindowHeight","height","window","frameElement","currentHeight","frame","thisInstance","relatedContents","fixedListHeight","find","registerSizeEvent","ResizeSensor","registerDetailEvent","moduleClassName","getModuleName","registerEvents","updateChatConfig","vuexStore","ChatModalVueComponent","commit","id","getRecordId","module"],"mappings":"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"}