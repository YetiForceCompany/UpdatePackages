{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce S.A.\n *************************************************************************************/\n'use strict';\n\nSettings_Vtiger_Edit_Js(\n\t'Settings_Workflows_Edit_Js',\n\t{\n\t\tinstance: {}\n\t},\n\t{\n\t\tcurrentInstance: false,\n\t\tworkFlowsContainer: false,\n\t\tinit: function () {\n\t\t\tthis.initiate();\n\t\t},\n\t\t/**\n\t\t * Function to get the container which holds all the workflow elements\n\t\t * @return jQuery object\n\t\t */\n\t\tgetContainer: function () {\n\t\t\treturn this.workFlowsContainer;\n\t\t},\n\t\t/**\n\t\t * Function to set the reports container\n\t\t * @params : element - which represents the workflow container\n\t\t * @return : current instance\n\t\t */\n\t\tsetContainer: function (element) {\n\t\t\tthis.workFlowsContainer = element;\n\t\t\treturn this;\n\t\t},\n\t\t/*\n\t\t * Function to return the instance based on the step of the Workflow\n\t\t */\n\t\tgetInstance: function (step) {\n\t\t\tif (step in Settings_Workflows_Edit_Js.instance) {\n\t\t\t\treturn Settings_Workflows_Edit_Js.instance[step];\n\t\t\t} else {\n\t\t\t\tvar moduleClassName = 'Settings_Workflows_Edit' + step + '_Js';\n\t\t\t\tSettings_Workflows_Edit_Js.instance[step] = new window[moduleClassName]();\n\t\t\t\treturn Settings_Workflows_Edit_Js.instance[step];\n\t\t\t}\n\t\t},\n\t\t/*\n\t\t * Function to get the value of the step\n\t\t * returns 1 or 2 or 3\n\t\t */\n\t\tgetStepValue: function () {\n\t\t\tvar container = this.currentInstance.getContainer();\n\t\t\treturn jQuery('.step', container).val();\n\t\t},\n\t\t/*\n\t\t * Function to initiate the step 1 instance\n\t\t */\n\t\tinitiate: function (container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = jQuery('.workFlowContents');\n\t\t\t}\n\t\t\tif (container.is('.workFlowContents')) {\n\t\t\t\tthis.setContainer(container);\n\t\t\t} else {\n\t\t\t\tthis.setContainer(jQuery('.workFlowContents', container));\n\t\t\t}\n\t\t\tthis.initiateStep('1');\n\t\t\tthis.currentInstance.registerEvents();\n\t\t},\n\t\t/*\n\t\t * Function to initiate all the operations for a step\n\t\t * @params step value\n\t\t */\n\t\tinitiateStep: function (stepVal) {\n\t\t\tvar step = 'step' + stepVal;\n\t\t\tthis.activateHeader(step);\n\t\t\tvar currentInstance = this.getInstance(stepVal);\n\t\t\tthis.currentInstance = currentInstance;\n\t\t},\n\t\t/*\n\t\t * Function to activate the header based on the class\n\t\t * @params class name\n\t\t */\n\t\tactivateHeader: function (step) {\n\t\t\tvar headersContainer = jQuery('.crumbs ');\n\t\t\theadersContainer.find('.active').removeClass('active');\n\t\t\tjQuery('#' + step, headersContainer).addClass('active');\n\t\t},\n\t\t/*\n\t\t * Function to register the click event for next button\n\t\t */\n\t\tregisterFormSubmitEvent: function (form) {\n\t\t\tconst thisInstance = this;\n\t\t\tif (jQuery.isFunction(thisInstance.currentInstance.submit)) {\n\t\t\t\tform.on('submit', function (e) {\n\t\t\t\t\tlet specialValidation = true;\n\t\t\t\t\tif (jQuery.isFunction(thisInstance.currentInstance.isFormValidate)) {\n\t\t\t\t\t\tspecialValidation = thisInstance.currentInstance.isFormValidate();\n\t\t\t\t\t}\n\t\t\t\t\tif (jQuery(e.currentTarget).validationEngine('validate') && specialValidation) {\n\t\t\t\t\t\tthisInstance.currentInstance.submit().done(function (data) {\n\t\t\t\t\t\t\tthisInstance.getContainer().append(data);\n\t\t\t\t\t\t\tthisInstance.initiateStep(parseInt(thisInstance.getStepValue()) + 1);\n\t\t\t\t\t\t\tthisInstance.currentInstance.initialize();\n\t\t\t\t\t\t\tthisInstance.registerFormSubmitEvent(thisInstance.currentInstance.getContainer());\n\t\t\t\t\t\t\tthisInstance.currentInstance.registerEvents();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tback: function () {\n\t\t\tvar step = this.getStepValue();\n\t\t\tvar prevStep = parseInt(step) - 1;\n\t\t\tthis.currentInstance.initialize();\n\t\t\tvar container = this.currentInstance.getContainer();\n\t\t\tvar workflowRecordElement = jQuery('[name=\"record\"]', container);\n\t\t\tvar workFlowId = workflowRecordElement.val();\n\t\t\tcontainer.remove();\n\t\t\tthis.initiateStep(prevStep);\n\t\t\tvar currentContainer = this.currentInstance.getContainer();\n\t\t\tcurrentContainer.show();\n\t\t\tjQuery('[name=\"record\"]', currentContainer).val(workFlowId);\n\t\t\tvar modulesList = jQuery('#moduleName', currentContainer);\n\t\t\tif (modulesList.length > 0 && workFlowId != '') {\n\t\t\t\tmodulesList.attr('disabled', 'disabled').trigger('change');\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Get popup with value\n\t\t * @param container\n\t\t */\n\t\tgetPopUp(container) {\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = this.getContainer();\n\t\t\t}\n\t\t\tcontainer.on('click', '.getPopupUi', (e) => {\n\t\t\t\tif (container.find('[name=\"execution_condition\"]').val() == 6) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst fieldValueElement = jQuery(e.currentTarget);\n\t\t\t\tconst fieldValue = fieldValueElement.val();\n\t\t\t\tconst fieldUiHolder = fieldValueElement.closest('.fieldUiHolder');\n\t\t\t\tlet valueType = fieldUiHolder.find('[name=\"valuetype\"]').val();\n\t\t\t\tif (valueType === '') {\n\t\t\t\t\tvalueType = 'rawtext';\n\t\t\t\t}\n\t\t\t\tconst conditionsContainer = fieldValueElement.closest('.js-conditions-container');\n\t\t\t\tconst conditionRow = fieldValueElement.closest('.js-conditions-row');\n\t\t\t\tvar clonedPopupUi = conditionsContainer\n\t\t\t\t\t.find('.popupUi')\n\t\t\t\t\t.clone(true, true)\n\t\t\t\t\t.removeClass('popupUi')\n\t\t\t\t\t.addClass('clonedPopupUi');\n\t\t\t\tclonedPopupUi.find('select').addClass('select2');\n\t\t\t\tclonedPopupUi.find('.fieldValue').val(fieldValue);\n\t\t\t\tlet value;\n\t\t\t\tif (fieldValueElement.hasClass('date')) {\n\t\t\t\t\tclonedPopupUi.find('.textType').find('option[value=\"rawtext\"]').attr('data-ui', 'input');\n\t\t\t\t\tconst dataFormat = fieldValueElement.data('date-format');\n\t\t\t\t\tif (valueType === 'rawtext') {\n\t\t\t\t\t\tvalue = fieldValueElement.val();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = '';\n\t\t\t\t\t}\n\t\t\t\t\tconst clonedDateElement =\n\t\t\t\t\t\t'<input type=\"text\" class=\"dateField fieldValue col-md-4 form-control\" value=\"' +\n\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t'\" data-date-format=\"' +\n\t\t\t\t\t\tdataFormat +\n\t\t\t\t\t\t'\" data-input=\"true\" >';\n\t\t\t\t\tclonedPopupUi.find('.fieldValueContainer').prepend(clonedDateElement);\n\t\t\t\t} else if (fieldValueElement.hasClass('time')) {\n\t\t\t\t\tclonedPopupUi.find('.textType').find('option[value=\"rawtext\"]').attr('data-ui', 'input');\n\t\t\t\t\tif (valueType === 'rawtext') {\n\t\t\t\t\t\tvalue = fieldValueElement.val();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = '';\n\t\t\t\t\t}\n\t\t\t\t\tconst clonedTimeElement =\n\t\t\t\t\t\t'<input type=\"text\" class=\"timepicker-default fieldValue col-md-4 form-control\" value=\"' +\n\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t'\" data-input=\"true\" >';\n\t\t\t\t\tclonedPopupUi.find('.fieldValueContainer').prepend(clonedTimeElement);\n\t\t\t\t} else if (fieldValueElement.hasClass('boolean')) {\n\t\t\t\t\tclonedPopupUi.find('.textType').find('option[value=\"rawtext\"]').attr('data-ui', 'input');\n\t\t\t\t\tif (valueType === 'rawtext') {\n\t\t\t\t\t\tvalue = fieldValueElement.val();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = '';\n\t\t\t\t\t}\n\t\t\t\t\tconst clonedBooleanElement =\n\t\t\t\t\t\t'<input type=\"checkbox\" class=\"fieldValue col-md-4 form-control\" value=\"' + value + '\" data-input=\"true\" >';\n\t\t\t\t\tclonedPopupUi.find('.fieldValueContainer').prepend(clonedBooleanElement);\n\t\t\t\t\tif (value === 'true:boolean' || value === '') {\n\t\t\t\t\t\tclonedPopupUi.find('.fieldValueContainer input').attr('checked', 'checked');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclonedPopupUi.find('.fieldValueContainer input').removeAttr('checked');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconditionsContainer.find('.clonedPopUp').html(clonedPopupUi);\n\t\t\t\tconst clonedPopupElement = $('.clonedPopUp', conditionsContainer).find('.clonedPopupUi');\n\t\t\t\t$('.clonedPopupUi', conditionsContainer).on('shown.bs.modal', () => {\n\t\t\t\t\tconst data = $('.clonedPopupUi', conditionsContainer);\n\t\t\t\t\tdata.find('.clonedPopupUi').removeClass('d-none');\n\t\t\t\t\tconst moduleNameElement = conditionRow.find('[name=\"modulename\"]');\n\t\t\t\t\tif (moduleNameElement.length > 0) {\n\t\t\t\t\t\tconst moduleName = moduleNameElement.val();\n\t\t\t\t\t\tdata.find('.useFieldElement').addClass('d-none');\n\t\t\t\t\t\tdata.find('[name=\"' + moduleName + '\"]').removeClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(data);\n\t\t\t\t\tApp.Fields.Date.register(data);\n\t\t\t\t\tapp.registerEventForClockPicker(data);\n\t\t\t\t\tthis.postShowModalAction(data, valueType);\n\t\t\t\t\tthis.registerChangeFieldEvent(data);\n\t\t\t\t\tthis.registerSelectOptionEvent(data);\n\t\t\t\t\tthis.registerPopUpSaveEvent(data, fieldUiHolder);\n\t\t\t\t\tdata.find('.fieldValue').filter(':visible').trigger('focus');\n\t\t\t\t\tclonedPopupElement\n\t\t\t\t\t\t.find('[data-close-modal=\"modal\"], [data-dismiss=\"modal\"]')\n\t\t\t\t\t\t.off('click')\n\t\t\t\t\t\t.on('click', function (e) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t$(this).closest('.modal').removeClass('in').css('display', 'none');\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tclonedPopupElement.modal();\n\t\t\t});\n\t\t},\n\t\tregisterRemoveModalEvent: function (data) {\n\t\t\tdata.on('click', '.closeModal', function (e) {\n\t\t\t\tdata.modal('hide');\n\t\t\t});\n\t\t},\n\t\tregisterPopUpSaveEvent: function (data, fieldUiHolder) {\n\t\t\tjQuery('[name=\"saveButton\"]', data).on('click', function (e) {\n\t\t\t\tvar valueType = jQuery('.textType', data).val();\n\n\t\t\t\tfieldUiHolder.find('[name=\"valuetype\"]').val(valueType);\n\t\t\t\tvar fieldValueElement = fieldUiHolder.find('.getPopupUi');\n\t\t\t\tif (valueType != 'rawtext') {\n\t\t\t\t\tfieldValueElement.removeAttr('data-validation-engine');\n\t\t\t\t\tfieldValueElement.removeClass('validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]');\n\t\t\t\t} else {\n\t\t\t\t\tfieldValueElement.addClass('validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]');\n\t\t\t\t\tfieldValueElement.attr(\n\t\t\t\t\t\t'data-validation-engine',\n\t\t\t\t\t\t'validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tvar fieldType = data.find('.fieldValue').filter(':visible').attr('type');\n\t\t\t\tvar fieldValue = data.find('.fieldValue').filter(':visible').val();\n\t\t\t\t//For checkbox field type, handling fieldValue\n\t\t\t\tif (fieldType == 'checkbox') {\n\t\t\t\t\tif (data.find('.fieldValue').filter(':visible').is(':checked')) {\n\t\t\t\t\t\tfieldValue = 'true:boolean';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfieldValue = 'false:boolean';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfieldValueElement.val(fieldValue);\n\t\t\t\tfieldValueElement.validationEngine('hide');\n\t\t\t\tdata.remove();\n\t\t\t});\n\t\t},\n\t\tregisterSelectOptionEvent: (data) => {\n\t\t\t$('.useField,.useFunction', data).on('change', (e) => {\n\t\t\t\tlet currentElement = $(e.currentTarget);\n\t\t\t\tlet newValue = currentElement.val();\n\t\t\t\tlet oldValue = data.find('.fieldValue').filter(':visible').val(),\n\t\t\t\t\tconcatenatedValue;\n\t\t\t\tif (currentElement.hasClass('useField')) {\n\t\t\t\t\tif (oldValue != '') {\n\t\t\t\t\t\tconcatenatedValue = oldValue + ' ' + newValue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconcatenatedValue = newValue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconcatenatedValue = oldValue + newValue;\n\t\t\t\t}\n\t\t\t\tdata.find('.fieldValue').val(concatenatedValue);\n\t\t\t\tcurrentElement.val('').trigger('change.select2');\n\t\t\t});\n\t\t},\n\t\tregisterChangeFieldEvent: function (data) {\n\t\t\tjQuery('.textType', data).on('change', function (e) {\n\t\t\t\tvar valueType = jQuery(e.currentTarget).val();\n\t\t\t\tvar useFieldContainer = jQuery('.useFieldContainer', data);\n\t\t\t\tvar useFunctionContainer = jQuery('.useFunctionContainer', data);\n\t\t\t\tvar uiType = jQuery(e.currentTarget).find('option:selected').data('ui');\n\t\t\t\tjQuery('.fieldValue', data).hide();\n\t\t\t\tjQuery('[data-' + uiType + ']', data).show();\n\t\t\t\tif (valueType == 'fieldname') {\n\t\t\t\t\tuseFieldContainer.removeClass('d-none');\n\t\t\t\t\tuseFunctionContainer.addClass('d-none');\n\t\t\t\t} else if (valueType == 'expression') {\n\t\t\t\t\tuseFieldContainer.removeClass('d-none');\n\t\t\t\t\tuseFunctionContainer.removeClass('d-none');\n\t\t\t\t} else {\n\t\t\t\t\tuseFieldContainer.addClass('d-none');\n\t\t\t\t\tuseFunctionContainer.addClass('d-none');\n\t\t\t\t}\n\t\t\t\tjQuery('.helpmessagebox', data).addClass('d-none');\n\t\t\t\tjQuery('#' + valueType + '_help', data).removeClass('d-none');\n\t\t\t\tdata.find('.fieldValue').val('');\n\t\t\t});\n\t\t},\n\t\tpostShowModalAction: function (data, valueType) {\n\t\t\tif (valueType == 'fieldname') {\n\t\t\t\tjQuery('.useFieldContainer', data).removeClass('d-none');\n\t\t\t\tjQuery('.textType', data).val(valueType).trigger('change');\n\t\t\t} else if (valueType == 'expression') {\n\t\t\t\tjQuery('.useFieldContainer', data).removeClass('d-none');\n\t\t\t\tjQuery('.useFunctionContainer', data).removeClass('d-none');\n\t\t\t\tjQuery('.textType', data).val(valueType).trigger('change');\n\t\t\t}\n\t\t\tjQuery('#' + valueType + '_help', data).removeClass('d-none');\n\t\t\tvar uiType = jQuery('.textType', data).find('option:selected').data('ui');\n\t\t\tjQuery('.fieldValue', data).hide();\n\t\t\tjQuery('[data-' + uiType + ']', data).show();\n\t\t},\n\t\t/*\n\t\t * Function to register the click event for back step\n\t\t */\n\t\tregisterBackStepClickEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar container = this.getContainer();\n\t\t\tcontainer.on('click', '.backStep', function (e) {\n\t\t\t\tthisInstance.back();\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tvar form = this.currentInstance.getContainer();\n\t\t\tthis.registerFormSubmitEvent(form);\n\t\t\tthis.registerBackStepClickEvent();\n\t\t}\n\t}\n);\n"],"names":["Settings_Vtiger_Edit_Js","instance","currentInstance","workFlowsContainer","init","initiate","getContainer","setContainer","element","getInstance","step","Settings_Workflows_Edit_Js","window","getStepValue","container","jQuery","val","is","initiateStep","registerEvents","stepVal","activateHeader","headersContainer","find","removeClass","addClass","registerFormSubmitEvent","form","thisInstance","isFunction","submit","on","e","specialValidation","isFormValidate","currentTarget","validationEngine","done","data","append","parseInt","initialize","preventDefault","back","prevStep","workflowRecordElement","workFlowId","remove","currentContainer","show","modulesList","length","attr","trigger","getPopUp","_this","fieldValueElement","fieldValue","fieldUiHolder","closest","valueType","conditionsContainer","conditionRow","clonedPopupUi","clone","value","hasClass","dataFormat","clonedDateElement","prepend","clonedTimeElement","clonedBooleanElement","removeAttr","html","clonedPopupElement","$","moduleNameElement","moduleName","App","Fields","Picklist","changeSelectElementView","Date","register","app","registerEventForClockPicker","postShowModalAction","registerChangeFieldEvent","registerSelectOptionEvent","registerPopUpSaveEvent","filter","off","stopPropagation","css","modal","registerRemoveModalEvent","fieldType","concatenatedValue","currentElement","newValue","oldValue","useFieldContainer","useFunctionContainer","uiType","hide","registerBackStepClickEvent"],"mappings":"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"}