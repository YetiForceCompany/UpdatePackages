{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_List_Js(\n\t'Settings_Vtiger_List_Js',\n\t{\n\t\ttriggerDelete: function (event, url) {\n\t\t\tevent.stopPropagation();\n\t\t\tvar instance = Vtiger_List_Js.getInstance();\n\t\t\tinstance.DeleteRecord(url);\n\t\t},\n\t\t/**\n\t\t * Make delete request\n\t\t *\n\t\t * @param   {object}  params\n\t\t * @param   {jQuery.Deferred}  aDeferred\n\t\t * @param   {Vtiger_List_Js}  instance\n\t\t */\n\t\tmakeDeleteRequest(params, aDeferred, instance) {\n\t\t\tAppConnector.request(params).done((data) => {\n\t\t\t\tlet response = data.result;\n\t\t\t\tif (response && response.success) {\n\t\t\t\t\t$('#recordsCount').val('');\n\t\t\t\t\t$('#totalPageCount').text('');\n\t\t\t\t\tinstance.getListViewRecords().done(() => {\n\t\t\t\t\t\tinstance.updatePagination();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Delete by id\n\t\t *\n\t\t * @param   {number}  id\n\t\t * @param   {bool}  showConfirmation\n\t\t *\n\t\t * @return  {jQuery.Deferred}\n\t\t */\n\t\tdeleteById(id, showConfirmation = true) {\n\t\t\tconst aDeferred = jQuery.Deferred();\n\t\t\tconst instance = Vtiger_List_Js.getInstance();\n\t\t\tconst params = $.extend(instance.getDeleteParams(), {\n\t\t\t\trecord: id\n\t\t\t});\n\t\t\tif (showConfirmation) {\n\t\t\t\tapp.showConfirmModal({\n\t\t\t\t\ttitle: app.vtranslate('JS_DELETE_RECORD_CONFIRMATION'),\n\t\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\t\tthis.makeDeleteRequest(params, aDeferred, instance);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.makeDeleteRequest(params, aDeferred, instance);\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t},\n\t{\n\t\tgetDeleteParams: function () {\n\t\t\treturn {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'DeleteAjax'\n\t\t\t};\n\t\t},\n\t\t/*\n\t\t * Function to register the list view container\n\t\t */\n\t\tgetListViewContainer() {\n\t\t\tif (this.listViewContainer == false) {\n\t\t\t\tthis.listViewContainer = $('div.contentsDiv');\n\t\t\t}\n\t\t\treturn this.listViewContainer;\n\t\t},\n\n\t\t/*\n\t\t * Function to register the list view delete record click event\n\t\t */\n\t\tDeleteRecord: function (url) {\n\t\t\tvar thisInstance = this;\n\n\t\t\tAppConnector.request(url).done(function (data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tapp.showModalWindow(data, function (container) {\n\t\t\t\t\t\tthisInstance.postDeleteAction(container);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to load list view after deletion of record from list view\n\t\t */\n\t\tpostDeleteAction: function (container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar deleteConfirmForm = jQuery(container).find('#DeleteModal');\n\t\t\tdeleteConfirmForm.on('submit', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar deleteActionUrl = deleteConfirmForm.serializeFormData();\n\t\t\t\tAppConnector.request(deleteActionUrl)\n\t\t\t\t\t.done(function () {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_RECORD_DELETED_SUCCESSFULLY')\n\t\t\t\t\t\t};\n\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\tjQuery('#recordsCount').val('');\n\t\t\t\t\t\tjQuery('#totalPageCount').text('');\n\t\t\t\t\t\tthisInstance.getListViewRecords().done(function () {\n\t\t\t\t\t\t\tthisInstance.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to get Page Jump Params\n\t\t */\n\t\tgetPageJumpParams: function () {\n\t\t\tvar module = app.getModuleName();\n\t\t\tvar cvId = this.getCurrentCvId();\n\t\t\tvar pageCountParams = {\n\t\t\t\tmodule: module,\n\t\t\t\tparent: 'Settings',\n\t\t\t\taction: 'ListAjax',\n\t\t\t\tmode: 'getPageCount',\n\t\t\t\tviewname: cvId\n\t\t\t};\n\t\t\tvar sourceModule = jQuery('#moduleFilter').val();\n\t\t\tif (typeof sourceModule !== 'undefined') {\n\t\t\t\tpageCountParams['sourceModule'] = sourceModule;\n\t\t\t}\n\t\t\treturn pageCountParams;\n\t\t},\n\t\t/**\n\t\t * Register button to create record\n\t\t */\n\t\tregisterButtons: function () {\n\t\t\tthis.getListViewContainer().on('click', '.js-add-record-modal, .js-edit-record-modal', (e) => {\n\t\t\t\tapp.showModalWindow({\n\t\t\t\t\turl: e.currentTarget.dataset.url,\n\t\t\t\t\tsendByAjaxCb: () => {\n\t\t\t\t\t\tthis.getListViewRecords();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tthis.registerRowClickEvent();\n\t\t\tthis.registerCheckBoxClickEvent();\n\t\t\tthis.registerHeadersClickEvent();\n\t\t\tthis.registerPageNavigationEvents();\n\t\t\tthis.registerEventForTotalRecordsCount();\n\t\t\tthis.registerButtons();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","triggerDelete","event","url","stopPropagation","instance","getInstance","DeleteRecord","makeDeleteRequest","params","aDeferred","AppConnector","request","done","data","response","result","success","$","val","text","getListViewRecords","updatePagination","app","showNotify","message","vtranslate","type","resolve","deleteById","id","_this","showConfirmation","arguments","length","jQuery","Deferred","extend","getDeleteParams","record","showConfirmModal","title","confirmedCallback","promise","module","getModuleName","parent","getParentModuleName","action","getListViewContainer","listViewContainer","thisInstance","showModalWindow","container","postDeleteAction","deleteConfirmForm","find","on","e","preventDefault","deleteActionUrl","serializeFormData","hideModalWindow","Settings_Vtiger_Index_Js","showMessage","fail","getPageJumpParams","cvId","getCurrentCvId","pageCountParams","mode","viewname","sourceModule","registerButtons","_this2","currentTarget","dataset","sendByAjaxCb","registerEvents","registerRowClickEvent","registerCheckBoxClickEvent","registerHeadersClickEvent","registerPageNavigationEvents","registerEventForTotalRecordsCount"],"mappings":"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"}