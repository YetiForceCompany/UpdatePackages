{"version":3,"file":"outlookMessageDetail.min.js","sources":["outlookMessageDetail.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\nwindow.MailIntegration_Start = {\n\tiframe: {},\n\t/**\n\t * Set iframe element.\n\t */\n\tsetIframe() {\n\t\tthis.iframe = $('#js-iframe');\n\t},\n\t/**\n\t * Show detail view.\n\t *\n\t * @param   {object}  mailItem  Office mailbox.item\n\t */\n\tshowDetailView(mailItem) {\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: 'MailIntegration',\n\t\t\t\t\tview: 'Iframe',\n\t\t\t\t\tmailFrom: mailItem.from.emailAddress,\n\t\t\t\t\tmailSender: mailItem.sender.emailAddress,\n\t\t\t\t\tmailSubject: mailItem.subject,\n\t\t\t\t\tmailNormalizedSubject: mailItem.normalizedSubject,\n\t\t\t\t\tmailMessageId: mailItem.internetMessageId,\n\t\t\t\t\tmailDateTimeCreated: mailItem.dateTimeCreated.toISOString()\n\t\t\t\t},\n\t\t\t\twindow.PanelParams\n\t\t\t)\n\t\t)\n\t\t\t.done((responseData) => {\n\t\t\t\t$('#page').html(responseData);\n\t\t\t\tthis.registerLogoutEvents();\n\t\t\t})\n\t\t\t.fail((_) => {\n\t\t\t\tOffice.context.mailbox.item.notificationMessages.replaceAsync('error', {\n\t\t\t\t\ttype: 'errorMessage',\n\t\t\t\t\tmessage: app.vtranslate('JS_ERROR')\n\t\t\t\t});\n\t\t\t});\n\t},\n\t/**\n\t * Register logout events\n\t */\n\tregisterLogoutEvents() {\n\t\tthis.setIframe();\n\t\tlet reloadPanelAfterLogout = () => {\n\t\t\tif (!this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogout);\n\t},\n\t/**\n\t * Register login events.\n\t */\n\tregisterLoginEvents() {\n\t\tlet loader;\n\t\tlet reloadPanelAfterLogin = () => {\n\t\t\tif (this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t} else {\n\t\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\t}\n\t\t};\n\t\tlet showLoader = () => {\n\t\t\tloader = $.progressIndicator({\n\t\t\t\tblockInfo: { enabled: true },\n\t\t\t\tmessage: false,\n\t\t\t\tblockOverlayCSS: {\n\t\t\t\t\t'background-color': 'white',\n\t\t\t\t\topacity: 1\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogin);\n\t\t$(this.iframe[0].contentWindow).on('unload', showLoader);\n\t\tlet src = this.iframe[0].getAttribute('src-a');\n\t\tif (src && this.iframe[0].getAttribute('src') == undefined) {\n\t\t\tthis.iframe[0].removeAttribute('src-a');\n\t\t\tthis.iframe[0].setAttribute('src', src);\n\t\t}\n\t},\n\t/**\n\t * Is user logged in.\n\t *\n\t * @return  {boolean}\n\t */\n\tisUserLoggedIn() {\n\t\treturn !(\n\t\t\tthis.iframe[0].contentWindow.document.body.dataset.module == 'Users' &&\n\t\t\tthis.iframe[0].contentWindow.document.body.dataset.view == 'Login'\n\t\t);\n\t},\n\tshowConsole() {\n\t\tlet s = '';\n\t\tlet x = '';\n\t\tfor (var p in navigator) {\n\t\t\ts += p + ' : ' + navigator[p] + '<br>';\n\t\t\tx += p + ' : ' + navigator[p] + '\\n';\n\t\t}\n\t\tconsole.log(x);\n\t\tdocument.body.innerHTML +=\n\t\t\t'<div style=\"position:absolute;width:100%;height:100%;z-index:100;background:#fff;left: 0px; top: 50%;overflow-y: auto;\">' +\n\t\t\ts +\n\t\t\t'</div>';\n\t},\n\t/**\n\t * Register events.\n\t *\n\t * @param   {object}  mailbox  Office mailbox\n\t */\n\tregisterEvents(mailbox) {\n\t\t//this.showConsole();\n\t\tif (!$('.js-exception-error').length) {\n\t\t\tthis.setIframe();\n\t\t\tif (this.iframe.data('view') === 'login') {\n\t\t\t\tthis.registerLoginEvents();\n\t\t\t} else {\n\t\t\t\tthis.showDetailView(mailbox.item);\n\t\t\t}\n\t\t}\n\t},\n\treloadView(data) {\n\t\twindow.MailIntegration_Start.showDetailView(Office.context.mailbox.item);\n\t}\n};\nif (typeof Office === 'undefined') {\n\tapp.showNotify({\n\t\ttitle: app.vtranslate('JS_ERROR'),\n\t\ttype: 'error'\n\t});\n} else {\n\tOffice.onReady((info) => {\n\t\twindow.PanelParams = {\n\t\t\tsource: 'Outlook',\n\t\t\tdevice: Office.context.mailbox.diagnostics.hostName\n\t\t};\n\t\tif (info.host === Office.HostType.Outlook) {\n\t\t\twindow.MailIntegration_Start.registerEvents(Office.context.mailbox);\n\t\t\tOffice.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged, window.MailIntegration_Start.reloadView);\n\t\t}\n\t});\n}\n"],"names":["window","MailIntegration_Start","iframe","setIframe","$","showDetailView","mailItem","_this","AppConnector","request","extend","module","view","mailFrom","from","emailAddress","mailSender","sender","mailSubject","subject","mailNormalizedSubject","normalizedSubject","mailMessageId","internetMessageId","mailDateTimeCreated","dateTimeCreated","toISOString","PanelParams","done","responseData","html","registerLogoutEvents","fail","Office","context","mailbox","item","notificationMessages","replaceAsync","type","message","app","vtranslate","_this2","on","reloadPanelAfterLogout","isUserLoggedIn","location","reload","registerLoginEvents","loader","_this3","reloadPanelAfterLogin","progressIndicator","mode","contentWindow","showLoader","blockInfo","enabled","blockOverlayCSS","\"background-color\"","opacity","src","getAttribute","removeAttribute","setAttribute","document","body","dataset","showConsole","s","x","p","navigator","console","log","innerHTML","registerEvents","length","data","reloadView","showNotify","title","onReady","info","source","device","diagnostics","hostName","host","HostType","Outlook","addHandlerAsync","EventType","ItemChanged"],"mappings":"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"}