{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/**\n * Fields dependency edit view js class\n *\n * @package     Settings.Edit\n *\n * @description Fields dependency edit view scripts\n * @license     YetiForce Public License 6.5\n * @author      Mariusz Krzaczkowski <m.krzaczkowski@yetiforce.com>\n */\n'use strict';\n\n$.Class(\n\t'Settings_FieldsDependency_Edit_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Register submit event\n\t\t */\n\t\tregisterSubmitEvent() {\n\t\t\tthis.container.off('submit').on('submit', (e) => {\n\t\t\t\tif ($(e.currentTarget).validationEngine('validate')) {\n\t\t\t\t\tthis.container.find('input[name=\"conditions\"]').val(JSON.stringify(this.conditionBuilder.getConditions()));\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Load condition builder\n\t\t */\n\t\tloadConditionBuilderView() {\n\t\t\tthis.conditionBuilder = new Vtiger_ConditionBuilder_Js(\n\t\t\t\tthis.container.find('.js-condition-builder'),\n\t\t\t\tthis.sourceModule\n\t\t\t);\n\t\t\tthis.conditionBuilder.registerEvents();\n\t\t},\n\t\t/**\n\t\t * Register source module change\n\t\t */\n\t\tregisterSourceModuleChange() {\n\t\t\tlet select = this.container.find('#inputSourceModule');\n\t\t\tlet blocks = this.container.find('.js-dynamic-blocks');\n\t\t\tselect.on('change', (e) => {\n\t\t\t\tthis.sourceModule = select.find('option:selected').data('module');\n\t\t\t\tblocks.html('');\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tview: 'Edit',\n\t\t\t\t\tmode: 'dynamic',\n\t\t\t\t\tselectedModule: this.sourceModule\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tblocks.html(data);\n\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(blocks);\n\t\t\t\t\tthis.loadConditionBuilderView();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterAddDependField() {\n\t\t\tthis.container.find('.js-dependence-add-field').on('click', (e) => {\n\t\t\t\tlet progress = $.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.sourceModule = select.find('option:selected').data('module');\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tview: 'FieldDependence',\n\t\t\t\t\tmode: 'dependencyRow',\n\t\t\t\t\tselectedModule: this.sourceModule\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\tblocks.html(data);\n\t\t\t\t\tApp.Fields.Picklist.changeSelectElementView(blocks);\n\t\t\t\t\tthis.loadConditionBuilderView();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents() {\n\t\t\tthis.container = $('#EditView');\n\t\t\tthis.sourceModule = this.container.find('#inputSourceModule').data('module');\n\t\t\tthis.record = this.container.find('input[name=\"record\"]').val();\n\t\t\tthis.registerSourceModuleChange();\n\t\t\tthis.loadConditionBuilderView();\n\t\t\tthis.registerSubmitEvent();\n\t\t\tthis.registerAddDependField();\n\t\t\tthis.container.validationEngine(app.validationEngineOptions);\n\t\t}\n\t}\n);\n"],"names":["$","Class","registerSubmitEvent","_this","container","off","on","e","currentTarget","validationEngine","find","val","JSON","stringify","conditionBuilder","getConditions","preventDefault","stopPropagation","loadConditionBuilderView","Vtiger_ConditionBuilder_Js","sourceModule","registerEvents","registerSourceModuleChange","_this2","select","blocks","data","html","AppConnector","request","module","app","getModuleName","parent","getParentModuleName","view","mode","selectedModule","done","App","Fields","Picklist","changeSelectElementView","registerAddDependField","_this3","progress","progressIndicator","position","blockInfo","enabled","record","validationEngineOptions"],"mappings":"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"}