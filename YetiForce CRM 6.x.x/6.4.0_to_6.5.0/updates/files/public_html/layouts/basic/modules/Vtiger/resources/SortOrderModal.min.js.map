{"version":3,"file":"SortOrderModal.min.js","sources":["SortOrderModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Base_SortOrderModal_JS',\n\t{},\n\t{\n\t\t/**\n\t\t * Modal container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Source container\n\t\t */\n\t\tsourceContainer: false,\n\t\t/**\n\t\t * Modal ID\n\t\t */\n\t\tsource: false,\n\t\t/**\n\t\t * Load data\n\t\t */\n\t\tloadData: function () {\n\t\t\tlet orderBy = this.sourceContainer.find('#orderBy').val();\n\t\t\torderBy = orderBy ? JSON.parse(orderBy) : [];\n\t\t\tif (orderBy && Object.keys(orderBy).length) {\n\t\t\t\tlet baseOrderBy = this.container.find('.js-base-element');\n\t\t\t\tfor (let field in orderBy) {\n\t\t\t\t\tif (!baseOrderBy.find(\"option[value='\" + field + \"']\").length) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet element = this.addRow();\n\t\t\t\t\telement.find('select.js-orderBy').val(field).change();\n\t\t\t\t\tlet sortIcon = element.find('.js-sort-icon-active');\n\t\t\t\t\tif (orderBy[field] && sortIcon.data('val') != orderBy[field]) {\n\t\t\t\t\t\tsortIcon.trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Add new row\n\t\t */\n\t\taddRow: function () {\n\t\t\tlet sortContainer = this.container.find('.js-base-element').clone(true, true).removeClass('js-base-element');\n\t\t\tthis.container.find('.js-sort-container').append(sortContainer);\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(sortContainer.find('select'));\n\t\t\treturn sortContainer.removeClass('d-none');\n\t\t},\n\t\t/**\n\t\t * Register list events\n\t\t */\n\t\tregisterListEvents: function () {\n\t\t\tthis.container.find('.js-add').on('click', (e) => {\n\t\t\t\tthis.addRow();\n\t\t\t});\n\t\t\tthis.container.find('.js-clear').on('click', (e) => {\n\t\t\t\t$(e.currentTarget).closest('.js-sort-container_element').remove();\n\t\t\t});\n\t\t\tthis.container.find('.js-sort-order-button').on('click', (e) => {\n\t\t\t\tlet element = $(e.currentTarget).closest('.js-sort-container_element');\n\t\t\t\telement.find('.js-sort-icon').toggleClass('d-none js-sort-icon-active');\n\t\t\t\telement.find('.js-sort-order').val(element.find('.js-sort-icon-active').data('val'));\n\t\t\t});\n\t\t\tthis.container.find('.js-modal__save').on('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.sourceContainer.find('.js-list-reload').trigger('click', { orderby: this.getSortData() });\n\t\t\t\tapp.hideModalWindow(null, this.source);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Gets sort data\n\t\t */\n\t\tgetSortData: function () {\n\t\t\tlet sortData = {};\n\t\t\tthis.container.find('.js-sort-container_element:not(.js-base-element)').each(function () {\n\t\t\t\tlet orderBy = $(this).find('.js-orderBy').val();\n\t\t\t\tif (orderBy) {\n\t\t\t\t\tsortData[orderBy] = $(this).find('.js-sort-order').val();\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn sortData;\n\t\t},\n\t\t/**\n\t\t * Gets basic container\n\t\t */\n\t\tgetSourceContainer: function () {\n\t\t\treturn $('[data-modalid=' + this.source + ']').closest(\n\t\t\t\t'.listViewContentDiv,.relatedContainer,.js-main-container'\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * Register modal events\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.container = modalContainer;\n\t\t\tthis.source = modalContainer.closest('.js-modal-container').attr('id');\n\t\t\tthis.sourceContainer = this.getSourceContainer();\n\t\t\tthis.registerListEvents();\n\t\t\tthis.loadData();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","sourceContainer","source","loadData","orderBy","find","val","JSON","parse","Object","keys","length","baseOrderBy","field","element","addRow","change","sortIcon","data","trigger","sortContainer","clone","removeClass","append","App","Fields","Picklist","showSelect2ElementView","registerListEvents","_this","on","e","currentTarget","closest","remove","toggleClass","preventDefault","orderby","getSortData","app","hideModalWindow","sortData","each","getSourceContainer","registerEvents","modalContainer","attr"],"mappings":";;AAAA,kKACA,YAAY,CAEZA,CAAC,CAACC,KAAK,CACN,wBAAwB,CACxB,EAAE,CACF;AAED;AACA,KACEC,SAAS,GAAO;AAElB;AACA,KACEC,eAAe,GAAO;AAExB;AACA,KACEC,MAAM,GAAO;AAEf;AACA,KACEC,QAAQ,CAAE,SAAAA,QAAAA,EAAY,CACrB,IAAIC,OAAO,CAAG,IAAI,CAACH,eAAe,CAACI,IAAI,CAAC,UAAU,CAAC,CAACC,GAAG,EAAE,CAEzD,GADAF,OAAO,CAAGA,OAAO,CAAGG,IAAI,CAACC,KAAK,CAACJ,OAAO,CAAC,CAAG,EAAE,CACxCA,OAAO,EAAIK,MAAM,CAACC,IAAI,CAACN,OAAO,CAAC,CAACO,MAAM,CAAE,CAC3C,IAAIC,WAAW,CAAG,IAAI,CAACZ,SAAS,CAACK,IAAI,CAAC,kBAAkB,CAAC,CACzD,IAAK,IAAIQ,KAAK,IAAIT,OAAO,CACxB,GAAKQ,WAAW,CAACP,IAAI,CAAC,gBAAgB,CAAGQ,KAAK,CAAG,IAAI,CAAC,CAACF,MAAM,CAG7D,CAAA,IAAIG,OAAO,CAAG,IAAI,CAACC,MAAM,EAAE,CAC3BD,OAAO,CAACT,IAAI,CAAC,mBAAmB,CAAC,CAACC,GAAG,CAACO,KAAK,CAAC,CAACG,MAAM,EAAE,CACrD,IAAIC,QAAQ,CAAGH,OAAO,CAACT,IAAI,CAAC,sBAAsB,CAAC,CAC/CD,OAAO,CAACS,KAAK,CAAC,EAAII,QAAQ,CAACC,IAAI,CAAC,KAAK,CAAC,EAAId,OAAO,CAACS,KAAK,CAAC,EAC3DI,QAAQ,CAACE,OAAO,CAAC,OAAO,EAAC,CAG5B,CAAC,SACI,CAACJ,MAAM,GAEb,CAAC;AAEH;AACA,KACEA,MAAM,CAAE,SAAAA,MAAAA,EAAY,CACnB,IAAIK,aAAa,CAAG,IAAI,CAACpB,SAAS,CAACK,IAAI,CAAC,kBAAkB,CAAC,CAACgB,KAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAW,CAAC,CAACC,WAAW,CAAC,iBAAiB,CAAC,CAG5G,OAFA,IAAI,CAACtB,SAAS,CAACK,IAAI,CAAC,oBAAoB,CAAC,CAACkB,MAAM,CAACH,aAAa,CAAC,CAC/DI,GAAG,CAACC,MAAM,CAACC,QAAQ,CAACC,sBAAsB,CAACP,aAAa,CAACf,IAAI,CAAC,QAAQ,CAAC,CAAC,CACjEe,aAAa,CAACE,WAAW,CAAC,QAAQ,CAC1C,CAAC;AAEH;AACA,KACEM,kBAAkB,CAAE,SAAAA,kBAAAA,EAAY,CAAAC,IAAAA,KAAA,MAC/B,IAAI,CAAC7B,SAAS,CAACK,IAAI,CAAC,SAAS,CAAC,CAACyB,EAAE,CAAC,OAAO,CAAE,UAAO,CACjDD,KAAI,CAACd,MAAM,GACZ,CAAC,CAAC,CACF,IAAI,CAACf,SAAS,CAACK,IAAI,CAAC,WAAW,CAAC,CAACyB,EAAE,CAAC,OAAO,CAAE,SAACC,CAAC,CAAK,CACnDjC,CAAC,CAACiC,CAAC,CAACC,aAAa,CAAC,CAACC,OAAO,CAAC,4BAA4B,CAAC,CAACC,MAAM,GAChE,CAAC,CAAC,CACF,IAAI,CAAClC,SAAS,CAACK,IAAI,CAAC,uBAAuB,CAAC,CAACyB,EAAE,CAAC,OAAO,CAAE,SAACC,CAAC,CAAK,CAC/D,IAAIjB,OAAO,CAAGhB,CAAC,CAACiC,CAAC,CAACC,aAAa,CAAC,CAACC,OAAO,CAAC,4BAA4B,CAAC,CACtEnB,OAAO,CAACT,IAAI,CAAC,eAAe,CAAC,CAAC8B,WAAW,CAAC,4BAA4B,CAAC,CACvErB,OAAO,CAACT,IAAI,CAAC,gBAAgB,CAAC,CAACC,GAAG,CAACQ,OAAO,CAACT,IAAI,CAAC,sBAAsB,CAAC,CAACa,IAAI,CAAC,KAAK,CAAC,EACpF,CAAC,CAAC,CACF,IAAI,CAAClB,SAAS,CAACK,IAAI,CAAC,iBAAiB,CAAC,CAACyB,EAAE,CAAC,OAAO,CAAE,SAACC,CAAC,CAAK,CACzDA,CAAC,CAACK,cAAc,EAAE,CAClBP,KAAI,CAAC5B,eAAe,CAACI,IAAI,CAAC,iBAAiB,CAAC,CAACc,OAAO,CAAC,OAAO,CAAE,CAAEkB,OAAO,CAAER,KAAI,CAACS,WAAW,EAAG,CAAC,CAAC,CAC9FC,GAAG,CAACC,eAAe,CAAC,IAAI,CAAEX,KAAI,CAAC3B,MAAM,EACtC,CAAC,EACF,CAAC;AAEH;AACA,KACEoC,WAAW,CAAE,SAAAA,WAAAA,EAAY,CACxB,IAAIG,QAAQ,CAAG,EAAE,CAOjB,OANI,IAAA,CAACzC,SAAS,CAACK,IAAI,CAAC,kDAAkD,CAAC,CAACqC,IAAI,CAAC,UAAY,CACxF,IAAItC,OAAO,CAAGN,CAAC,CAAC,IAAI,CAAC,CAACO,IAAI,CAAC,aAAa,CAAC,CAACC,GAAG,EAAE,CAC3CF,OAAO,GACVqC,QAAQ,CAACrC,OAAO,CAAC,CAAGN,CAAC,CAAC,IAAI,CAAC,CAACO,IAAI,CAAC,gBAAgB,CAAC,CAACC,GAAG,EAAE,EAE1D,CAAC,CAAC,CACKmC,QACR,CAAC;AAEH;AACA,KACEE,kBAAkB,CAAE,SAAAA,kBAAA,EAAY,CAC/B,OAAO7C,CAAC,CAAC,gBAAgB,CAAG,IAAI,CAACI,MAAM,CAAG,GAAG,CAAC,CAAC+B,OAAO,CACrD,0DACD,CACD,CAAC;AAEH;AACA;AACA,KACEW,cAAc,CAAE,SAAAA,cAAUC,CAAAA,cAAc,CAAE,CACzC,IAAI,CAAC7C,SAAS,CAAG6C,cAAc,CAC/B,IAAI,CAAC3C,MAAM,CAAG2C,cAAc,CAACZ,OAAO,CAAC,qBAAqB,CAAC,CAACa,IAAI,CAAC,IAAI,CAAC,CACtE,IAAI,CAAC7C,eAAe,CAAG,IAAI,CAAC0C,kBAAkB,EAAE,CAChD,IAAI,CAACf,kBAAkB,EAAE,CACzB,IAAI,CAACzB,QAAQ,GACd,CACD,CACD,CAAC;;"}