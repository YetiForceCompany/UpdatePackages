{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_Detail_Js(\n\t'Project_Detail_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Function to register event for create related record\n\t\t * in summary view widgets\n\t\t */\n\t\tregisterSummaryViewContainerEvents: function (summaryViewContainer) {\n\t\t\tthis._super(summaryViewContainer);\n\t\t},\n\t\t/**\n\t\t * Function to load module summary of Projects\n\t\t */\n\t\tloadModuleSummary: function () {\n\t\t\tvar summaryParams = {};\n\t\t\tsummaryParams['module'] = app.getModuleName();\n\t\t\tsummaryParams['view'] = 'Detail';\n\t\t\tsummaryParams['mode'] = 'showModuleSummaryView';\n\t\t\tsummaryParams['record'] = jQuery('#recordId').val();\n\t\t\tAppConnector.request(summaryParams).done(function (data) {\n\t\t\t\tjQuery('.js-widget-general-info').html(data);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Load gantt component\n\t\t */\n\t\tloadGantt() {\n\t\t\tlet ganttContainer = $('.c-gantt', this.detailViewContentHolder);\n\t\t\tif (ganttContainer.length) {\n\t\t\t\tlet gantt = new Project_Gantt_Js(this.detailViewContentHolder);\n\t\t\t\tgantt.registerEvents();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Load gantt component when needed\n\t\t */\n\t\tregisterGantt() {\n\t\t\tthis.loadGantt();\n\t\t\tapp.event.on('DetailView.Tab.AfterLoad', (e, data, instance) => {\n\t\t\t\tinstance.detailViewContentHolder.ready(() => {\n\t\t\t\t\tthis.loadGantt();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to get response from hierarchy\n\t\t * @param {array} params\n\t\t * @returns {jQuery}\n\t\t */\n\t\tgetHierarchyResponseData: function (params) {\n\t\t\tlet thisInstance = this,\n\t\t\t\taDeferred = $.Deferred();\n\t\t\tif (!$.isEmptyObject(thisInstance.hierarchyResponseCache)) {\n\t\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t\t} else {\n\t\t\t\tAppConnector.request(params).then(function (data) {\n\t\t\t\t\tthisInstance.hierarchyResponseCache = data;\n\t\t\t\t\taDeferred.resolve(thisInstance.hierarchyResponseCache);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * Function to display the hierarchy response data\n\t\t * @param {array} data\n\t\t */\n\t\tdisplayHierarchyResponseData: function (data) {\n\t\t\tlet callbackFunction = function () {\n\t\t\t\tapp.showScrollBar($('#hierarchyScroll'), {\n\t\t\t\t\theight: '300px',\n\t\t\t\t\trailVisible: true,\n\t\t\t\t\tsize: '6px'\n\t\t\t\t});\n\t\t\t};\n\t\t\tapp.showModalWindow(data, function (modalContainer) {\n\t\t\t\tApp.Components.Scrollbar.xy($('#hierarchyScroll', modalContainer));\n\t\t\t\tif (typeof callbackFunction == 'function' && $('#hierarchyScroll', modalContainer).height() > 300) {\n\t\t\t\t\tcallbackFunction();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Registers read count of hierarchy if it is possible\n\t\t */\n\t\tregisterHierarchyRecordCount: function () {\n\t\t\tlet hierarchyButton = $('.js-detail-hierarchy'),\n\t\t\t\tparams = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'RelationAjax',\n\t\t\t\t\trecord: app.getRecordId(),\n\t\t\t\t\tmode: 'getHierarchyCount'\n\t\t\t\t};\n\t\t\tif (hierarchyButton.length) {\n\t\t\t\tAppConnector.request(params).then(function (response) {\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t$('.hierarchy .badge').html(response.result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Shows hierarchy\n\t\t */\n\t\tregisterShowHierarchy: function () {\n\t\t\tlet thisInstance = this,\n\t\t\t\thierarchyButton = $('.detailViewTitle'),\n\t\t\t\tparams = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Hierarchy',\n\t\t\t\t\trecord: app.getRecordId()\n\t\t\t\t};\n\t\t\thierarchyButton.on('click', '.js-detail-hierarchy', function () {\n\t\t\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisInstance.getHierarchyResponseData(params).then(function (data) {\n\t\t\t\t\tthisInstance.displayHierarchyResponseData(data);\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tvar detailContentsHolder = this.getContentHolder();\n\t\t\tvar thisInstance = this;\n\t\t\tthis._super();\n\t\t\tdetailContentsHolder.on('click', '.moreRecentTickets', function () {\n\t\t\t\tvar recentTicketsTab = thisInstance.getTabByLabel(thisInstance.detailViewRecentTicketsTabLabel);\n\t\t\t\trecentTicketsTab.trigger('click');\n\t\t\t});\n\t\t\tthis.registerGantt();\n\t\t\tthis.registerHierarchyRecordCount();\n\t\t\tthis.registerShowHierarchy();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","registerSummaryViewContainerEvents","summaryViewContainer","_super","loadModuleSummary","summaryParams","module","app","getModuleName","view","mode","record","jQuery","val","AppConnector","request","done","data","html","loadGantt","ganttContainer","$","detailViewContentHolder","length","gantt","Project_Gantt_Js","registerEvents","registerGantt","_this","event","on","e","instance","ready","getHierarchyResponseData","params","thisInstance","aDeferred","Deferred","isEmptyObject","hierarchyResponseCache","then","resolve","promise","displayHierarchyResponseData","callbackFunction","showScrollBar","height","railVisible","size","showModalWindow","modalContainer","App","Components","Scrollbar","xy","registerHierarchyRecordCount","hierarchyButton","action","getRecordId","response","success","result","registerShowHierarchy","progressIndicatorElement","progressIndicator","position","blockInfo","enabled","detailContentsHolder","getContentHolder","recentTicketsTab","getTabByLabel","detailViewRecentTicketsTabLabel","trigger"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFACA,YAAY,CAEZA,gBAAgB,CACf,mBAAmB,CACnB,EAAE,CACF;AAED;AACA;AACA,KACEC,kCAAkC,CAAE,SAAAA,kCAAAA,CAAUC,oBAAoB,CAAE,CACnE,IAAI,CAACC,MAAM,CAACD,oBAAoB,EACjC,CAAC;AAEH;AACA,KACEE,iBAAiB,CAAE,SAAAA,iBAAAA,EAAY,CAC9B,IAAIC,aAAa,CAAG,EAAE,CACtBA,aAAa,CAAAC,MAAU,CAAGC,GAAG,CAACC,aAAa,EAAE,CAC7CH,aAAa,CAAAI,IAAQ,CAAG,QAAQ,CAChCJ,aAAa,CAAAK,IAAQ,CAAG,uBAAuB,CAC/CL,aAAa,CAAAM,MAAU,CAAGC,MAAM,CAAC,WAAW,CAAC,CAACC,GAAG,EAAE,CACnDC,YAAY,CAACC,OAAO,CAACV,aAAa,CAAC,CAACW,IAAI,CAAC,SAAUC,IAAI,CAAE,CACxDL,MAAM,CAAC,yBAAyB,CAAC,CAACM,IAAI,CAACD,IAAI,EAC5C,CAAC,EACF,CAAC;AAEH;AACA,KACEE,SAAS,UAAAA,SAAA,EAAG,CACX,IAAIC,cAAc,CAAGC,CAAC,CAAC,UAAU,CAAE,IAAI,CAACC,uBAAuB,CAAC,CAChE,GAAIF,cAAc,CAACG,MAAM,CAAE,CAC1B,IAAIC,KAAK,CAAG,IAAIC,gBAAgB,CAAC,IAAI,CAACH,uBAAuB,CAAC,CAC9DE,KAAK,CAACE,cAAc,GACrB,CACD,CAAC;AAEH;AACA,KACEC,aAAa,UAAAA,aAAA,EAAG,KAAAC,KAAA,CAAA,IAAA,CACf,IAAI,CAACT,SAAS,EAAE,CAChBZ,GAAG,CAACsB,KAAK,CAACC,EAAE,CAAC,0BAA0B,CAAE,SAACC,CAAC,CAAEd,IAAI,CAAEe,QAAQ,CAAK,CAC/DA,QAAQ,CAACV,uBAAuB,CAACW,KAAK,CAAC,UAAM,CAC5CL,KAAI,CAACT,SAAS,GACf,CAAC,EACF,CAAC,EACF,CAAC;AAEH;AACA;AACA;AACA,KACEe,wBAAwB,CAAE,SAAAA,wBAAUC,CAAAA,MAAM,CAAE,CAC3C,IAAIC,YAAY,CAAG,IAAI,CACtBC,SAAS,CAAGhB,CAAC,CAACiB,QAAQ,EAAE,CASzB,OARKjB,CAAC,CAACkB,aAAa,CAACH,YAAY,CAACI,sBAAsB,CAAC,CAGxD1B,YAAY,CAACC,OAAO,CAACoB,MAAM,CAAC,CAACM,IAAI,CAAC,SAAUxB,IAAI,CAAE,CACjDmB,YAAY,CAACI,sBAAsB,CAAGvB,IAAI,CAC1CoB,SAAS,CAACK,OAAO,CAACN,YAAY,CAACI,sBAAsB,EACtD,CAAC,CAAC,CALFH,SAAS,CAACK,OAAO,CAACN,YAAY,CAACI,sBAAsB,CAAC,CAOhDH,SAAS,CAACM,OAAO,EACzB,CAAC;AAEH;AACA;AACA,KACEC,4BAA4B,CAAE,SAAAA,6BAAU3B,IAAI,CAAE,CAC7C,IAAI4B,gBAAgB,CAAG,UAAY,CAClCtC,GAAG,CAACuC,aAAa,CAACzB,CAAC,CAAC,kBAAkB,CAAC,CAAE,CACxC0B,MAAM,CAAE,OAAO,CACfC,WAAW,GAAM,CACjBC,IAAI,CAAE,KACP,CAAC,EACF,CAAC,CACD1C,GAAG,CAAC2C,eAAe,CAACjC,IAAI,CAAE,SAAUkC,cAAc,CAAE,CACnDC,GAAG,CAACC,UAAU,CAACC,SAAS,CAACC,EAAE,CAAClC,CAAC,CAAC,kBAAkB,CAAE8B,cAAc,CAAC,CAAC,CACnC,UAAU,EAArC,OAAON,gBAA8B,EAAqD,GAAG,CAApDxB,CAAC,CAAC,kBAAkB,CAAE8B,cAAc,CAAC,CAACJ,MAAM,EAAQ,EAChGF,gBAAgB,GAElB,CAAC,EACF,CAAC;AAEH;AACA,KACEW,4BAA4B,CAAE,SAAAA,4BAAA,EAAY,CACzC,IAAIC,eAAe,CAAGpC,CAAC,CAAC,sBAAsB,CAAC,CAC9Cc,MAAM,CAAG,CACR7B,MAAM,CAAEC,GAAG,CAACC,aAAa,EAAE,CAC3BkD,MAAM,CAAE,cAAc,CACtB/C,MAAM,CAAEJ,GAAG,CAACoD,WAAW,EAAE,CACzBjD,IAAI,CAAE,mBACP,CAAC,CACE+C,eAAe,CAAClC,MAAM,EACzBT,YAAY,CAACC,OAAO,CAACoB,MAAM,CAAC,CAACM,IAAI,CAAC,SAAUmB,QAAQ,CAAE,CACjDA,QAAQ,CAACC,OAAO,EACnBxC,CAAC,CAAC,mBAAmB,CAAC,CAACH,IAAI,CAAC0C,QAAQ,CAACE,MAAM,EAE7C,CAAC,EAEH,CAAC;AAEH;AACA,KACEC,qBAAqB,CAAE,SAAAA,qBAAA,EAAY,CAClC,IAAI3B,YAAY,CAAG,IAAI,CACtBqB,eAAe,CAAGpC,CAAC,CAAC,kBAAkB,CAAC,CACvCc,MAAM,CAAG,CACR7B,MAAM,CAAEC,GAAG,CAACC,aAAa,EAAE,CAC3BC,IAAI,CAAE,WAAW,CACjBE,MAAM,CAAEJ,GAAG,CAACoD,WAAW,EACxB,CAAC,CACFF,eAAe,CAAC3B,EAAE,CAAC,OAAO,CAAE,sBAAsB,CAAE,UAAY,CAC/D,IAAIkC,wBAAwB,CAAG3C,CAAC,CAAC4C,iBAAiB,CAAC,CAClDC,QAAQ,CAAE,MAAM,CAChBC,SAAS,CAAE,CACVC,OAAO,CACR,CAAA,CAAA,CACD,CAAC,CAAC,CACFhC,YAAY,CAACF,wBAAwB,CAACC,MAAM,CAAC,CAACM,IAAI,CAAC,SAAUxB,IAAI,CAAE,CAClEmB,YAAY,CAACQ,4BAA4B,CAAC3B,IAAI,CAAC,CAC/C+C,wBAAwB,CAACC,iBAAiB,CAAC,CAAEvD,IAAI,CAAE,MAAO,CAAC,EAC5D,CAAC,EACF,CAAC,EACF,CAAC;AAEH;AACA,KACEgB,cAAc,CAAE,SAAAA,cAAA,EAAY,KACvB2C,oBAAoB,CAAG,IAAI,CAACC,gBAAgB,EAAE,CAC9ClC,YAAY,CAAG,IAAI,CACvB,IAAI,CAACjC,MAAM,EAAE,CACbkE,oBAAoB,CAACvC,EAAE,CAAC,OAAO,CAAE,oBAAoB,CAAE,UAAY,CAClE,IAAIyC,gBAAgB,CAAGnC,YAAY,CAACoC,aAAa,CAACpC,YAAY,CAACqC,+BAA+B,CAAC,CAC/FF,gBAAgB,CAACG,OAAO,CAAC,OAAO,EACjC,CAAC,CAAC,CACF,IAAI,CAAC/C,aAAa,EAAE,CACpB,IAAI,CAAC6B,4BAA4B,EAAE,CACnC,IAAI,CAACO,qBAAqB,GAC3B,CACD,CACD,CAAC;;"}