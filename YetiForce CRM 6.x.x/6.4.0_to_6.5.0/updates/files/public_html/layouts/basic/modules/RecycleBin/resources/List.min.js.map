{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_List_Js(\n\t'RecycleBin_List_Js',\n\t{\n\t\t/**\n\t\t * Mass activation trigerred on the list\n\t\t */\n\t\tmassActivation: function () {\n\t\t\tconst self = this;\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_MASS_ACTIVATE'),\n\t\t\t\ttext: app.vtranslate('JS_ACTIVATE_RECORD_DESC'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\t\tparams.state = 'Active';\n\t\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\t\tparams.action = 'MassState';\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Mass delete trigerred on the list\n\t\t */\n\t\tmassDelete: function () {\n\t\t\tconst self = this;\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.vtranslate('JS_MASS_DELETE'),\n\t\t\t\ttext: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tlet params = self.getSelectedRecordsParams(),\n\t\t\t\t\t\tlistInstance = Vtiger_List_Js.getInstance(),\n\t\t\t\t\t\tcontainer = listInstance.getListViewContainer();\n\t\t\t\t\tparams.module = container.find('.js-source-module').val();\n\t\t\t\t\tparams.sourceModule = container.find('.js-source-module').val();\n\t\t\t\t\tparams.action = 'MassDelete';\n\t\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\t\tparams.viewname = 'undefined';\n\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\tif (data && data.result && data.result.notify) {\n\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(data.result.notify);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlistInstance.getListViewRecords({\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t/**\n\t\t * Register module select\n\t\t */\n\t\tregisterModuleFilter: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tlet filterSelectElement = container.find('.js-source-module');\n\t\t\tfilterSelectElement.on('select2:selecting', function (e) {\n\t\t\t\tself\n\t\t\t\t\t.getListViewRecords({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\tview: 'List',\n\t\t\t\t\t\tsourceModule: e.params.args.data.id\n\t\t\t\t\t})\n\t\t\t\t\t.done(function () {\n\t\t\t\t\t\tself.calculatePages().done(function () {\n\t\t\t\t\t\t\tcontainer.find('.js-pagination-list').data('totalCount', 0);\n\t\t\t\t\t\t\tself.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to update pagination page numer\n\t\t * @param {boolean} force\n\t\t */\n\t\tupdatePaginationAjax(force = false) {\n\t\t\tconst self = this,\n\t\t\t\tlistViewPageDiv = this.getListViewContainer();\n\t\t\tlet params = self.getDefaultParams(),\n\t\t\t\tcontainer = listViewPageDiv.find('.paginationDiv');\n\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\ttitle: app.vtranslate('JS_LBL_PERMISSION'),\n\t\t\t\ttext: app.vtranslate('JS_GET_PAGINATION_INFO'),\n\t\t\t\ttype: 'info'\n\t\t\t});\n\t\t\tif (container.find('.js-pagination-list').data('total-count') > 0 || force) {\n\t\t\t\tparams.totalCount = '-1';\n\t\t\t\tparams.view = 'Pagination';\n\t\t\t\tparams.mode = 'getPagination';\n\t\t\t\tparams.entityState = 'Trash';\n\t\t\t\tparams.module = listViewPageDiv.find('.js-source-module').val();\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tcontainer.html(data);\n\t\t\t\t\tself.registerPageNavigationEvents();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Register empty recycle button\n\t\t */\n\t\tregisterEmptyRecycle: function () {\n\t\t\tconst self = this,\n\t\t\t\tcontainer = this.getListViewContainer();\n\t\t\tcontainer.find('.js-recycle-empty').on('click', function () {\n\t\t\t\tapp.showConfirmModal({\n\t\t\t\t\ttitle: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD'),\n\t\t\t\t\ttext: app.vtranslate('JS_DELETE_ALL_RECYCLE_RECORD_DESC'),\n\t\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\t\tlet progressIndicatorElement = $.progressIndicator();\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'RecycleBin',\n\t\t\t\t\t\t\tsourceModule: container.find('.js-source-module').val(),\n\t\t\t\t\t\t\taction: 'MassDeleteAll',\n\t\t\t\t\t\t\tsourceView: 'List'\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\tlet result = {\n\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_FAILED_TO_SAVE')\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tif (data && data.result) {\n\t\t\t\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ADDED_TO_QUEUE'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage(result);\n\t\t\t\t\t\t\t\tself.getListViewRecords();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function (error, err) {\n\t\t\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Get record list of actual selected module\n\t\t * @param {string} urlParams\n\t\t * @returns {*|jQuery}\n\t\t */\n\t\tgetListViewRecords: function (urlParams) {\n\t\t\tlet overrideUrlParams = {},\n\t\t\t\taDeferred = $.Deferred();\n\t\t\toverrideUrlParams.sourceModule = $('.js-source-module').val();\n\t\t\turlParams = $.extend(overrideUrlParams, urlParams);\n\t\t\tthis._super(urlParams)\n\t\t\t\t.done(function () {\n\t\t\t\t\taDeferred.resolve();\n\t\t\t\t})\n\t\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\tgetDefaultParams: function () {\n\t\t\tlet params = this._super();\n\t\t\tparams.module = $('.js-source-module').val();\n\t\t\tparams.entityState = 'Trash';\n\t\t\treturn params;\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerModuleFilter();\n\t\t\tthis.registerEmptyRecycle();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","massActivation","self","app","showConfirmModal","title","vtranslate","text","confirmedCallback","params","getSelectedRecordsParams","listInstance","getInstance","container","getListViewContainer","module","find","val","state","entityState","action","AppConnector","request","done","data","result","notify","Vtiger_Helper_Js","showMessage","getListViewRecords","getModuleName","view","sourceModule","massDelete","viewname","registerModuleFilter","filterSelectElement","on","e","args","id","calculatePages","updatePagination","updatePaginationAjax","force","arguments","length","listViewPageDiv","getDefaultParams","type","totalCount","mode","html","registerPageNavigationEvents","registerEmptyRecycle","progressIndicatorElement","$","progressIndicator","sourceView","fail","urlParams","overrideUrlParams","aDeferred","Deferred","extend","_super","resolve","textStatus","errorThrown","reject","promise","registerEvents"],"mappings":"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"}