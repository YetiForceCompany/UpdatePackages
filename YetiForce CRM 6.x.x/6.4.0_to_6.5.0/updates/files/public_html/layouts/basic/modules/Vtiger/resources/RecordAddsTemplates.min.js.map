{"version":3,"file":"RecordAddsTemplates.min.js","sources":["RecordAddsTemplates.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n$.Class(\n\t'Base_RecordAddsTemplates_JS',\n\t{},\n\t{\n\t\teditInstance: false,\n\t\t/**\n\t\t * Function listener to send a form\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterSubmitForm: function (container) {\n\t\t\tconst aDeferred = $.Deferred();\n\t\t\tlet instanse = this;\n\t\t\tcontainer.on('click', '.js-modal__save', () => {\n\t\t\t\tlet params = {\n\t\t\t\t\taction: 'RecordAddsTemplates',\n\t\t\t\t\trecordAddsType: container.find('.js-modal-body').find(\"[name='recordAddsType']\").val()\n\t\t\t\t};\n\t\t\t\tlet validate = true;\n\t\t\t\tcontainer.find('form.js-record-template').each(function () {\n\t\t\t\t\tlet form = $(this);\n\t\t\t\t\tinstanse.editInstance.registerValidationsFields(form);\n\t\t\t\t\tlet formSerializeData = form.serializeFormData();\n\t\t\t\t\tparams[formSerializeData.module] = formSerializeData;\n\t\t\t\t\tif (!form.validationEngine('validate')) {\n\t\t\t\t\t\tvalidate = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (validate) {\n\t\t\t\t\tAppConnector.request(params)\n\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\tlet response = data.result;\n\t\t\t\t\t\t\tlet preSave = response.preSave;\n\t\t\t\t\t\t\tif (typeof preSave !== 'undefined' && preSave.length) {\n\t\t\t\t\t\t\t\tfor (let i = 0; i < preSave.length; i++) {\n\t\t\t\t\t\t\t\t\tif (preSave[i] !== null && preSave[i].result !== true) {\n\t\t\t\t\t\t\t\t\t\tapp.showNotify(preSave[i].message ? preSave[i].message : app.vtranslate('JS_ERROR'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (response.url) {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = response.url;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\t\t\ttext: response.message ? response.message : app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (response.length <= 0) {\n\t\t\t\t\t\t\t\taDeferred.resolve(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t\t\t\taDeferred.resolve(false);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register events function\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function (modalContainer) {\n\t\t\tthis.editInstance = Vtiger_Edit_Js.getInstance();\n\t\t\tthis.editInstance.registerBasicEvents(modalContainer);\n\t\t\tthis.registerSubmitForm(modalContainer);\n\t\t}\n\t}\n);\n"],"names":["$","Class","editInstance","registerSubmitForm","container","aDeferred","Deferred","instanse","on","params","action","recordAddsType","find","val","validate","each","form","registerValidationsFields","formSerializeData","serializeFormData","module","validationEngine","AppConnector","request","done","data","response","result","preSave","length","i","app","showNotify","message","vtranslate","success","hideModalWindow","text","type","url","window","location","href","reload","resolve","fail","textStatus","errorThrown","errorLog","registerEvents","modalContainer","Vtiger_Edit_Js","getInstance","registerBasicEvents"],"mappings":";;AAAA,kKACAA,CAAC,CAACC,KAAK,CACN,6BAA6B,CAC7B,EAAE,CACF,CACCC,YAAY,CAAA,CAAA,CAAO;AAErB;AACA;AACA,KACEC,kBAAkB,CAAE,SAAAA,mBAAUC,SAAS,CAAE,KAClCC,SAAS,CAAGL,CAAC,CAACM,QAAQ,EAAE,CAC1BC,QAAQ,CAAG,IAAI,CACnBH,SAAS,CAACI,EAAE,CAAC,OAAO,CAAE,iBAAiB,CAAE,UAAM,CAAA,IAC1CC,MAAM,CAAG,CACZC,MAAM,CAAE,qBAAqB,CAC7BC,cAAc,CAAEP,SAAS,CAACQ,IAAI,CAAC,gBAAgB,CAAC,CAACA,IAAI,CAAC,yBAAyB,CAAC,CAACC,GAAG,EACrF,CAAC,CACGC,QAAQ,CAAA,CAAA,CAAO,CACnBV,SAAS,CAACQ,IAAI,CAAC,yBAAyB,CAAC,CAACG,IAAI,CAAC,UAAY,CAC1D,IAAIC,IAAI,CAAGhB,CAAC,CAAC,IAAI,CAAC,CAClBO,QAAQ,CAACL,YAAY,CAACe,yBAAyB,CAACD,IAAI,CAAC,CACrD,IAAIE,iBAAiB,CAAGF,IAAI,CAACG,iBAAiB,EAAE,CAChDV,MAAM,CAACS,iBAAiB,CAACE,MAAM,CAAC,CAAGF,iBAAiB,CAC/CF,IAAI,CAACK,gBAAgB,CAAC,UAAU,CAAC,GACrCP,QAAQ,CAAQ,CAAA,CAAA,EAElB,CAAC,CAAC,CACEA,QAAQ,EACXQ,YAAY,CAACC,OAAO,CAACd,MAAM,CAAC,CAC1Be,IAAI,CAAC,SAAUC,IAAI,CAAE,CAAA,IACjBC,QAAQ,CAAGD,IAAI,CAACE,MAAM,CACtBC,OAAO,CAAGF,QAAQ,CAACE,OAAO,CAC9B,GAAuB,WAAW,EAA9B,OAAOA,OAAuB,EAAIA,OAAO,CAACC,MAAM,CACnD,IAAK,IAAIC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGF,OAAO,CAACC,MAAM,CAAEC,CAAC,EAAE,CACnB,IAAI,GAAnBF,OAAO,CAACE,CAAC,CAAU,EAAI,CAAA,CAAA,GAAAF,OAAO,CAACE,CAAC,CAAC,CAACH,MAAe,EACpDI,GAAG,CAACC,UAAU,CAACJ,OAAO,CAACE,CAAC,CAAC,CAACG,OAAO,CAAGL,OAAO,CAACE,CAAC,CAAC,CAACG,OAAO,CAAGF,GAAG,CAACG,UAAU,CAAC,UAAU,CAAC,CAAC,CAErF,KAEGR,QAAQ,CAACS,OAAO,EACnBJ,GAAG,CAACK,eAAe,EAAE,CACrBL,GAAG,CAACC,UAAU,CAAC,CACdK,IAAI,CAAEX,QAAQ,CAACO,OAAO,CAAGP,QAAQ,CAACO,OAAO,CAAGF,GAAG,CAACG,UAAU,CAAC,mBAAmB,CAAC,CAC/EI,IAAI,CAAE,SACP,CAAC,CAAC,CACEZ,QAAQ,CAACa,GAAG,CACfC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAGhB,QAAQ,CAACa,GAAG,CAEnCC,MAAM,CAACC,QAAQ,CAACE,MAAM,EAAE,EAGzBZ,GAAG,CAACC,UAAU,CAAC,CACdK,IAAI,CAAEX,QAAQ,CAACO,OAAO,CAAGP,QAAQ,CAACO,OAAO,CAAGF,GAAG,CAACG,UAAU,CAAC,UAAU,CAAC,CACtEI,IAAI,CAAE,OACP,CAAC,CAAC,CAGmB,CAAC,EAApBZ,QAAQ,CAACG,MAAW,CACvBxB,SAAS,CAACuC,OAAO,GAAK,CAAC,CAEvBvC,SAAS,CAACuC,OAAO,GAAM,EAEzB,CAAC,CAAC,CACDC,IAAI,CAAC,SAACC,UAAU,CAAEC,WAAW,CAAK,CAClChB,GAAG,CAACC,UAAU,CAAC,CACdK,IAAI,CAAEN,GAAG,CAACG,UAAU,CAAC,UAAU,CAAC,CAChCI,IAAI,CAAE,OACP,CAAC,CAAC,CACFP,GAAG,CAACiB,QAAQ,CAACF,UAAU,CAAEC,WAAW,CAAC,CACrC1C,SAAS,CAACuC,OAAO,GAAM,EACxB,CAAC,EAEJ,CAAC,EACF,CAAC;AAGH;AACA;AACA,KACEK,cAAc,CAAE,SAAAA,cAAAA,CAAUC,cAAc,CAAE,CACzC,IAAI,CAAChD,YAAY,CAAGiD,cAAc,CAACC,WAAW,EAAE,CAChD,IAAI,CAAClD,YAAY,CAACmD,mBAAmB,CAACH,cAAc,CAAC,CACrD,IAAI,CAAC/C,kBAAkB,CAAC+C,cAAc,EACvC,CACD,CACD,CAAC;;"}