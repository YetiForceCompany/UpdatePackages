{"version":3,"file":"Tiles.min.js","sources":["Tiles.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 6.5 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n$.Class(\n\t'Vtiger_Tiles_Js',\n\t{},\n\t{\n\t\tcontentContainer: false,\n\t\t/**\n\t\t * Register tiles size change action\n\t\t * @param {jQuery} topMenuContainer\n\t\t */\n\t\tregisterTileSizeChange: function (topMenuContainer) {\n\t\t\ttopMenuContainer.find('.js-tile-size').on('click', (e) => {\n\t\t\t\tlet selectedTileSize = $(e.currentTarget).attr('data-tile-size');\n\t\t\t\ttopMenuContainer.find('.js-tile-dropdown-title').text($(e.currentTarget).text());\n\t\t\t\ttopMenuContainer.find('.js-selected-tile-size').attr('data-selected-tile-size', selectedTileSize);\n\t\t\t\tapp.setMainParams('pageNumber', '1');\n\t\t\t\tapp.setMainParams('pageToJump', '1');\n\t\t\t\tlet urlParams = {\n\t\t\t\t\tviewname: this.listInstance.getCurrentCvId(),\n\t\t\t\t\tsearch_key: this.listInstance.getAlphabetSearchField(),\n\t\t\t\t\tsearch_value: '',\n\t\t\t\t\tsearch_params: '',\n\t\t\t\t\tadvancedConditions: '',\n\t\t\t\t\ttile_size: selectedTileSize\n\t\t\t\t};\n\t\t\t\tthis.contentContainer.find('#recordsCount').val('');\n\t\t\t\tthis.contentContainer.find('#totalPageCount').text('');\n\t\t\t\ttopMenuContainer.find('.pagination').data('totalCount', 0);\n\t\t\t\tthis.listInstance.getListViewRecords(urlParams).done(() => {\n\t\t\t\t\tthis.listInstance.updatePagination(1);\n\t\t\t\t\tthis.setHeightOfTiles(this.contentContainer);\n\t\t\t\t});\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Adjust height tile to the highest\n\t\t */\n\t\tsetHeightOfTiles: function () {\n\t\t\tlet maxHeight = -1;\n\t\t\tlet tiles = this.contentContainer.find('.js-tile-card');\n\t\t\ttiles.each(function () {\n\t\t\t\tmaxHeight = maxHeight > $(this).height() ? maxHeight : $(this).height();\n\t\t\t});\n\t\t\ttiles.each(function () {\n\t\t\t\t$(this).height(maxHeight);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function to register the click on the tile\n\t\t * @param {jQuery} tileContainer\n\t\t */\n\t\tregisterTileClickEvent: function (tileContainer) {\n\t\t\ttileContainer.on('click', '.js-card-body', function (e) {\n\t\t\t\tif ($(e.target).hasClass('js-show-image-preview')) return;\n\t\t\t\tif ($(e.target).closest('div').hasClass('actions')) return;\n\t\t\t\tif ($(e.target).is('button') || $(e.target).parent().is('button')) return;\n\t\t\t\tif ($(e.target).closest('a').hasClass('noLinkBtn')) return;\n\t\t\t\tif ($(e.target).is('input[type=\"checkbox\"]')) return;\n\t\t\t\tlet recordUrl = $(e.target).closest('.js-tile-container').data('recordurl');\n\t\t\t\tif (typeof recordUrl !== 'undefined') {\n\t\t\t\t\twindow.location.href = recordUrl;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will give you all the list view params\n\t\t * @param {string} urlParams\n\t\t */\n\t\tgetListViewRecords: function (urlParams) {\n\t\t\tthis.listInstance.getListViewRecords(urlParams).done(() => {\n\t\t\t\tthis.setHeightOfTiles(this.contentContainer);\n\t\t\t});\n\t\t},\n\t\tregisterImagePreview() {\n\t\t\tthis.contentContainer.on('click', '.js-show-image-preview', (e) => {\n\t\t\t\tconst moduleName = this.contentContainer.find('[name=\"module\"]').length\n\t\t\t\t\t? this.contentContainer.find('[name=\"module\"]').val()\n\t\t\t\t\t: app.getModuleName();\n\t\t\t\tconst recordId = $(e.target).closest('.js-tile-container').attr('data-record-id');\n\t\t\t\tconst url = `index.php?module=${moduleName}&view=ImagePreview&record=${recordId}`;\n\t\t\t\tapp.showModalWindow('', url, (modalWindow) => {\n\t\t\t\t\tlet imageSrc = '';\n\t\t\t\t\tif ('IMG' === e.target.nodeName) {\n\t\t\t\t\t\timageSrc = $(e.target).attr('src');\n\t\t\t\t\t} else {\n\t\t\t\t\t\timageSrc = $(e.target).css('background-image');\n\t\t\t\t\t\timageSrc = imageSrc.replace('url(\"', '');\n\t\t\t\t\t\timageSrc = imageSrc.replace('\")', '');\n\t\t\t\t\t}\n\t\t\t\t\tmodalWindow.find('img.js-image-preview').attr('src', imageSrc);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register events\n\t\t */\n\t\tregisterEvents: function () {\n\t\t\tthis.listInstance = new Vtiger_List_Js();\n\t\t\tthis.listInstance.registerEvents();\n\t\t\tconst topMenuContainer = this.listInstance.getListViewTopMenuContainer();\n\t\t\tthis.contentContainer = this.listInstance.getListViewContainer();\n\t\t\tthis.registerTileSizeChange(topMenuContainer);\n\t\t\tthis.setHeightOfTiles();\n\t\t\tthis.registerTileClickEvent(this.contentContainer);\n\t\t\tthis.registerImagePreview();\n\t\t}\n\t}\n);\n"],"names":["$","Class","contentContainer","registerTileSizeChange","topMenuContainer","_this","find","on","e","selectedTileSize","currentTarget","attr","text","app","setMainParams","urlParams","viewname","listInstance","getCurrentCvId","search_key","getAlphabetSearchField","search_value","search_params","advancedConditions","tile_size","val","data","getListViewRecords","done","updatePagination","setHeightOfTiles","stopPropagation","maxHeight","tiles","each","height","registerTileClickEvent","tileContainer","target","hasClass","closest","is","parent","recordUrl","window","location","href","_this2","registerImagePreview","_this3","moduleName","length","getModuleName","recordId","url","concat","showModalWindow","modalWindow","imageSrc","nodeName","css","replace","registerEvents","Vtiger_List_Js","getListViewTopMenuContainer","getListViewContainer"],"mappings":"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"}