{"version":3,"file":"outlookMessageCompose.min.js","sources":["outlookMessageCompose.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nwindow.MailIntegration_Compose = {\n\t/**\n\t * AppConnector wrapper\n\t *\n\t * @param   {object}  request\n\t *\n\t * @return  {object}           AppConnector object with done method\n\t */\n\tconnector(request) {\n\t\treturn AppConnector.request(request).fail((error) => {\n\t\t\tthis.showResponseMessage(false);\n\t\t});\n\t},\n\t/**\n\t * Show response message\n\t *\n\t * @param   {boolean}  success\n\t * @param   {string}  message\n\t */\n\tshowResponseMessage(success, message = '') {\n\t\tif (success) {\n\t\t\tOffice.context.mailbox.item.notificationMessages.replaceAsync('information', {\n\t\t\t\ttype: 'informationalMessage',\n\t\t\t\tmessage: message,\n\t\t\t\ticon: 'iconid',\n\t\t\t\tpersistent: false\n\t\t\t});\n\t\t} else {\n\t\t\tOffice.context.mailbox.item.notificationMessages.replaceAsync('error', {\n\t\t\t\ttype: 'errorMessage',\n\t\t\t\tmessage: app.vtranslate('JS_ERROR') + ' ' + message\n\t\t\t});\n\t\t}\n\t},\n\t/**\n\t * Registered autocomplete template\n\t *\n\t * @return  {object}  overwrite ui-autocomplete list item template\n\t */\n\tregisterAutocompleteTemplate() {\n\t\t$.widget('ui.autocomplete', $.ui.autocomplete, {\n\t\t\t_renderItem: function (ul, item) {\n\t\t\t\tlet listItemTemplate = (user) => {\n\t\t\t\t\treturn `<li class=\"c-search-item js-search-item\">\n\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t\t\t<div class=\"col-9 pr-0\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"u-fs-14px\">${user.name}</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"c-search-item__mail small\">${user.mail}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"col-3 pr-0 text-right\">\n\t\t\t\t\t\t\t\t\t\t<button class=\"c-search-item__btn btn btn-xs btn-outline-primary\" data-copy-target=\"cc\">${app.vtranslate(\n\t\t\t\t\t\t\t\t\t\t\t'JS_CC'\n\t\t\t\t\t\t\t\t\t\t)}</button>\n\t\t\t\t\t\t\t\t\t\t<button class=\"c-search-item__btn btn btn-xs btn-outline-primary\" data-copy-target=\"bcc\">${app.vtranslate(\n\t\t\t\t\t\t\t\t\t\t\t'JS_BCC'\n\t\t\t\t\t\t\t\t\t\t)}</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div></div>\n\t\t\t\t\t\t\t</li>`;\n\t\t\t\t};\n\t\t\t\treturn $(listItemTemplate(item)).appendTo(ul);\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Register autocomplete\n\t *\n\t * @return  {jQuery}  autocomplete instance\n\t */\n\tregisterAutocomplete() {\n\t\treturn this.container.find('.js-search-input').autocomplete({\n\t\t\tdelay: '600',\n\t\t\tminLength: '3',\n\t\t\tclasses: {\n\t\t\t\t'ui-autocomplete': 'mobile'\n\t\t\t},\n\t\t\tsource: function (request, response) {\n\t\t\t\twindow.MailIntegration_Compose.findEmail(request, response);\n\t\t\t},\n\t\t\tselect: function (e, ui) {\n\t\t\t\tlet toElement = 'to';\n\t\t\t\tif (e.target.dataset.copyTarget) {\n\t\t\t\t\ttoElement = e.target.dataset.copyTarget;\n\t\t\t\t} else if (e.originalEvent.target.dataset.copyTarget) {\n\t\t\t\t\ttoElement = e.originalEvent.target.dataset.copyTarget;\n\t\t\t\t} else if (e.originalEvent.originalEvent.target.dataset.copyTarget) {\n\t\t\t\t\ttoElement = e.originalEvent.originalEvent.target.dataset.copyTarget;\n\t\t\t\t}\n\t\t\t\twindow.MailIntegration_Compose.copyRecipient(toElement, [\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: ui.item.name,\n\t\t\t\t\t\temailAddress: ui.item.mail\n\t\t\t\t\t}\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Find mail action for autocomplete source\n\t *\n\t * @param   {object}  request   autocomplete param\n\t * @param   {fuction}  callBack  autocomplete callBack\n\t */\n\tfindEmail(request, callBack) {\n\t\tthis.connector({\n\t\t\tmodule: 'MailIntegration',\n\t\t\taction: 'Mail',\n\t\t\tmode: 'findEmail',\n\t\t\tsearch: request.term\n\t\t}).done((responseData) => {\n\t\t\tlet data = responseData.result.map((user) => {\n\t\t\t\tlet userData = user.split(' <');\n\t\t\t\tlet name = userData[0];\n\t\t\t\tlet mail = userData[1].slice(0, -1);\n\t\t\t\treturn { name, mail };\n\t\t\t});\n\t\t\tcallBack(data);\n\t\t});\n\t},\n\t/**\n\t * Copy recipient to outlook field\n\t *\n\t * @param   {string}  recipientsField  to, cc, bcc\n\t * @param   {object}  newRecipient\n\t */\n\tcopyRecipient(recipientsField, newRecipient) {\n\t\tOffice.context.mailbox.item[recipientsField].addAsync(newRecipient, function (result) {\n\t\t\tif (result.error) {\n\t\t\t\tOffice.context.mailbox.item.notificationMessages.replaceAsync('error', {\n\t\t\t\t\ttype: 'errorMessage',\n\t\t\t\t\tmessage: app.vtranslate('JS_ERROR') + ' ' + result.error\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\tregisterEvents() {\n\t\tif (!$('.js-exception-error').length) {\n\t\t\tthis.container = $('#page');\n\t\t\tthis.registerAutocompleteTemplate();\n\t\t\tthis.registerAutocomplete();\n\t\t}\n\t}\n};\nif (typeof Office === 'undefined') {\n\tapp.showNotify({\n\t\ttitle: app.vtranslate('JS_ERROR'),\n\t\ttype: 'error'\n\t});\n} else {\n\t(function ($) {\n\t\tOffice.onReady((info) => {\n\t\t\tif (info.host === Office.HostType.Outlook) {\n\t\t\t\twindow.MailIntegration_Compose.registerEvents();\n\t\t\t}\n\t\t});\n\t})($);\n}\n"],"names":["window","MailIntegration_Compose","connector","request","AppConnector","fail","showResponseMessage","success","Office","context","mailbox","item","notificationMessages","replaceAsync","type","message","icon","persistent","app","vtranslate","registerAutocompleteTemplate","$","widget","ui","autocomplete","_renderItem","ul","user","name","mail","appendTo","registerAutocomplete","container","find","delay","minLength","classes","source","response","findEmail","select","e","toElement","target","dataset","copyTarget","originalEvent","copyRecipient","displayName","emailAddress","callBack","module","action","mode","search","term","done","responseData","result","map","userData","split","slice","data","recipientsField","newRecipient","addAsync","error","registerEvents","length","showNotify","title","onReady","info","host","HostType","Outlook"],"mappings":";;AAAA,kKACA,YAEAA,CAAAA,MAAM,CAACC,uBAAP,CAAiC;AAEjC;AACA;AACA;AACA;AACA;AACA,IACCC,SARgC,oBAQtBC,OARsB,CAQb,gBAClB,OAAOC,YAAY,CAACD,OAAb,CAAqBA,OAArB,EAA8BE,IAA9B,CAAmC,UAAW,CACpD,KAAI,CAACC,mBAAL,CACA,CAAA,CAAA,EAAA,CAFM,CAGP,CAZ+B;AAcjC;AACA;AACA;AACA;AACA,IACCA,mBAnBgC,CAmBZC,SAAAA,mBAAAA,CAAAA,OAnBY,CAmBW,CAAA,WAAA,CAAJ,CAAA,CAAA,SAAA,CAAA,MAAA,EAAA,SAAA,CAAA,CAAA,CAAA,GAAA,KAAA,CAAA,CAAA,SAAA,CAAA,CAAA,CAAA,CAAA,EAAI,CACtCA,OADsC,CAEzCC,MAAM,CAACC,OAAP,CAAeC,OAAf,CAAuBC,IAAvB,CAA4BC,oBAA5B,CAAiDC,YAAjD,CAA8D,aAA9D,CAA6E,CAC5EC,IAAI,CAAE,sBADsE,CAE5EC,OAAO,CAAEA,OAFmE,CAG5EC,IAAI,CAAE,QAHsE,CAI5EC,UAAU,CAAA,CAAA,CAJkE,CAA7E,CAFyC,CASzCT,MAAM,CAACC,OAAP,CAAeC,OAAf,CAAuBC,IAAvB,CAA4BC,oBAA5B,CAAiDC,YAAjD,CAA8D,OAA9D,CAAuE,CACtEC,IAAI,CAAE,cADgE,CAEtEC,OAAO,CAAEG,GAAG,CAACC,UAAJ,CAAe,UAAf,CAAA,CAA6B,GAA7B,CAAmCJ,OAF0B,CAAvE,EAKD,CAjC+B;AAmCjC;AACA;AACA;AACA,IACCK,4BAvCgC,CAAA,SAAA,4BAAA,EAuCD,CAC9BC,CAAC,CAACC,MAAF,CAAS,iBAAT,CAA4BD,CAAC,CAACE,EAAF,CAAKC,YAAjC,CAA+C,CAC9CC,WAAW,CAAE,SAAUC,WAAAA,CAAAA,EAAV,CAAcf,IAAd,CAAoB,CAoBhC,OAAQ,CAAA,CAnBe,SAAA,gBAAA,CAACgB,IAAD,CAAU,CAChC,OAI8BA,2MAAAA,CAAAA,MAAAA,CAAAA,IAAI,CAACC,IAJnC,CAK8CD,uEAAAA,CAAAA,CAAAA,MAAAA,CAAAA,IAAI,CAACE,IALnD,uNAQ+FX,GAAG,CAACC,UAAJ,CACzF,OADyF,CAR/F,CAWgGD,8HAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAACC,UAAJ,CAC1F,QAD0F,CAXhG,CAiBA,wFAAA,CAAA,CACQ,CAAiBR,IAAjB,CAAD,CAAD,CAA0BmB,QAA1B,CAAmCJ,EAAnC,CACP,CAtB6C,CAA/C,EAwBA,CAhE+B;AAkEjC;AACA;AACA;AACA,IACCK,oBAtEgC,CAsET,SAAA,oBAAA,EAAA,CACtB,OAAO,IAAA,CAAKC,SAAL,CAAeC,IAAf,CAAoB,kBAApB,EAAwCT,YAAxC,CAAqD,CAC3DU,KAAK,CAAE,KADoD,CAE3DC,SAAS,CAAE,GAFgD,CAG3DC,OAAO,CAAE,CACR,kBAAmB,QADX,CAHkD,CAM3DC,MAAM,CAAE,SAAUlC,MAAAA,CAAAA,OAAV,CAAmBmC,QAAnB,CAA6B,CACpCtC,MAAM,CAACC,uBAAP,CAA+BsC,SAA/B,CAAyCpC,OAAzC,CAAkDmC,QAAlD,EACA,CAR0D,CAS3DE,MAAM,CAAE,gBAAUC,CAAV,CAAalB,EAAb,CAAiB,CACxB,IAAImB,SAAS,CAAG,IAAhB,CACID,CAAC,CAACE,MAAF,CAASC,OAAT,CAAiBC,UAFG,CAGvBH,SAAS,CAAGD,CAAC,CAACE,MAAF,CAASC,OAAT,CAAiBC,UAHN,CAIbJ,CAAC,CAACK,aAAF,CAAgBH,MAAhB,CAAuBC,OAAvB,CAA+BC,UAJlB,CAKvBH,SAAS,CAAGD,CAAC,CAACK,aAAF,CAAgBH,MAAhB,CAAuBC,OAAvB,CAA+BC,UALpB,CAMbJ,CAAC,CAACK,aAAF,CAAgBA,aAAhB,CAA8BH,MAA9B,CAAqCC,OAArC,CAA6CC,UANhC,GAOvBH,SAAS,CAAGD,CAAC,CAACK,aAAF,CAAgBA,aAAhB,CAA8BH,MAA9B,CAAqCC,OAArC,CAA6CC,UAPlC,CAAA,CASxB7C,MAAM,CAACC,uBAAP,CAA+B8C,aAA/B,CAA6CL,SAA7C,CAAwD,CACvD,CACCM,WAAW,CAAEzB,EAAE,CAACZ,IAAH,CAAQiB,IADtB,CAECqB,YAAY,CAAE1B,EAAE,CAACZ,IAAH,CAAQkB,IAFvB,CADuD,CAAxD,EAMA,CAxB0D,CAArD,CA0BP,CAjG+B;AAmGjC;AACA;AACA;AACA;AACA,IACCU,SAxGgC,oBAwGtBpC,OAxGsB,CAwGb+C,QAxGa,CAwGH,CAC5B,IAAKhD,CAAAA,SAAL,CAAe,CACdiD,MAAM,CAAE,iBADM,CAEdC,MAAM,CAAE,MAFM,CAGdC,IAAI,CAAE,WAHQ,CAIdC,MAAM,CAAEnD,OAAO,CAACoD,IAJF,CAAf,CAAA,CAKGC,IALH,CAKQ,SAACC,YAAD,CAAkB,CACzB,QAAQ,CAAGA,YAAY,CAACC,MAAb,CAAoBC,GAApB,CAAwB,SAAChC,IAAD,CAAU,CACxCiC,IAAAA,QAAQ,CAAGjC,IAAI,CAACkC,KAAL,CAAW,IAAX,CAD6B,CAExCjC,IAAI,CAAGgC,QAAQ,CAAC,CAAD,CAFyB,CAGxC/B,IAAI,CAAG+B,QAAQ,CAAC,CAAD,CAAR,CAAYE,KAAZ,CAAkB,CAAlB,CAAqB,CAAC,CAAtB,CAHiC,CAI5C,OAAO,CAAElC,IAAI,CAAJA,IAAF,CAAQC,IAAI,CAAJA,IAAR,CACP,CALU,CAAX,CAMAqB,QAAQ,CAACa,IAAD,EACR,CAbD,EAcA,CAvH+B;AAyHjC;AACA;AACA;AACA;AACA,IACChB,aA9HgC,CAAA,SAAA,aAAA,CA8HlBiB,eA9HkB,CA8HDC,YA9HC,CA8Ha,CAC5CzD,MAAM,CAACC,OAAP,CAAeC,OAAf,CAAuBC,IAAvB,CAA4BqD,eAA5B,CAAA,CAA6CE,QAA7C,CAAsDD,YAAtD,CAAoE,SAAUP,MAAV,CAAkB,CACjFA,MAAM,CAACS,KAD0E,EAEpF3D,MAAM,CAACC,OAAP,CAAeC,OAAf,CAAuBC,IAAvB,CAA4BC,oBAA5B,CAAiDC,YAAjD,CAA8D,OAA9D,CAAuE,CACtEC,IAAI,CAAE,cADgE,CAEtEC,OAAO,CAAEG,GAAG,CAACC,UAAJ,CAAe,UAAf,CAA6B,CAAA,GAA7B,CAAmCuC,MAAM,CAACS,KAFmB,CAAvE,EAKD,CAPD,EAQA,CAvI+B,CAwIhCC,cAxIgC,CAwIf,SAAA,cAAA,EAAA,CACX/C,CAAC,CAAC,qBAAD,CAAD,CAAyBgD,MADd,GAEf,IAAKrC,CAAAA,SAAL,CAAiBX,CAAC,CAAC,OAAD,CAFH,CAGf,IAAA,CAAKD,4BAAL,EAHe,CAIf,IAAKW,CAAAA,oBAAL,EAJe,EAMhB,CA9I+B,EAgJX,WAAlB,EAAOvB,OAAAA,OACVU,GAAG,CAACoD,UAAJ,CAAe,CACdC,KAAK,CAAErD,GAAG,CAACC,UAAJ,CAAe,UAAf,CADO,CAEdL,IAAI,CAAE,OAFQ,CAAf,EAKC,UAAa,CACbN,MAAM,CAACgE,OAAP,CAAe,SAACC,IAAD,CAAU,CACpBA,IAAI,CAACC,IAAL,GAAclE,MAAM,CAACmE,QAAP,CAAgBC,OADV,EAEvB5E,MAAM,CAACC,uBAAP,CAA+BmE,cAA/B,GAED,CAJD,EAKA,CAND,CAMG/C,CANH;;"}