{"version":3,"file":"GanttController.min.js","sources":["GanttController.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Project_Gantt_Js',\n\t{},\n\t{\n\t\tfilterSelectElement: false,\n\t\tgetFilterSelectElement: function () {\n\t\t\tif (this.filterSelectElement == false) {\n\t\t\t\tthis.filterSelectElement = jQuery('#customFilter');\n\t\t\t}\n\t\t\treturn this.filterSelectElement;\n\t\t},\n\t\tgetDefaultParams: function () {\n\t\t\tvar params = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'GanttData'\n\t\t\t};\n\t\t\tif (app.getParentModuleName()) {\n\t\t\t\tparams.parent = app.getParentModuleName();\n\t\t\t}\n\t\t\treturn params;\n\t\t},\n\t\tgetCurrentCvId: function () {\n\t\t\treturn jQuery('#customFilter').find('option:selected').data('id');\n\t\t},\n\t\tgetGanttData(urlParams) {\n\t\t\tlet aDeferred = $.Deferred();\n\t\t\tif (typeof urlParams === 'undefined') {\n\t\t\t\turlParams = {};\n\t\t\t}\n\t\t\tlet defaultParams = this.getDefaultParams();\n\t\t\turlParams = $.extend(defaultParams, urlParams);\n\t\t\tconst progressInstance = jQuery.progressIndicator({\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tonBlock: () => {\n\t\t\t\t\t\tAppConnector.request(urlParams)\n\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\t\t\taDeferred.resolve(data);\n\t\t\t\t\t\t\t\tapp.notifyPostAjaxReady();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\t\t\t\t\taDeferred.reject(textStatus, errorThrown);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn aDeferred.promise();\n\t\t},\n\t\t/**\n\t\t * load gantt\n\t\t */\n\t\tloadGantt(container = '.js-gantt__container', ganttData = false) {\n\t\t\tcontainer = $(container);\n\t\t\tthis.gantt = new Gantt(container);\n\t\t\tconst projectId = container.parent().find('input[name=\"projectId\"]').val();\n\t\t\tif (!ganttData) {\n\t\t\t\tthis.gantt.loadProjectFromAjax({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'GanttData',\n\t\t\t\t\tprojectId: projectId\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * reload gantt with new data\n\t\t * @param data\n\t\t */\n\t\treloadData(data) {\n\t\t\tthis.gantt.reloadData(data);\n\t\t},\n\t\t/*\n\t\t * Function to register the event for changing the custom Filter\n\t\t */\n\t\tregisterChangeCustomFilterEvent: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.getFilterSelectElement().on('change', function (event) {\n\t\t\t\t$(`.nav-item[data-cvid='${thisInstance.getCurrentCvId()}'] .nav-link`).tab('show');\n\t\t\t\tvar currentTarget = jQuery(event.currentTarget);\n\t\t\t\tvar selectOption = currentTarget.find(':selected');\n\t\t\t\tapp.setMainParams('pageNumber', '1');\n\t\t\t\tapp.setMainParams('pageToJump', '1');\n\t\t\t\tapp.setMainParams('orderBy', selectOption.data('orderby'));\n\t\t\t\tapp.setMainParams('sortOrder', selectOption.data('sortorder'));\n\t\t\t\tthisInstance\n\t\t\t\t\t.getGanttData({\n\t\t\t\t\t\tviewname: jQuery(this).val()\n\t\t\t\t\t})\n\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\tthisInstance.reloadData(data.result);\n\t\t\t\t\t});\n\t\t\t\tevent.stopPropagation();\n\t\t\t});\n\t\t},\n\t\tgetSelectOptionFromChosenOption: function (liElement) {\n\t\t\tvar id = liElement.attr('id');\n\t\t\tvar idArr = id.split('-');\n\t\t\tvar currentOptionId = '';\n\t\t\tif (idArr.length > 0) {\n\t\t\t\tcurrentOptionId = idArr[idArr.length - 1];\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn jQuery('#filterOptionId_' + currentOptionId);\n\t\t},\n\t\tchangeCustomFilterElementView: function () {\n\t\t\tconst self = this,\n\t\t\t\tfilterSelectElement = this.getFilterSelectElement();\n\t\t\tif (filterSelectElement.length > 0 && filterSelectElement.is('select')) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(filterSelectElement, {\n\t\t\t\t\ttemplateSelection: function (data) {\n\t\t\t\t\t\tconst resultContainer = document.createElement('span'),\n\t\t\t\t\t\t\tspan = document.createElement('span'),\n\t\t\t\t\t\t\timage = $('.filterImage').clone();\n\t\t\t\t\t\timage.removeAttr('style');\n\t\t\t\t\t\tspan.innerText = data.text;\n\t\t\t\t\t\tresultContainer.appendChild(image.get(0));\n\t\t\t\t\t\tresultContainer.appendChild(span);\n\t\t\t\t\t\treturn resultContainer;\n\t\t\t\t\t},\n\t\t\t\t\tcustomSortOptGroup: true,\n\t\t\t\t\tcloseOnSelect: true\n\t\t\t\t});\n\t\t\t\tconst select2Instance = filterSelectElement.data('select2');\n\t\t\t\tjQuery('.filterActionsDiv')\n\t\t\t\t\t.appendTo(select2Instance.$dropdown.find('.select2-dropdown:last'))\n\t\t\t\t\t.removeClass('d-none')\n\t\t\t\t\t.on('click', function (e) {\n\t\t\t\t\t\tself.registerCreateFilterClickEvent(e);\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis.changeCustomFilterElementView();\n\t\t\tthis.registerChangeCustomFilterEvent();\n\t\t\tVtiger_Helper_Js.showHorizontalTopScrollBar();\n\t\t\tthis.loadGantt();\n\t\t}\n\t}\n);\n"],"names":["$","Class","filterSelectElement","getFilterSelectElement","jQuery","getDefaultParams","module","app","getModuleName","action","getParentModuleName","params","parent","getCurrentCvId","find","data","getGanttData","urlParams","Deferred","extend","defaultParams","progressIndicator","blockInfo","enabled","onBlock","AppConnector","request","done","progressInstance","mode","aDeferred","resolve","notifyPostAjaxReady","fail","textStatus","errorThrown","reject","promise","loadGantt","container","ganttData","gantt","Gantt","projectId","val","loadProjectFromAjax","reloadData","registerChangeCustomFilterEvent","on","event","thisInstance","tab","currentTarget","selectOption","setMainParams","viewname","result","stopPropagation","getSelectOptionFromChosenOption","liElement","attr","idArr","id","split","currentOptionId","length","changeCustomFilterElementView","self","is","App","Fields","Picklist","showSelect2ElementView","templateSelection","document","createElement","span","image","clone","removeAttr","innerText","text","resultContainer","appendChild","get","customSortOptGroup","closeOnSelect","select2Instance","appendTo","$dropdown","removeClass","e","registerCreateFilterClickEvent","registerEvents","Vtiger_Helper_Js","showHorizontalTopScrollBar"],"mappings":"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"}